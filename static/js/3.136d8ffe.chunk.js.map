{"version":3,"sources":["components/TextButton.module.css","components/AnalysisPanel.module.css","components/AnalysisButton.module.css","components/Accordion.module.css","components/DefaultButton.module.css","components/CheckBox.module.css","components/ResponsiveList.module.css","components/GroupsList.module.css","components/ConnectionList.module.css","components/WeightsList.module.css","components/InfoBox.module.css","images/RHowlett_IKB.jpg","images/IllustriteZeitung_SS_GreatBritain.png","images/320px-SS_Great_Britain_diagram.jpg","images/Sumerian_26th_c_Adab.jpg","images/320px-SS_Great_Britain_transverse_section.jpg","components/TimeLineBox.module.css","components/FilterBox.module.css","components/SlidingPanel.module.css","components/transitions/SlideFromLeft.module.css","components/transitions/SlideFromRight.module.css","components/transitions/SlideFromBottom.module.css","components/transitions/SlideFromTop.module.css","components/OverlayBox.module.css","components/SearchBar.module.css","components/BrunelMenu.module.css","images/ssgb_logo.png","components/ShipSelector.module.css","components/ShipTitle.module.css","SocialApp.module.css","components/TextButton.js","components/AnalysisPanel.js","components/AnalysisButton.js","components/d3/ForceGraph.d3.js","components/ForceGraph.js","components/SocialGraph.js","components/Accordion.js","components/DefaultButton.js","components/CheckBox.js","components/ResponsiveList.js","components/GroupsList.js","components/ConnectionList.js","components/DateRangeButton.js","model/Errors.js","model/RoughDate.js","model/DateRange.js","components/SourceList.js","components/WeightsList.js","model/Person.js","model/People.js","model/Business.js","model/Businesses.js","model/Connection.js","model/Connections.js","model/Position.js","model/Positions.js","model/Affiliation.js","model/Affiliations.js","model/Source.js","model/Sources.js","model/Note.js","model/Notes.js","model/Project.js","model/Projects.js","model/Biographies.js","model/Social.js","components/InfoBox.js","components/NewTimeline.js","components/TimeLineBox.js","components/FilterBox.js","components/SlidingPanel.js","components/OverlayBox.js","components/SearchBar.js","components/BrunelMenu.js","components/ShipSelector.js","components/ShipTitle.js","SocialApp.js","components/ForceGraph.module.css"],"names":["module","exports","TextButton","props","defaultCSS","background","border","fontFamily","color","cursor","fontSize","padding","textAlign","css","this","textColor","hoverColor","className","styles","button","onClick","children","React","Component","AnalysisPanel","wholePanel","verticalSpaceTitle","titleText","verticalSpace","toggleFilterPanel","togglePanel","toggleTimeLinePanel","toggleWobble","AnalysisButon","_null_function","constrain","x","w","r","Math","max","min","handleMouseClick","THIS","svg","_mainGroup","node","d3","raise","id","attr","items","selectAll","classed","highlight","state","signalClicked","stopPropagation","handleMouseOver","each","d","target_id","target","source_id","source","signalMouseOver","handleMouseOut","signalMouseOut","_resolve","item","getID","ForceGraphD3","_updateSimulation","bind","_updateLink","_updateNodeText","_updateNode","draw","drawFromScratch","setPositionColors","getPositionColor","update","updateGraph","drag","dragLink","getWeight","uid","uuidv4","width","height","social","selected","highlighted","colors","groupTable","slice","length","_size_changed","_graph_changed","_is_running","_is_drawn","_target_decay","_target_alpha","_tooltips","filter","getFilter","Object","keys","getBiographies","getByID","h","graph","getGraph","l","lodash","cloneDeep","edges","edge","n","nodes","old_nodes","old","_graph","i","o","y","random","fixed","fx","fy","size_changed","wobble","selectedShipID","lastShip","prototype","hasOwnProperty","call","entity","positions","group","positionGroups","toLowerCase","startsWith","console","error","positionCode","getPositionCode","splitGroup","split","namedPositions","getPositions","colorTable","entries","position","trimPosition","replace","members","includes","log","positionGroup","simulation","_simulation","on","alphaTarget","velocityDecay","restart","index","dx","dy","shipID","getSelectedShipID","weight","divSelect","name","label","shortBio","getNodeBio","substring","tooltip","append","html","style","pageY","pageX","push","remove","data","select","join","enter","mouseoverNode","mouseoutNode","text","node_text","link","type","value","link_weak","link_indirect","stop","force","strength","distanceMin","distanceMax","links","distance","iterations","radius","size","getGroupForce","_link","dr","sqrt","_node","_label","restartSimulation","container","mainGroup","update_simulation","ForceGraph","_updateSize","window","addEventListener","removeEventListener","updateSize","offsetWidth","offsetHeight","s","ref","el","SocialGraph","getNetwork","emitClicked","BAccordion","accordion","preExpanded","allowMultipleExpanded","allowZeroExpanded","BAccordionItem","accordionItem","uuid","BAccordionTitle","accordionButton","BAccordionPanel","DefaultButton","href","CheckBox","checkBox","checked","onChange","checkMark","ResponsiveList","list","ResponsiveListItem","key","null_function","GroupsList","groups","title","emitSelected","emitToggleFilter","projects","forEach","get","is_filtered","isFiltered","getName","project","projectHeader","projectBody","minWidth","ConnectionList","connections","listitems","map","DateRangeButton","_isARoughDateObject","_isADateRangeObject","isNull","toSimpleString","toDateRange","KeyError","args","Error","captureStackTrace","ValueError","MissingError","_toDate","val","def","_isAMomentObject","date","moment","isValid","_get_min","d1","d2","toDate","_get_max","RoughDate","start","end","raw","setState","toISOString","delta","add","isFuzzy","format","e","getMonth","getDate","getFullYear","getEarliest","getLatest","DateRange","isExact","both","m","toMoment","other","s1","s2","getStart","getEnd","getRaw","getLatestDate","getEarliestDate","getEarliestString","getLatestString","eq","lt","gt","unDry","Dry","registerClass","_clean","hasBounds","isInstant","getStartString","getEndString","getEarliestStart","merge","getLatestEnd","hasStart","hasEnd","my_start","other_start","my_end","other_end","contains","scale","getDelta","toString","tmp","dates","SourceList","sources","output","daterange","mergeAll","body","WeightsList","weights","_filterWindow","values","ret","intersect","_filterProject","Person","titles","firstnames","surnames","suffixes","affiliations","alive","gender","notes","orig_name","_getHook","_isAPersonObject","ids","seen","nsources","nprojects","person","getAlive","hook","parts","part","getTitle","getFirstName","getSurname","getSuffix","scores","content","projectKey","isAnchor","shape","sort","c","_generate_person_uid","People","registry","_names","_isAPeopleObject","load","_updateHooks","names","canAdd","existing","getByName","clone","trim","results","indexOf","funcs","people","timeline","getTimeLine","anchor","getNode","is_anchor","array","element","v","Business","_isABusinessObject","business","_generate_business_uid","Businesses","_isABusinessesObject","businesses","_mergeSources","Connection","n0","n1","shared","duration","correspondances","_isAConnectionObject","node0","getNode0","node1","getNode1","getDuration","getNode0Name","getNode1Name","getColorFromType","_generate_connection_uid","Connections","_isAConnectionsObject","connection","nnodes","_add","getNode0ID","getNode1ID","areNodesVisible","toEdge","Position","_isAPositionObject","canonical","makeCanonical","_generate_position_uid","Positions","_isAPositionsObject","_isApositionObject","Affiliation","_isAAffiliationObject","_generate_affiliation_uid","Affiliations","_isAAffiliationsObject","affiliation","Source","description","_isASourceObject","ne","_generate_source_uid","Sources","_isASourcesObject","getDescription","Note","_isANoteObject","getText","_generate_note_uid","Notes","_isANotesObject","note","Project","url","_isAProjectObject","start_time","end_time","project_id","_generate_project_uid","Projects","_isAProjectsObject","Biographies","bios","_isABiographiesObject","biography","bio","_push","enabled","timestep","Social","cache","projectTimeLine","itemTimeLine","node_filters","edge_filters","max_window","_rebuilding","_isASocialObject","getHook","biographies","getWindow","filterWindow","project_filter","filterProject","source_filter","filterSource","node_filter","getConnectionsTo","group_filter","inGroup","new_window","getStartDate","getEndDate","fitted","_fitWindow","setWindow","clearCache","filtered","getNodeFilters","getEdgeFilters","getConnections","f","_getType","result","getPeople","find","getBusinesses","getAffiliations","getSources","search","getProjects","getNodes","concat","getEdges","added","getNotes","default_text","getBiography","pages","a","InfoBox","image","default_image","person_image","business_image","source_image","asources","getAffiliationSources","csources","getCorrespondanceSources","getWeights","getType","analysis_image","extractData","tabs","panes","tabId","tabPanel","tab","tabFor","heroImage","alt","src","vertical","defaultTab","tablist","NewTimeline","setFilter","itemRenderer","defaultTimeStart","defaultTimeEnd","textStyle","overflow","paddingLeft","textOverflow","whiteSpace","dateHeaderStyle","backgroundColor","shipName","resetFilters","itemContext","getItemProps","resizing","borderStyle","borderWidth","onMouseDown","timeline_items","getNewTimeLine","sidebarWidth","itemTouchSendsClick","stackItems","lineHeight","itemHeightRatio","showCursorLine","canMove","canResize","traditionalZoom","timeSteps","year","unit","intervals","headerContext","getRootProps","getIntervalProps","interval","borderLeft","startTime","TimeLineBox","dimensions","deactivate","activate","tabList","shipSelect","centerContainer","filterList","maxWidth","FilterBox","filter_text","getFilterText","emitClearFilters","filter_info","filterContainer","filterText","SlidingPanel","isOpen","defaultSize","minSize","maxSize","rightContainer","transition","SlideFromRight","horiz_size","vert_size","maxHeight","bottomContainer","SlideFromBottom","topContainer","SlideFromTop","leftContainer","SlideFromLeft","CSSTransition","in","timeout","classNames","unmountOnExit","OverlayBox","loading","getURL","fadeIn","onLoad","hideSpinner","frameBorder","marginHeight","marginWidth","sandbox","emitClose","SearchResults","SearchBar","suggestions","searching","nextProps","searchText","createButton","setSuggestions","setResults","setTimeout","startSearch","startSuggestion","event","isSearching","autocomplete","isEmpty","which","keyCode","searchFor","searchContainer","resultContainer","searchPending","display","closeResultButton","stopSearch","searchResult","hamburgerButton","emitHamburgerClicked","searchBox","onKeyPress","onEnter","placeholder","isSearchingComponent","isSuggesting","isSuggestingComponent","hasResults","resultsComponent","BrunelMenu","viewAbout","viewSource","setOverlay","open","focus","sidebar","logo","clickReset","ShipSelector","ssGW","shipFilter","ShipTitle","shipTitle","SocialApp","parse","graph_data","setAnchor","setMaxWindow","highlighted_item","selected_item","overlayItem","isInfoPanelOpen","isTimeLinePanelOpen","isFilterPanelOpen","isHamburgerMenuOpen","isOverlayOpen","isAnalysisOpen","wobbleEnabled","selectedShip","socialGraph","slotToggleFilter","toggleFilter","showInfo","closePanels","location","reload","graphContainerClass","graphContainerMenuClosed","onRequestClose","closeOverlay","contentLabel","modal","overlayClassName","base","modalOverlay","afterOpen","modalOverlayAfterOpen","beforeClose","modalOverlayBeforeClose","closeTimeoutMS","appElement","document","getElementById","closeOverlayButton","slotSelected","emitHighlighted","slotHighlighted","slotClicked","closePanelButton","slotSetFilterbyID","slotClearFilters","resetAll","clickSource","shipNameContainer","slotSetFilter","rightSidePanel","AnalysisButton","toggleAnalysisPanel"],"mappings":"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","file":"static/js/3.136d8ffe.chunk.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"button\":\"TextButton_button__2yNkD\",\"verticalSpaceTitle\":\"TextButton_verticalSpaceTitle__2Tk5T\",\"verticalSpace\":\"TextButton_verticalSpace__2Q6Km\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"titleText\":\"AnalysisPanel_titleText__b6UZM\",\"wholePanel\":\"AnalysisPanel_wholePanel__yyW2P\",\"buttonPanel\":\"AnalysisPanel_buttonPanel__1nbYH\",\"button\":\"AnalysisPanel_button__297y3\",\"verticalSpaceTitle\":\"AnalysisPanel_verticalSpaceTitle__zFl5A\",\"verticalSpace\":\"AnalysisPanel_verticalSpace__ZeDzh\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"button\":\"AnalysisButton_button__27DRu\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"accordion\":\"Accordion_accordion__34t4_\",\"accordionItem\":\"Accordion_accordionItem__VO6pK\",\"accordionButton\":\"Accordion_accordionButton__hVXWw\",\"accordionPanel\":\"Accordion_accordionPanel__1rZAH\",\"fadein\":\"Accordion_fadein__2cKpJ\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"button\":\"DefaultButton_button__1Uv_G\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"checkBox\":\"CheckBox_checkBox__36R4T\",\"checkMark\":\"CheckBox_checkMark__2h9Jd\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"list\":\"ResponsiveList_list__1-ZoE\",\"item\":\"ResponsiveList_item__3jhI7\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"project\":\"GroupsList_project__1pnkG\",\"projectHeader\":\"GroupsList_projectHeader__1YDl_\",\"projectBody\":\"GroupsList_projectBody__2Joe0\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"connections\":\"ConnectionList_connections__2QbO3\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"project\":\"WeightsList_project__3m0SJ\",\"projectHeader\":\"WeightsList_projectHeader__25IKl\",\"projectBody\":\"WeightsList_projectBody__3JVF3\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"InfoBox_container__2EWGz\",\"heroImage\":\"InfoBox_heroImage__34BXw\",\"title\":\"InfoBox_title__2rO4Z\",\"button\":\"InfoBox_button__3w2z7\",\"tabs\":\"InfoBox_tabs__32XI5\",\"tablist\":\"InfoBox_tablist__3mBju\",\"tab\":\"InfoBox_tab__qp9XR\",\"tabPanel\":\"InfoBox_tabPanel__3FpOY\"};","module.exports = __webpack_public_path__ + \"static/media/RHowlett_IKB.68e88d10.jpg\";","module.exports = __webpack_public_path__ + \"static/media/IllustriteZeitung_SS_GreatBritain.946104e0.png\";","module.exports = __webpack_public_path__ + \"static/media/320px-SS_Great_Britain_diagram.898c32f6.jpg\";","module.exports = __webpack_public_path__ + \"static/media/Sumerian_26th_c_Adab.757d98b8.jpg\";","module.exports = __webpack_public_path__ + \"static/media/320px-SS_Great_Britain_transverse_section.7767cb60.jpg\";","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"TimeLineBox_container__3XwaK\",\"centerContainer\":\"TimeLineBox_centerContainer__16Ujh\",\"tabs\":\"TimeLineBox_tabs__yHSvr\",\"tablist\":\"TimeLineBox_tablist__yB2UA\",\"tab\":\"TimeLineBox_tab__157Wu\",\"tabPanel\":\"TimeLineBox_tabPanel__3u0d3\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"filterContainer\":\"FilterBox_filterContainer__2KAxt\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"SlidingPanel_container__360Fr\",\"leftContainer\":\"SlidingPanel_leftContainer__hQNC6\",\"rightContainer\":\"SlidingPanel_rightContainer__57qYr\",\"topContainer\":\"SlidingPanel_topContainer__YiYRz\",\"bottomContainer\":\"SlidingPanel_bottomContainer__2dEzd\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"enter\":\"SlideFromLeft_enter__jKjRY\",\"enterActive\":\"SlideFromLeft_enterActive__159kE\",\"exit\":\"SlideFromLeft_exit___gRJ9\",\"exitActive\":\"SlideFromLeft_exitActive__YfXDY\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"enter\":\"SlideFromRight_enter__3at5G\",\"enterActive\":\"SlideFromRight_enterActive__qhcn3\",\"exit\":\"SlideFromRight_exit__C9Did\",\"exitActive\":\"SlideFromRight_exitActive__2HcMW\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"enter\":\"SlideFromBottom_enter__1iOKm\",\"enterActive\":\"SlideFromBottom_enterActive__248cg\",\"exit\":\"SlideFromBottom_exit__1SBqa\",\"exitActive\":\"SlideFromBottom_exitActive__1TiIq\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"enter\":\"SlideFromTop_enter__2sGUw\",\"enterActive\":\"SlideFromTop_enterActive__3jElj\",\"exit\":\"SlideFromTop_exit__28rU4\",\"exitActive\":\"SlideFromTop_exitActive__2_Nxz\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"OverlayBox_container__2H63R\",\"centerContainer\":\"OverlayBox_centerContainer__bl7gf\",\"button\":\"OverlayBox_button__V4JvO\",\"url\":\"OverlayBox_url__aN8n5\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"SearchBar_container__1nsMW\",\"searchContainer\":\"SearchBar_searchContainer__2xOxT\",\"resultContainer\":\"SearchBar_resultContainer__1_9Lx\",\"searchPending\":\"SearchBar_searchPending__1uhP9\",\"searchResult\":\"SearchBar_searchResult__1iaaf\",\"hamburgerButton\":\"SearchBar_hamburgerButton__1PuEk\",\"searchBox\":\"SearchBar_searchBox__3PHmH\",\"disabledButton\":\"SearchBar_disabledButton__2PWwO\",\"searchButton\":\"SearchBar_searchButton__1GItM\",\"magnifier\":\"SearchBar_magnifier__2xBEb\",\"closeResultButton\":\"SearchBar_closeResultButton__MIs2K\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"sidebar\":\"BrunelMenu_sidebar__2yyDb\",\"logo\":\"BrunelMenu_logo__274YW\",\"verticalSpace\":\"BrunelMenu_verticalSpace__1fWiP\",\"button\":\"BrunelMenu_button__2Bp85\"};","module.exports = __webpack_public_path__ + \"static/media/ssgb_logo.ee48e16d.png\";","// extracted by mini-css-extract-plugin\nmodule.exports = {\"button\":\"ShipSelector_button__1cPR1\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"shipTitle\":\"ShipTitle_shipTitle__3ELcB\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"module\":\"SocialApp_module__3Cefy\",\"graphContainer\":\"SocialApp_graphContainer__1fIZ_\",\"graphContainerMenuClosed\":\"SocialApp_graphContainerMenuClosed__VzCoB\",\"graphContainerMenuOpen\":\"SocialApp_graphContainerMenuOpen__z6JxE\",\"shipNameContainer\":\"SocialApp_shipNameContainer__3G7ll\",\"controlButton\":\"SocialApp_controlButton__dd05U\",\"analysisButtons\":\"SocialApp_analysisButtons__1quBU\",\"bottomContainer\":\"SocialApp_bottomContainer__7teeO\",\"rightSidePanel\":\"SocialApp_rightSidePanel__3D6TX\",\"filterText\":\"SocialApp_filterText__12DDf\",\"citationText\":\"SocialApp_citationText__m100A\",\"closePanelButton\":\"SocialApp_closePanelButton__S0EAB\",\"closeOverlayButton\":\"SocialApp_closeOverlayButton__38BCO\",\"modal\":\"SocialApp_modal__7Dp7u\",\"modalOverlay\":\"SocialApp_modalOverlay__8objV\",\"modalOverlayAfterOpen\":\"SocialApp_modalOverlayAfterOpen__3azyt\",\"modalOverlayBeforeClose\":\"SocialApp_modalOverlayBeforeClose__3K48w\",\"sidebarVis\":\"SocialApp_sidebarVis__eSMUM\",\"sidebarInvis\":\"SocialApp_sidebarInvis__2tJ2j\"};","/** @jsx jsx */\nimport PropTypes from \"prop-types\";\nimport React from \"react\";\n\nimport { jsx } from \"@emotion/core\";\n\nimport styles from \"./TextButton.module.css\";\n\nclass TextButton extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.defaultCSS = {\n      background: \"none\",\n      border: \"none\",\n      fontFamily: \"Playfair Display SC\",\n      color: \"#f1f1f1\",\n      cursor: \"pointer\",\n      /* Responsive text size */\n      fontSize: \"calc(12px + (26 - 14) * ((100vw - 300px) / (1600 - 300)))\",\n      padding: \"8px 8px 8px 32px\",\n      textAlign: \"left\",\n      \"&:hover\": { color: \"red\" },\n    };\n  }\n  render() {\n    const css = this.defaultCSS;\n\n    if (this.props.textColor) {\n      css[\"color\"] = this.props.textColor;\n    }\n\n    if (this.props.hoverColor) {\n      css[\"&:hover\"][\"color\"] = this.props.hoverColor;\n    }\n\n    if (this.props.fontSize) {\n      css[\"fontSize\"] = \"calc(\" + this.props.fontSize + \"+ (26 - 14) * ((100vw - 300px) / (1600 - 300)))\";\n    }\n\n    return (\n      <button\n        className={styles.button}\n        css={css}\n        onClick={() => {\n          this.props.onClick();\n        }}\n      >\n        {this.props.children}\n      </button>\n    );\n  }\n}\n\nTextButton.propTypes = {\n  children: PropTypes.any,\n  hoverColor: PropTypes.string,\n  textColor: PropTypes.string,\n  onClick: PropTypes.func,\n  style: PropTypes.object,\n};\n\nexport default TextButton;\n","import PropTypes from \"prop-types\";\nimport React from \"react\";\n\nimport TextButton from \"./TextButton\";\nimport styles from \"./AnalysisPanel.module.css\";\n\nclass AnalysisPanel extends React.Component {\n  render() {\n    return (\n      <div className={styles.wholePanel}>\n        <div className={styles.verticalSpaceTitle}></div>\n        <div className={styles.titleText}>Analysis</div>\n        <div className={styles.verticalSpace}></div>\n        <TextButton\n          className={styles.button}\n          onClick={() => {\n            this.props.toggleFilterPanel();\n            this.props.togglePanel();\n          }}\n        >\n          Filters\n        </TextButton>\n        <button\n          className={styles.button}\n          onClick={() => {\n            this.props.toggleTimeLinePanel();\n            this.props.togglePanel();\n          }}\n        >\n          Timeline\n        </button>\n        <button\n          className={styles.button}\n          onClick={() => {\n            this.props.toggleWobble();\n          }}\n        >\n          Wobble\n        </button>\n        <div className={styles.verticalSpace}></div>\n        <button\n          className={styles.button}\n          onClick={() => {\n            this.props.togglePanel();\n          }}\n        >\n          Close\n        </button>\n      </div>\n    );\n  }\n}\n\nAnalysisPanel.propTypes = {\n  toggleFilterPanel: PropTypes.func.isRequired,\n  toggleTimeLinePanel: PropTypes.func.isRequired,\n  toggleWobble: PropTypes.func.isRequired,\n  togglePanel: PropTypes.func.isRequired,\n};\n\nexport default AnalysisPanel;\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\n\nimport styles from \"./AnalysisButton.module.css\";\n\nclass AnalysisButon extends React.Component {\n  render() {\n    return (\n      <button className={styles.button} onClick={this.props.togglePanel}>\n        Analysis\n      </button>\n    );\n  }\n}\n\nAnalysisButon.propTypes = {\n  togglePanel: PropTypes.func.isRequired,\n};\n\nexport default AnalysisButon;\n","import * as d3 from \"d3\";\n\nimport React from \"react\";\nimport lodash from \"lodash\";\n\nimport { v4 as uuidv4 } from \"uuid\";\n\nimport styles from \"../ForceGraph.module.css\";\n\nimport positionGroups from \"../../position_groups.json\";\n\nfunction _null_function() {}\n\nfunction constrain(x, w, r = 20) {\n  return Math.max(r, Math.min(w - r, x));\n}\n\nfunction handleMouseClick(THIS) {\n  function handle() {\n    let svg = THIS._mainGroup;\n    if (!svg) {\n      return;\n    }\n\n    let node = d3.select(this);\n    node.raise();\n\n    let id = node.attr(\"id\");\n\n    if (!id) {\n      return;\n    }\n\n    let items = svg.selectAll(`#${id}`);\n\n    items.classed(styles.highlight, true);\n\n    items = svg.selectAll(`[source_id=${id}]`);\n    items.classed(styles.highlight, true);\n\n    items = svg.selectAll(`[target_id=${id}]`);\n    items.classed(styles.highlight, true);\n\n    THIS.state.signalClicked(id);\n    d3.event.stopPropagation();\n  }\n\n  return handle;\n}\n\nfunction handleMouseOver(THIS) {\n  function handle() {\n    let svg = THIS._mainGroup;\n    if (!svg) {\n      return;\n    }\n\n    let node = d3.select(this);\n    node.raise();\n\n    let id = node.attr(\"id\");\n\n    if (!id) {\n      return;\n    }\n\n    //highlight the node\n    let items = svg.selectAll(`#${id}`);\n    items.classed(styles.highlight, true);\n\n    //highlight the connection lines with this node as a source\n    items = svg.selectAll(`[source_id=${id}]`);\n    items.classed(styles.highlight, true);\n\n    //highlight the nodes with this node as a target\n    items.each((d) => {\n      let target_id = d.target.id;\n      svg.selectAll(`#${target_id}`).classed(styles.highlight, true);\n    });\n\n    //highlight the connection lines with this node as a target\n    items = svg.selectAll(`[target_id=${id}]`);\n    items.classed(styles.highlight, true);\n\n    //highlight the nodes with this node as a source\n    items.each((d) => {\n      let source_id = d.source.id;\n      svg.selectAll(`#${source_id}`).classed(styles.highlight, true);\n    });\n\n    if (node.attr(\"source_id\")) {\n      svg.selectAll(`#${node.attr(\"source_id\")}`).classed(styles.highlight, true);\n\n      svg.selectAll(`#${node.attr(\"target_id\")}`).classed(styles.highlight, true);\n    }\n\n    THIS.state.signalMouseOver(id);\n  }\n\n  return handle;\n}\n\nfunction handleMouseOut(THIS) {\n  function handle() {\n    let svg = THIS._mainGroup;\n    if (!svg) {\n      return;\n    }\n\n    let node = d3.select(this);\n    let id = node.attr(\"id\");\n\n    let items = svg.selectAll(`#${id}`);\n\n    items.classed(styles.highlight, false);\n\n    //highlight the connection lines with this node as a source\n    items = svg.selectAll(`[source_id=${id}]`);\n    items.classed(styles.highlight, false);\n\n    //highlight the nodes with this node as a target\n    items.each((d) => {\n      let target_id = d.target.id;\n      svg.selectAll(`#${target_id}`).classed(styles.highlight, false);\n    });\n\n    //highlight the connection lines with this node as a target\n    items = svg.selectAll(`[target_id=${id}]`);\n    items.classed(styles.highlight, false);\n\n    //highlight the nodes with this node as a source\n    items.each((d) => {\n      let source_id = d.source.id;\n      svg.selectAll(`#${source_id}`).classed(styles.highlight, false);\n    });\n\n    if (node.attr(\"source_id\")) {\n      svg.selectAll(`#${node.attr(\"source_id\")}`).classed(styles.highlight, false);\n\n      svg.selectAll(`#${node.attr(\"target_id\")}`).classed(styles.highlight, false);\n    }\n\n    THIS.state.signalMouseOut(id);\n  }\n\n  return handle;\n}\n\nfunction _resolve(item) {\n  if (!item) {\n    return null;\n  } else if (item.getID) {\n    return item.getID();\n  } else {\n    return item;\n  }\n}\n\n/** The main class that renders the graph in the ForceGraph */\nclass ForceGraphD3 extends React.Component {\n  constructor(props) {\n    super(props);\n    this._updateSimulation = this._updateSimulation.bind(this);\n    this._updateLink = this._updateLink.bind(this);\n    this._updateNodeText = this._updateNodeText.bind(this);\n    this._updateNode = this._updateNode.bind(this);\n    this.draw = this.draw.bind(this);\n    this.drawFromScratch = this.drawFromScratch.bind(this);\n    this.setPositionColors = this.setPositionColors.bind(this);\n    this.getPositionColor = this.getPositionColor.bind(this);\n    this.update = this.update.bind(this);\n    this.updateGraph = this.updateGraph.bind(this);\n    // this.mouseoverNode = this.mouseoverNode.bind(this);\n\n    this.drag = this.drag.bind(this);\n    this.dragLink = this.dragLink.bind(this);\n    this.getWeight = this.getWeight.bind(this);\n\n    // generate a UID for this graph so that we don't clash\n    // with any other graphs on the same page\n    let uid = uuidv4();\n\n    this.state = {\n      width: null,\n      height: null,\n      social: null,\n      selected: null,\n      highlighted: null,\n      signalClicked: _null_function,\n      signalMouseOut: _null_function,\n      signalMouseOver: _null_function,\n      colors: {},\n      groupTable: {},\n      uid: uid.slice(uid.length - 8),\n    };\n\n    this._size_changed = true;\n    this._graph_changed = true;\n    this._is_running = false;\n    this._is_drawn = false;\n\n    // Set parameters for the force simulation\n    this._target_decay = 0.4;\n    this._target_alpha = 0.3;\n\n    this._tooltips = [];\n    // this.updateGraph = this.updateGraph.bind(this);\n    // this.update = this.update.bind(this);\n\n    this.update(props);\n  }\n\n  getSelectedShipID() {\n    const filter = this.state.social.getFilter();\n\n    if (filter[\"project\"]) {\n      const projectCode = Object.keys(filter[\"project\"])[0];\n\n      return projectCode;\n    }\n  }\n\n  getNodeBio(id) {\n    return this.state.social.getBiographies().getByID(id);\n  }\n\n  updateGraph(social) {\n    let w = this.state.width;\n    let h = this.state.height;\n\n    this.state.social = social;\n\n    if (!w || !h) {\n      return;\n    }\n\n    let graph = null;\n\n    if (social) {\n      graph = social.getGraph();\n    }\n\n    // The social object will cache the 'getGraph' result, meaning\n    // that any change in this object signals that the graph needs\n    // to be redrawn\n    if (graph !== this.state.graph) {\n      //save the cached graph\n      this.state.graph = graph;\n      //   this.setState({ graph: graph });\n\n      // This view needs to clone its own copy of the graph, as\n      // D3 will update the graph object. We need to clone in case\n      // two ForceGraph.d3 views are viewing the same Social graph\n      graph = lodash.cloneDeep(this.state.graph);\n\n      // need to update IDs so that the edges refer to the index\n      // of the node in the nodes array - this could be optimised!\n      for (let l in graph.edges) {\n        let edge = graph.edges[l];\n        for (let n in graph.nodes) {\n          let node = graph.nodes[n];\n          if (edge.source === node.id) {\n            edge.source = n;\n            edge.source_id = node.id;\n          } else if (edge.target === node.id) {\n            edge.target = n;\n            edge.target_id = node.id;\n          }\n        }\n      }\n\n      //index any old nodes\n      let old_nodes = [];\n      let old = {};\n\n      if (this._graph) {\n        old_nodes = this._graph.nodes;\n\n        for (let n in old_nodes) {\n          old[old_nodes[n].id] = n;\n        }\n      }\n\n      for (let n in graph.nodes) {\n        let node = graph.nodes[n];\n\n        let i = old[node.id];\n\n        if (i) {\n          let o = old_nodes[i];\n          node.x = o.x;\n          node.y = o.y;\n        } else {\n          node.x = w * Math.random();\n          node.y = h * Math.random();\n        }\n\n        if (node.fixed) {\n          if (i) {\n            node.fx = node.x;\n            node.fy = node.y;\n          } else {\n            node.fx = w / 2;\n            node.fy = h / 2;\n          }\n        }\n      }\n\n      this._graph = graph;\n      this._graph_changed = true;\n    }\n  }\n\n  update(props) {\n    let size_changed = false;\n\n    if (props.wobble) {\n      this._target_decay = 0.4;\n      this._target_alpha = 0.3;\n    } else {\n      this._target_decay = 0.4;\n      this._target_alpha = 0;\n    }\n\n    if (props.selectedShipID && props.selectedShipID !== this.state.lastShip) {\n      this.state.lastShip = props.selectedShipID;\n      this._graph_changed = true;\n    }\n\n    let hasWidth = Object.prototype.hasOwnProperty.call(props, \"width\");\n\n    if (hasWidth) {\n      if (this.state.width !== props.width) {\n        this.state.width = props.width;\n        // this.setState({ width: props.width });\n        size_changed = true;\n      }\n    }\n\n    let hasHeight = Object.prototype.hasOwnProperty.call(props, \"height\");\n\n    if (hasHeight) {\n      if (this.state.height !== props.height) {\n        this.state.height = props.height;\n        // this.setState({ height: props.height });\n        size_changed = true;\n      }\n    }\n\n    if (size_changed) {\n      this._size_changed = true;\n    }\n\n    let hasSignalClicked = Object.prototype.hasOwnProperty.call(props, \"signalClicked\");\n\n    if (hasSignalClicked) {\n      if (this.state.signalClicked) {\n        this.state.signalClicked = props.signalClicked;\n        // this.setState({ signalClicked: props.signalClicked });\n      } else {\n        this.state.signalClicked = _null_function;\n        // this.setState({ signalClicked: _null_function });\n      }\n    }\n\n    let hasSignalMouseOut = Object.prototype.hasOwnProperty.call(props, \"signalMouseOut\");\n\n    if (hasSignalMouseOut) {\n      if (this.state.signalMouseOut) {\n        this.state.signalMouseOut = props.signalMouseOut;\n        // this.setState({ signalMouseOut: props.signalMouseOut });\n      } else {\n        this.state.signalMouseOut = _null_function;\n        // this.setState({ signalMouseOut: _null_function });\n      }\n    }\n\n    let hasSignalMouseOver = Object.prototype.hasOwnProperty.call(props, \"signalMouseOver\");\n\n    if (hasSignalMouseOver) {\n      if (this.state.signalMouseOver) {\n        this.state.signalMouseOver = props.signalMouseOver;\n        // this.setState({ signalMouseOver: props.signalMouseOver });\n      } else {\n        this.state.signalMouseOver = _null_function;\n        // this.setState({ signalMouseOver: _null_function });\n      }\n    }\n\n    let hasSocial = Object.prototype.hasOwnProperty.call(props, \"social\");\n\n    if (hasSocial) {\n      this.updateGraph(props.social);\n    }\n\n    // We can setup the colours object\n    this.setPositionColors();\n\n    let hasSelected = Object.prototype.hasOwnProperty.call(props, \"selected\");\n\n    if (hasSelected) {\n      this.state.selected = _resolve(props.selected);\n      //   this.setState({ selected: _resolve(props.selected) });\n    }\n\n    let hasHighlighted = Object.prototype.hasOwnProperty.call(props, \"highlighted\");\n\n    if (hasHighlighted) {\n      this.state.highlighted = _resolve(props.highlighted);\n      //   this.setState({ highlighted: _resolve(props.highlighted) });\n    }\n  }\n\n  className() {\n    return `ForceGraphD3-${this.state.uid}`;\n  }\n\n  getPositionColor(entity) {\n    // This takes an entity (a person or a business) and finds the\n    // colour that's given in the positions_groups.json file\n    const positions = entity[\"positions\"];\n    const group = entity[\"group\"];\n\n    if (group === \"anchor\") {\n      return positionGroups[\"anchor\"][\"color\"];\n    }\n\n    // If we get an undefined position return white\n    if (!positions) {\n      const entity_id = entity[\"id\"].toLowerCase();\n\n      if (entity_id.startsWith(\"b\")) {\n        return positionGroups[\"business\"][\"color\"];\n      } else {\n        console.error(\"No colour available for this entity : \", entity);\n        return \"#FFFFFF\";\n      }\n    }\n\n    const positionCode = this.getPositionCode(positions, group);\n\n    return this.state.colors[positionCode];\n  }\n\n  getPositionCode(positions, group) {\n    // Split string by colon, for now just use the first value\n    if (group === \"anchor\") {\n      console.error(\"We got an anchor here somehow\", positions, group);\n      return \"unkown\";\n    }\n\n    let positionCode;\n    // Split the string and try both\n    const splitGroup = group.split(\":\");\n\n    try {\n      // As some of the positions objects don't have a value for both\n      // projects (called groups here) we have to check both\n      try {\n        positionCode = positions[splitGroup[0]][0];\n      } catch (error) {\n        positionCode = positions[splitGroup[1]][0];\n      }\n    } catch (error) {\n      console.error(\"Error with position \", positions, \" with group : \", group, \"splitGroup : \", splitGroup, error);\n      positionCode = \"unknown\";\n    }\n\n    return positionCode.toLowerCase();\n  }\n\n  setPositionColors() {\n    // Read all the positions for this graph\n    const namedPositions = this.state.social.getPositions().items();\n\n    let colorTable = {};\n    let groupTable = {};\n\n    // TODO - a lot of this could be made easier by just assigning fixed UIDs to\n    // positions, could make a small object that did that and a notebook to output\n    // a JSON that's read in here for groups etc?\n\n    // Read the positions and colours from a JSON file that can be easily updated\n    for (let [position, uid] of Object.entries(namedPositions)) {\n      uid = uid.toLowerCase();\n      // Process these to remove whitespace and non letter/number characters so we have less likelihood of errors\n      let trimPosition = position\n        .replace(/\\s/g, \"\")\n        .toLowerCase()\n        .replace(/[.,/#!$%^&*;:{}=\\-_`~()]/g, \"\");\n      // .replace(/[.,\\/#!$%\\^&\\*;:{}=\\-_`~()]/g, \"\");\n\n      // Here positionGroups is the import JSON object containing\n      // which positions are in which group and the colour assigned to them\n      for (let [group, members] of Object.entries(positionGroups)) {\n        if (members[\"members\"].includes(trimPosition)) {\n          colorTable[uid] = members[\"color\"];\n          groupTable[uid] = group;\n          break;\n        } else {\n          // Assign bright blue to any we don't recognize, but this\n          // shouldn't (hopefully) happen if the JSON is correct\n          colorTable[uid] = \"blue\";\n        }\n      }\n    }\n\n    // Set the colour for the anchor\n    colorTable[\"anchor\"] = positionGroups[\"anchor\"][\"color\"];\n\n    this.state.colors = colorTable;\n    this.state.groupTable = groupTable;\n  }\n\n  getGroupForce(entity) {\n    if (!entity.positions) {\n      const entity_id = entity[\"id\"].toLowerCase();\n\n      // Need a better way of handling businesses\n      if (entity_id.startsWith(\"b\")) {\n        return -0.11;\n      } else {\n        console.log(\"Undefined positions for entity \", entity);\n        return 0;\n      }\n    }\n\n    const leftForce = [\"engineering\"];\n    const rightForce = [\"commercial\"];\n    const noForce = [\"other\", \"anchor\", \"business\", \"unknown\"];\n\n    // Get the position codes for this entity\n    const positionCode = this.getPositionCode(entity.positions, entity.group);\n    // The groupTable tells us which group this entity belongs to and so determines its force\n    const positionGroup = this.state.groupTable[positionCode];\n\n    // TODO - clunky, fix\n    if (leftForce.includes(positionGroup)) {\n      return -0.17;\n    } else if (rightForce.includes(positionGroup)) {\n      return 0.1;\n    } else if (noForce.includes(positionGroup)) {\n      return 0.1;\n    }\n\n    return 0;\n  }\n\n  drag() {\n    let simulation = this._simulation;\n\n    return d3\n      .drag()\n      .on(\"start\", (d) => {\n        simulation.alphaTarget(this._target_alpha).velocityDecay(this._target_decay).restart();\n\n        d.fx = d.x;\n        d.fy = d.y;\n      })\n      .on(\"drag\", (d) => {\n        if (!this._is_running) simulation.restart();\n\n        let w = this.state.width;\n        let h = this.state.height;\n\n        d.fx = constrain(d3.event.x, w, d.r);\n        d.fy = constrain(d3.event.y, h, d.r);\n      })\n      .on(\"end\", (d) => {\n        simulation.alphaTarget(0).restart();\n\n        if (!d.fixed) {\n          d.fx = null;\n          d.fy = null;\n        }\n      });\n  }\n\n  dragLink() {\n    let simulation = this._simulation;\n\n    return d3\n      .drag()\n      .on(\"start\", (d) => {\n        simulation.alphaTarget(this._target_alpha).velocityDecay(this._target_decay).restart();\n\n        //find the two nodes connected to this edge\n        let source = this._graph.nodes[d.source.index];\n        let target = this._graph.nodes[d.target.index];\n\n        //fix those nodes in place\n        source.fx = source.x;\n        source.fy = source.y;\n\n        target.fx = target.x;\n        target.fy = target.y;\n      })\n      .on(\"drag\", (d) => {\n        if (!this._is_running) simulation.restart();\n\n        //find the two nodes connected to this edge\n        let source = this._graph.nodes[d.source.index];\n        let target = this._graph.nodes[d.target.index];\n\n        //moves those nodes with the event - move the center point of the\n        //line connecting these two nodes...\n        let dx = 0.5 * (target.x - source.x);\n        let dy = 0.5 * (target.y - source.y);\n\n        source.fx = constrain(d3.event.x - dx, this.state.width, source.r);\n        source.fy = constrain(d3.event.y - dy, this.state.height, source.r);\n\n        target.fx = constrain(d3.event.x + dx, this.state.width, target.r);\n        target.fy = constrain(d3.event.y + dy, this.state.height, target.r);\n      })\n      .on(\"end\", (d) => {\n        simulation.alphaTarget(0).restart();\n\n        //find the two nodes connected to this edge\n        let source = this._graph.nodes[d.source.index];\n        let target = this._graph.nodes[d.target.index];\n\n        if (!source.fixed) {\n          source.fx = null;\n          source.fy = null;\n        }\n\n        if (!target.fixed) {\n          target.fx = null;\n          target.fy = null;\n        }\n      });\n  }\n\n  getWeight(item) {\n    const shipID = this.getSelectedShipID();\n    // Big weights make the size of circles too large\n    const sizeScale = 0.5;\n\n    let weight = sizeScale * item[\"weight\"][shipID];\n\n    if (!weight) {\n      weight = 2;\n    }\n\n    return weight;\n  }\n\n  mouseoverNode(d) {\n    const divSelect = \"#\" + this.className();\n    const uid = \"tooltip_\" + uuidv4();\n\n    console.log(d);\n\n    const name = d.label;\n    const allBio = this.getNodeBio(d.id).replace(d.label + \".\", \"\");\n    const shortBio = allBio.substring(0, 150) + \"...\";\n\n    let tooltip = d3\n      .select(divSelect)\n      .append(\"div\")\n      .attr(\"id\", uid)\n      .attr(\"class\", uid)\n      // Move this into CSS?\n      .html(() => {\n        return \"<h4>\" + name + \"</h4></br><p>\" + shortBio + \"</p>\";\n      })\n      .style(\"position\", \"absolute\")\n      .style(\"padding\", \"10px\")\n      .style(\"z-index\", \"10\")\n      .style(\"width\", \"8%\")\n      .style(\"height\", \"12%\")\n      .style(\"font-family\", \"Playfair Display SemiBold\")\n      .style(\"font-size\", \"14px\")\n      .style(\"background-color\", \"#808080\")\n      .style(\"color\", \"white\")\n      .style(\"border-radius\", \"1px\")\n      .style(\"top\", d3.event.pageY - 10 + \"px\")\n      .style(\"left\", d3.event.pageX + 10 + \"px\")\n      .style(\"visibility\", \"visible\");\n    //   .text(\"<h4>Example tooltip for \" + d.id + \"</h4>\");\n\n    this._tooltips.push(uid);\n    // place tooltip where cursor was\n    // # Can always change the x and y here is event is null\n    return tooltip;\n  }\n\n  mouseoutNode() {\n    d3.selectAll(\"div[id^=tooltip_]\").remove();\n  }\n\n  _updateNode(data) {\n    let node = this._mainGroup.select(\".node-group\").selectAll(\".node\");\n\n    node = node\n      .data(data, (d) => d.id)\n      .join(\n        (enter) => enter.append(\"circle\").attr(\"class\", `node ${styles.node}`),\n        (update) => update.attr(\"class\", `node ${styles.node}`)\n      )\n      // Here size is the weight given to that entity\n      .attr(\"r\", (d) => {\n        // If no project selected keep previous weight\n        // Otherwise update using the selected project code\n        return this.getWeight(d);\n      })\n      .attr(\"id\", (d) => {\n        return d.id;\n      })\n      .attr(\"fill\", (d) => {\n        return this.getPositionColor(d);\n      })\n      //   .on(\"click\", this.mouseoverNode)\n      .on(\"mouseover\", (d) => this.mouseoverNode(d))\n      .on(\"mouseout\", this.mouseoutNode)\n      .call(this.drag());\n\n    return node;\n  }\n\n  _updateNodeText(data) {\n    let text = this._mainGroup.select(\".node_text-group\").selectAll(\".node_text\");\n\n    // Big weights make the size of circles too large\n    const sizeScale = 0.5;\n\n    text = text\n      .data(data, (d) => d.id)\n      .join(\n        (enter) => enter.append(\"text\").attr(\"class\", `node_text ${styles.node_text}`),\n        (update) => update.attr(\"class\", `node_text ${styles.node_text}`)\n      )\n      .text((d) => d.label)\n      .attr(\"dx\", \"0.5em\")\n      // This keeps the text from the centre of the circle\n      // TODO -  could get this to be within the circle if the\n      // circle is large enough?\n      .attr(\"dy\", (d) => {\n        const weight = this.getWeight(d);\n\n        return -1 * (3 + sizeScale * weight);\n      })\n      .attr(\"text-anchor\", \"start\")\n      .attr(\"id\", (d) => {\n        return d.id;\n      })\n      .on(\"click\", handleMouseClick(this))\n      .on(\"mouseover\", handleMouseOver(this))\n      .on(\"mouseout\", handleMouseOut(this))\n      .call(this.drag());\n\n    return text;\n  }\n\n  _updateLink(data) {\n    let link = this._mainGroup.select(\".link-group\").selectAll(\".link\");\n\n    const weightCutoff = 4;\n\n    link = link\n      .data(data, (d) => d.id)\n      .join(\n        (enter) => enter.append(\"path\").attr(\"class\", `link ${styles.link}`),\n        (update) => update.attr(\"class\", `link ${styles.link}`)\n      )\n      .attr(\"class\", (d) => {\n        // Here we're using the weight of the edges between\n        // nodes to  change the properties of the line drawn\n        if (d.type === \"direct\") {\n          if (d.value > weightCutoff) {\n            return `link ${styles.link}`;\n          } else {\n            return `link ${styles.link_weak}`;\n          }\n        } else {\n          return `link ${styles.link_indirect}`;\n        }\n      })\n      .attr(\"id\", (d) => {\n        return d.id;\n      })\n      .attr(\"source_id\", (d) => {\n        return d.source_id;\n      })\n      .attr(\"target_id\", (d) => {\n        return d.target_id;\n      })\n      .on(\"click\", handleMouseClick(this))\n      .on(\"mouseover\", handleMouseOver(this))\n      .on(\"mouseout\", handleMouseOut(this))\n      .call(this.dragLink());\n\n    return link;\n  }\n\n  _updateSimulation() {\n    if (this._simulation) {\n      this._simulation.stop();\n      this._simulation = null;\n      this._is_running = false;\n    }\n\n    let w = this.state.width;\n    let h = this.state.height;\n\n    let simulation = d3\n      .forceSimulation(this._graph.nodes)\n      .force(\"charge\", d3.forceManyBody().strength(-150).distanceMin(10).distanceMax(25))\n      .force(\n        \"link\",\n        d3\n          .forceLink()\n          .links(this._graph.edges)\n          //   .strength((d) => {\n          //     return 0.1 * (1 + d.value);\n          //   })\n          .distance((d) => {\n            return 75 * (1 + d.value);\n          })\n          .iterations(5)\n      )\n      .force(\n        \"collision\",\n        d3\n          .forceCollide()\n          .radius((d) => {\n            return 3 * (1 + d.size);\n          })\n          .strength(1.0)\n          .iterations(5)\n      )\n      // This forces the groupings given in position_groups.json left/right\n      .force(\n        \"X\",\n        d3.forceX().strength((d) => {\n          return this.getGroupForce(d);\n        })\n      )\n      // This function with help from https://stackoverflow.com/a/13456081\n      .on(\"tick\", () => {\n        this._link.attr(\"d\", (d) => {\n          const curveFactor = 2;\n          const dx = d.target.x - d.source.x;\n          const dy = d.target.y - d.source.x;\n          const dr = curveFactor * Math.sqrt(dx * dx + dy * dy);\n\n          return \"M\" + d.source.x + \",\" + d.source.y + \"A\" + dr + \",\" + dr + \" 0 0,1 \" + d.target.x + \",\" + d.target.y;\n        });\n        this._node\n          .attr(\"cx\", (d) => {\n            return (d.x = constrain(d.x, w, d.r));\n          })\n          .attr(\"cy\", (d) => {\n            return (d.y = constrain(d.y, h, d.r));\n          });\n\n        this._label.attr(\"x\", (d) => d.x).attr(\"y\", (d) => d.y);\n      })\n      .on(\"end\", () => {\n        this.restartSimulation();\n      });\n\n    this._is_running = true;\n\n    // Save the simulation so that we can update it later...\n    this._simulation = simulation;\n  }\n\n  restartSimulation() {\n    this._simulation.restart();\n  }\n\n  drawFromScratch() {\n    console.log(\"DRAW FROM SCRATCH\");\n    let graph = this._graph;\n\n    if (!graph) {\n      if (this.state.social) {\n        this.updateGraph(this.state.social);\n      }\n\n      graph = this._graph;\n      if (!graph) {\n        console.log(\"Nothing to draw...\");\n        return;\n      }\n    }\n\n    d3.select(`.${this.className()} > *`).remove();\n\n    let container = d3.select(`.${this.className()}`);\n\n    if (!container) {\n      console.log(`Cannot find container element class ${this.className()}`);\n      return;\n    }\n\n    const width = this.state.width;\n    const height = this.state.height;\n\n    console.log(`REDRAW ${width}x${height}`);\n\n    if (!width || !height) {\n      console.log(`Invalid width or height? ${width} x ${height}`);\n      return;\n    }\n\n    let svg = container\n      .append(\"svg\")\n      .attr(\"height\", height)\n      .attr(\"width\", width)\n      .attr(\"id\", \"svg-viz\")\n      .attr(\"align\", \"center\")\n      .on(\"click\", () => {\n        this.state.signalClicked(null);\n      });\n\n    let mainGroup = svg;\n    this._mainGroup = mainGroup;\n\n    this._updateSimulation();\n\n    mainGroup.append(\"g\").attr(\"class\", \"link-group\");\n    mainGroup.append(\"g\").attr(\"class\", \"node-group\");\n    mainGroup.append(\"g\").attr(\"class\", \"node_text-group\");\n\n    this._link = this._updateLink(graph.edges);\n    this._node = this._updateNode(graph.nodes);\n    this._label = this._updateNodeText(graph.nodes);\n\n    this._is_drawn = true;\n  }\n\n  draw() {\n    if (!this._is_drawn) {\n      this.drawFromScratch();\n      this._size_changed = false;\n      this._graph_changed = false;\n      return;\n    }\n\n    let update_simulation = false;\n\n    if (this._size_changed) {\n      let container = d3.select(`.${this.className()}`);\n      container.selectAll(\"svg\").attr(\"width\", this.state.width).attr(\"height\", this.state.height);\n      this._size_changed = false;\n      update_simulation = true;\n    }\n\n    if (this._graph_changed) {\n      this._node = this._updateNode(this._graph.nodes);\n      this._label = this._updateNodeText(this._graph.nodes);\n      this._link = this._updateLink(this._graph.edges);\n      this._graph_changed = false;\n      update_simulation = true;\n    }\n\n    if (update_simulation) {\n      this._updateSimulation();\n    }\n  }\n}\n\nexport default ForceGraphD3;\n","import React from \"react\";\nimport ForceGraphD3 from \"./d3/ForceGraph.d3.js\";\nimport styles from \"./ForceGraph.module.css\";\n\nclass ForceGraph extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this._graph = new ForceGraphD3(props);\n    this._updateSize = this._updateSize.bind(this);\n  }\n\n  componentDidMount() {\n    window.addEventListener(\"resize\", this._updateSize);\n    this._updateSize();\n  }\n\n  componentWillUnmount() {\n    window.removeEventListener(\"resize\", this.updateSize);\n  }\n\n  componentDidUpdate() {\n    this._graph.update(this.props);\n    this._graph.draw();\n  }\n\n  _updateSize() {\n    if (this.container && this._graph) {\n      this._graph.update({\n        width: this.container.offsetWidth,\n        height: this.container.offsetHeight,\n      });\n      this._graph.draw();\n    }\n  }\n\n  render() {\n    let s = this._graph.className();\n\n    return (\n      <div ref={(el) => (this.container = el)} style={{ width: \"100%\", height: \"100%\" }}>\n        <div id={s} className={s} />\n      </div>\n    );\n  }\n}\n\nexport default ForceGraph;\n","import PropTypes from \"prop-types\";\nimport React from \"react\";\nimport ForceGraph from \"./ForceGraph\";\n\nclass SocialGraph extends React.Component {\n  getGraph() {\n    const social = this.props.social;\n\n    if (social) {\n      return social.getGraph();\n    }\n    return null;\n  }\n\n  getNetwork() {\n    const social = this.props.social;\n\n    if (social) {\n      return social.getNetwork();\n    }\n    return null;\n  }\n\n  render() {\n    if (this.props.social) {\n      console.log(\"In SocialGraph shipID: \", this.props.selectedShipID);\n      return (\n        <div style={{ width: \"100%\", height: \"100%\" }}>\n          <ForceGraph\n            social={this.props.social}\n            signalClicked={this.props.emitClicked}\n            highlighted={this.props.highlighted}\n            selected={this.props.selected}\n            wobble={this.props.wobble}\n            selectedShipID={this.props.selectedShipID}\n          />\n        </div>\n      );\n    } else {\n      return <div>No data to display!!!</div>;\n    }\n  }\n}\n\nSocialGraph.propTypes = {\n  emitClicked: PropTypes.func.isRequired,\n  highlighted: PropTypes.func,\n  selected: PropTypes.func,\n  social: PropTypes.object.isRequired,\n  wobble: PropTypes.bool.isRequired,\n  selectedShipID: PropTypes.string,\n};\n\nexport default SocialGraph;\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\n\nimport {\n  Accordion,\n  AccordionItem,\n  AccordionItemHeading,\n  AccordionItemButton,\n  AccordionItemPanel,\n} from \"react-accessible-accordion\";\n\nimport styles from \"./Accordion.module.css\";\n\nfunction BAccordion(props) {\n  return (\n    <Accordion\n      className={styles.accordion}\n      preExpanded={props.preExpanded}\n      allowMultipleExpanded={props.allowMultipleExpanded}\n      allowZeroExpanded={props.allowZeroExpanded}\n    >\n      {props.children}\n    </Accordion>\n  );\n}\n\nBAccordion.propTypes = {\n  preExpanded: PropTypes.bool,\n  allowMultipleExpanded: PropTypes.bool,\n  allowZeroExpanded: PropTypes.bool,\n  children: PropTypes.string,\n};\n\nfunction BAccordionItem(props) {\n  return (\n    <AccordionItem className={styles.accordionItem} style={props.style} uuid={props.uuid}>\n      {props.children}\n    </AccordionItem>\n  );\n}\n\nBAccordionItem.propTypes = {\n  style: PropTypes.string,\n  uuid: PropTypes.string,\n  children: PropTypes.string,\n};\n\nfunction BAccordionTitle(props) {\n  return (\n    <AccordionItemHeading style={props.style}>\n      <AccordionItemButton className={styles.accordionButton}>{props.children}</AccordionItemButton>\n    </AccordionItemHeading>\n  );\n}\n\nBAccordionTitle.propTypes = {\n  style: PropTypes.string,\n  children: PropTypes.string,\n};\n\nfunction BAccordionPanel(props) {\n  return <AccordionItemPanel style={props.style}>{props.children}</AccordionItemPanel>;\n}\n\nBAccordionPanel.propTypes = {\n  style: PropTypes.string,\n  children: PropTypes.string,\n};\n\nexport {\n  BAccordion as Accordion,\n  BAccordionItem as AccordionItem,\n  BAccordionTitle as AccordionTitle,\n  BAccordionPanel as AccordionPanel,\n  BAccordion as default,\n};\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\n\nimport styles from \"./DefaultButton.module.css\";\n\nfunction DefaultButton(props) {\n  return (\n    <button href=\"#\" className={styles.button} onClick={props.onClick} style={props.style}>\n      {props.children}\n    </button>\n  );\n}\n\nDefaultButton.propTypes = {\n  onClick: PropTypes.func,\n  style: PropTypes.object,\n  children: PropTypes.string,\n};\n\nexport default DefaultButton;\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\n\nimport styles from \"./CheckBox.module.css\";\n\nfunction CheckBox(props) {\n  return (\n    <label className={styles.checkBox} style={props.style}>\n      <input type=\"checkbox\" checked={props.checked} onChange={props.onChange} />\n      <span className={styles.checkMark} />\n    </label>\n  );\n}\n\nCheckBox.propTypes = {\n  style: PropTypes.string,\n  checked: PropTypes.bool,\n  onChange: PropTypes.func,\n};\n\nexport default CheckBox;\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport styles from \"./ResponsiveList.module.css\";\n\nfunction ResponsiveList(props) {\n  return <div className={styles.list}>{props.children}</div>;\n}\n\nResponsiveList.propTypes = {\n  children: PropTypes.elementType.isRequired,\n};\n\nfunction ResponsiveListItem(props) {\n  return (\n    <div className={styles.item} key={props.key}>\n      {props.children}\n    </div>\n  );\n}\n\nResponsiveListItem.propTypes = {\n  key: PropTypes.string.isRequired,\n  children: PropTypes.elementType.isRequired,\n};\n\nexport { ResponsiveListItem, ResponsiveList, ResponsiveList as default };\n","import React from \"react\";\n\nimport DefaultButton from \"./DefaultButton\";\nimport CheckBox from \"./CheckBox\";\nimport { ResponsiveList, ResponsiveListItem } from \"./ResponsiveList\";\n\nimport styles from \"./GroupsList.module.css\";\n\nfunction null_function() {}\n\nfunction GroupsList({\n  groups,\n  title = null,\n  emitSelected = null_function,\n  emitToggleFilter = null_function,\n  social = null,\n}) {\n  if (!groups) {\n    return null;\n  }\n\n  let projects = [];\n\n  Object.keys(groups).forEach((key) => {\n    let items = [];\n\n    for (let index in groups[key]) {\n      let group = social.get(groups[key][index]);\n      let is_filtered = social.isFiltered(group);\n\n      items.push(\n        <ResponsiveListItem key={group.getName()}>\n          <DefaultButton\n            onClick={() => {\n              emitSelected(group);\n            }}\n            style={{ width: \"70%\" }}\n          >\n            {group.getName()}\n          </DefaultButton>\n          <CheckBox\n            onChange={() => {\n              emitToggleFilter(group);\n            }}\n            style={{ width: \"20%\" }}\n            checked={is_filtered}\n          />\n        </ResponsiveListItem>\n      );\n    }\n\n    let project = social.get(key);\n    let is_filtered = social.isFiltered(project);\n\n    projects.push(\n      <div className={styles.project} key={project.getName()}>\n        <div className={styles.projectHeader}>\n          <DefaultButton\n            style={{ width: \"75%\" }}\n            onClick={() => {\n              emitSelected(project);\n            }}\n          >\n            {project.getName()}\n          </DefaultButton>\n          <CheckBox\n            onChange={() => {\n              emitToggleFilter(project);\n            }}\n            style={{ width: \"20%\" }}\n            checked={is_filtered}\n          />\n        </div>\n        <div className={styles.projectBody}>\n          <ResponsiveList style={{ minWidth: \"100%\" }}>{items}</ResponsiveList>\n        </div>\n      </div>\n    );\n  });\n\n  if (title) {\n    return (\n      <div>\n        <div className={styles.title}>{title}</div>\n        {projects}\n      </div>\n    );\n  } else {\n    return projects;\n  }\n}\n\nexport default GroupsList;\n","import React from \"react\";\n\nimport DefaultButton from \"./DefaultButton\";\nimport CheckBox from \"./CheckBox\";\n\nimport { ResponsiveList, ResponsiveListItem } from \"./ResponsiveList\";\n\nimport styles from \"./ConnectionList.module.css\";\n\nfunction null_function() {}\n\nfunction ConnectionList({\n  connections,\n  title,\n  emitSelected = null_function,\n  emitToggleFilter = null_function,\n  social = null,\n}) {\n  if (!connections || connections.length === 0) {\n    return null;\n  }\n\n  const listitems = connections.map((item) => {\n    let i = item;\n    let name = item.getName();\n\n    let is_filtered = false;\n\n    if (social) {\n      is_filtered = social.isFiltered(item);\n    }\n\n    return (\n      <ResponsiveListItem key={name}>\n        <DefaultButton\n          onClick={() => {\n            emitSelected(i);\n          }}\n          style={{ width: \"70%\" }}\n        >\n          {name}\n        </DefaultButton>\n        <CheckBox\n          onChange={() => {\n            emitToggleFilter(i);\n          }}\n          checked={is_filtered}\n          style={{ width: \"20%\" }}\n        />\n      </ResponsiveListItem>\n    );\n  });\n\n  if (title) {\n    return (\n      <div className={styles.connections}>\n        <div className={styles.title}>{title}</div>\n        <ResponsiveList>{listitems}</ResponsiveList>\n      </div>\n    );\n  } else {\n    return (\n      <div className={styles.connections}>\n        <ResponsiveList>{listitems}</ResponsiveList>\n      </div>\n    );\n  }\n}\n\nexport default ConnectionList;\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\n\nimport DefaultButton from \"./DefaultButton\";\n\nfunction _null_function() {}\n\nfunction DateRangeButton(props) {\n  let d = props.value;\n\n  if (!d) {\n    return null;\n  }\n\n  if (!(d._isARoughDateObject || d._isADateRangeObject)) {\n    return null;\n  }\n\n  if (d.isNull()) {\n    return null;\n  }\n\n  let emitSelected = props.emitSelected;\n\n  if (!emitSelected) {\n    emitSelected = _null_function;\n  }\n\n  let s = d.toSimpleString();\n\n  if (d._isARoughDateObject) {\n    d = d.toDateRange();\n  }\n\n  return (\n    <DefaultButton\n      onClick={() => {\n        emitSelected(d);\n      }}\n      style={props.style}\n    >\n      {s}\n    </DefaultButton>\n  );\n}\n\nDateRangeButton.propTypes = {\n  value: PropTypes.func,\n  emitSelected: PropTypes.func,\n  style: PropTypes.string,\n};\n\nexport default DateRangeButton;\n","class KeyError extends Error {\n  constructor(...args) {\n    super(...args);\n    Error.captureStackTrace(this, KeyError);\n  }\n}\n\nclass ValueError extends Error {\n  constructor(...args) {\n    super(...args);\n    Error.captureStackTrace(this, ValueError);\n  }\n}\n\nclass DuplicateError extends Error {\n  constructor(...args) {\n    super(...args);\n    Error.captureStackTrace(this, DuplicateError);\n  }\n}\n\nclass MissingError extends Error {\n  constructor(...args) {\n    super(...args);\n    Error.captureStackTrace(this, MissingError);\n  }\n}\n\nexport { KeyError, ValueError, DuplicateError, MissingError };\n","import Dry from \"json-dry\";\nimport moment from \"moment\";\nimport lodash from \"lodash\";\n\nimport DateRange from \"./DateRange\";\n\nimport { ValueError } from \"./Errors\";\n\nfunction _toDate(val, def = null) {\n  if (val) {\n    if (val._isAMomentObject) {\n      return val;\n    }\n\n    /*if (val.toISOString){\n      val = val.toISOString();\n    }*/\n\n    let date = moment(val);\n\n    if (!date.isValid()) {\n      console.log(`Invalid Date ${val}`);\n      throw new ValueError(`Invalid Date ${val}`);\n    }\n\n    return date;\n  } else {\n    if (!def) {\n      return null;\n    } else {\n      return _toDate(def);\n    }\n  }\n}\n\n// NOTE FOR FUTURE - moment(x) < moment(y) === true\n//            even though moment(x).toDate() < moment(y).toDate() === false\n//   MOMENT COMPARISONS ARE BROKEN!\n\nfunction _get_min(d1, d2) {\n  if (d1) {\n    if (d2) {\n      if (d1.toDate() < d2.toDate()) {\n        return d1;\n      } else {\n        return d2;\n      }\n    } else {\n      return d1;\n    }\n  } else {\n    return d2;\n  }\n}\n\nfunction _get_max(d1, d2) {\n  if (d1) {\n    if (d2) {\n      if (d1.toDate() > d2.toDate()) {\n        return d1;\n      } else {\n        return d2;\n      }\n    } else {\n      return d1;\n    }\n  } else {\n    return d2;\n  }\n}\n\nfunction _merge_raw(s1, s2) {\n  if (!s1) {\n    return s2;\n  } else if (!s2) {\n    return s1;\n  }\n\n  return `${s1} + ${s2}`;\n}\n\nclass RoughDate {\n  constructor(state) {\n    this.state = {\n      start: null,\n      end: null,\n      raw: null,\n    };\n\n    this.setState(state);\n\n    this._isARoughDateObject = true;\n  }\n\n  setState(state) {\n    if (!state || state === \"null\" || state === null) {\n      this.state = { start: null };\n      return;\n    } else if (state._isARoughDateObject) {\n      this.state = { ...state.state };\n      return;\n    } else if (state._isADateRangeObject) {\n      this.state = state.toDate();\n      return;\n    } else if (state._isAMomentObject) {\n      this.state = { start: _toDate(state) };\n      return;\n    } else if (state.toISOString) {\n      this.state = { start: _toDate(state) };\n      return;\n    } else if (Object.prototype.hasOwnProperty.call(state, \"value\")) {\n      this.state = { start: state.value };\n      return;\n    } else if (typeof state === \"string\") {\n      this.state = { start: _toDate(state), raw: state };\n      return;\n    }\n\n    let start = _toDate(state.start);\n    let end = _toDate(state.end);\n\n    if (!start) {\n      this.state = { start: null };\n      return;\n    }\n\n    this.state.start = start;\n    this.state.end = end;\n    this.state.raw = state.raw;\n\n    if (this.isNull()) {\n      console.log(\"NULL RoughDate?\");\n      console.log(state);\n    }\n  }\n\n  static clone(item) {\n    let d = new RoughDate();\n    d.state = lodash.cloneDeep(item.state);\n    return d;\n  }\n\n  static max(d1, d2) {\n    return new RoughDate(_get_max(d1.getLatest(), d2.getLatest()));\n  }\n\n  static min(d1, d2) {\n    return new RoughDate(_get_min(d1.getEarliest(), d2.getEarliest()));\n  }\n\n  static delta(d1, d2) {\n    return d1.getLatestDate() - d2.getEarliestDate();\n  }\n\n  static getDelta(d1, d2) {\n    return RoughDate.delta(d1, d2);\n  }\n\n  static eq(item, other) {\n    if (item._isARoughDateObject && other._isARoughDateObject) {\n      return (\n        item.getEarliestString() === other.getEarliestString() && item.getLatestString() === other.getLatestString()\n      );\n    } else {\n      return false;\n    }\n  }\n\n  static lt(d1, d2) {\n    if (d1.isNull() || d2.isNull()) {\n      return false;\n    } else {\n      return d1.getEarliestDate() < d2.getEarliestDate();\n    }\n  }\n\n  static gt(d1, d2) {\n    if (d1.isNull() || d2.isNull()) {\n      return false;\n    } else {\n      return d1.getEarliestDate() > d2.getEarliestDate();\n    }\n  }\n\n  static le(d1, d2) {\n    return RoughDate.eq(d1, d2) || RoughDate.lt(d1, d2);\n  }\n\n  static ge(d1, d2) {\n    return RoughDate.eq(d1, d2) || RoughDate.gt(d1, d2);\n  }\n\n  static ne(d1, d2) {\n    return !RoughDate.eq(d1, d2);\n  }\n\n  add(delta) {\n    if (this.state.start) {\n      this.state.start.add(delta);\n    }\n\n    if (this.state.end) {\n      this.state.end.add(delta);\n    }\n\n    this.state.raw = null;\n  }\n\n  sub(delta) {\n    this.add(-delta);\n  }\n\n  isNull() {\n    if (this.state.start) {\n      return false;\n    } else {\n      return true;\n    }\n  }\n\n  isFuzzy() {\n    if (this.state.end) {\n      return true;\n    } else {\n      return false;\n    }\n  }\n\n  isExact() {\n    return !(this.isNull() || this.isFuzzy());\n  }\n\n  toString() {\n    if (this.isNull()) {\n      return \"Date:unknown\";\n    } else if (this.isFuzzy()) {\n      return `~${this.state.start.format(\"LL\")}-${this.state.end.format(\"LL\")}`;\n    } else {\n      return this.state.start.format(\"LL\");\n    }\n  }\n\n  toSimpleString() {\n    if (this.isNull()) {\n      return \"unknown\";\n    } else if (this.isFuzzy()) {\n      let s = this.state.start.toDate();\n      let e = this.state.end.toDate();\n\n      if (s.getMonth() === 0 && e.getMonth() === 11 && s.getDate() === 1 && e.getDate() === 31) {\n        //the dates span full years\n        if (s.getFullYear() === e.getFullYear()) {\n          return s.getFullYear();\n        } else {\n          return `${s.getFullYear()}-${e.getFullYear()}`;\n        }\n      } else {\n        return `${s.getDate()}/${s.getMonth() + 1}/${s.getFullYear()}-${e.getDate()}/${\n          e.getMonth() + 1\n        }/${e.getFullYear()}`;\n      }\n    } else {\n      return this.state.start.format(\"LL\");\n    }\n  }\n\n  getEarliest() {\n    let state = { start: this.state.start };\n    let r = new RoughDate();\n    r.state = state;\n    return r;\n  }\n\n  getLatest() {\n    if (this.state.end) {\n      let state = { start: this.state.end };\n      let r = new RoughDate();\n      r.state = state;\n      return r;\n    } else {\n      return this.getEarliest();\n    }\n  }\n\n  getEarliestDate() {\n    let d = this.getEarliest();\n\n    if (d) {\n      return d.toDate();\n    } else {\n      return null;\n    }\n  }\n\n  getLatestDate() {\n    let d = this.getLatest();\n\n    if (d) {\n      return d.toDate();\n    } else {\n      return null;\n    }\n  }\n\n  getEarliestString() {\n    let d = this.getEarliest();\n\n    if (d) {\n      return d.toDate().toISOString();\n    } else {\n      return null;\n    }\n  }\n\n  getLatestString() {\n    let d = this.getLatest();\n\n    if (d) {\n      return d.toDate().toISOString();\n    } else {\n      return null;\n    }\n  }\n\n  toRange() {\n    if (this.isNull()) {\n      return new DateRange();\n    } else if (this.isExact()) {\n      return new DateRange({ both: this.state.start });\n    } else {\n      return new DateRange({ start: this.state.start, end: this.state.end });\n    }\n  }\n\n  toDateRange() {\n    if (this.isNull()) {\n      return new DateRange();\n    } else if (this.isFuzzy()) {\n      return new DateRange({ start: this.getEarliest(), end: this.getLatest() });\n    } else {\n      return new DateRange({ both: this.getEarliest() });\n    }\n  }\n\n  toDate() {\n    let m = this.toMoment();\n\n    if (m) {\n      try {\n        return m.toDate();\n      } catch (error) {\n        console.log(`STRANGE ERROR ${error}`);\n        console.log(`m = ${m}`);\n        console.log(m);\n        return null;\n      }\n    } else {\n      return null;\n    }\n  }\n\n//   toUnixTimestamp() {\n//     return parseInt((this.toDate().getTime() / 1000).toFixed(0));\n//   }\n\n  toMoment() {\n    if (this.isNull()) {\n      return null;\n    } else if (this.isExact()) {\n      return this.state.start;\n    } else {\n      throw new ValueError(`Cannot extract a single date from an inexact date ${this}`);\n    }\n  }\n\n  getRaw() {\n    return this.state.raw;\n  }\n\n  getStart() {\n    return this.state.start;\n  }\n\n  getEnd() {\n    if (this.state.end) {\n      return this.state.end;\n    } else {\n      return this.state.start;\n    }\n  }\n\n  merge(other) {\n    let state = {\n      start: _get_min(this.getStart(), other.getStart()),\n      end: _get_max(this.getEnd(), other.getEnd()),\n      raw: _merge_raw(this.getRaw(), other.getRaw()),\n    };\n\n    let date = new RoughDate();\n    date.state = state;\n\n    return date;\n  }\n}\n\nRoughDate.unDry = function (value) {\n  return new RoughDate(value);\n};\n\nDry.registerClass(\"Date\", RoughDate);\n\nexport default RoughDate;\n","import Dry from \"json-dry\";\nimport lodash from \"lodash\";\n\nimport RoughDate from \"./RoughDate\";\nimport { ValueError } from \"./Errors\";\n\nfunction _clean(val) {\n  if (!val || val._isADateRangeObject) {\n    return val;\n  } else if (val._isARoughDateObject) {\n    return val.toDateRange();\n  } else if (\n    Object.prototype.hasOwnProperty.call(val, \"start\") ||\n    Object.prototype.hasOwnProperty.call(val, \"end\") ||\n    Object.prototype.hasOwnProperty.call(val, \"both\") ||\n    Object.prototype.hasOwnProperty.call(val, \"value\")\n  ) {\n    return new DateRange(val);\n  } else {\n    return new DateRange({ both: new RoughDate(val) });\n  }\n}\n\nclass DateRange {\n  constructor(state) {\n    this.state = {\n      start: null,\n      end: null,\n    };\n\n    this.setState(state);\n    this._isADateRangeObject = true;\n  }\n\n  toString() {\n    if (this.hasBounds()) {\n      if (this.isInstant()) {\n        return `DateRange(${this.getStartString()})`;\n      } else {\n        return `DateRange(${this.getStartString()} to ${this.getEndString()})`;\n      }\n    } else {\n      return \"DateRange::unbounded\";\n    }\n  }\n\n  toSimpleString() {\n    if (this.hasBounds()) {\n      if (this.isInstant()) {\n        return this.getStart().toSimpleString();\n      } else {\n        return this.getEarliestStart().merge(this.getLatestEnd()).toSimpleString();\n      }\n    } else if (this.hasStart()) {\n      return `${this.getStart().toSimpleString()}<=>future`;\n    } else if (this.hasEnd()) {\n      return `past<=>${this.getEnd().toSimpleString()}`;\n    } else {\n      return \"past<=>future\";\n    }\n  }\n\n  static clone(item) {\n    let d = new DateRange();\n    d.state = lodash.cloneDeep(item.state);\n    return d;\n  }\n\n  static eq(item, other) {\n    if (item === other) {\n      return true;\n    }\n\n    if (item.hasStart() && other.hasStart()) {\n      if (!RoughDate.eq(item.getStart(), other.getStart())) {\n        return false;\n      }\n    } else if (item.hasStart() || other.hasStart()) {\n      return false;\n    }\n\n    if (item.hasEnd() && other.hasEnd()) {\n      if (!RoughDate.eq(item.getEnd(), other.getEnd())) {\n        return false;\n      }\n    } else if (item.hasEnd() || other.hasEnd()) {\n      return false;\n    }\n\n    return true;\n  }\n\n  static mergeAll(dates) {\n    if (!dates) {\n      return null;\n    } else if (dates._isARoughDateObject || dates._isARoughDateObject) {\n      return dates;\n    }\n\n    if (!dates.length || dates.length === 0) {\n      return null;\n    }\n\n    let date = dates[0];\n\n    if (dates.length > 1) {\n      for (let i = 1; i < dates.length; ++i) {\n        if (!dates[i].isNull()) {\n          if (date.isNull()) {\n            date = dates[i];\n          } else {\n            date = date.merge(dates[i]);\n          }\n        }\n      }\n    }\n\n    if (date.isNull()) {\n      return null;\n    } else {\n      return date;\n    }\n  }\n\n  merge(other) {\n    if (!other) {\n      return this;\n    } else if (other._isARoughDateObject) {\n      other = other.toDateRange();\n    }\n\n    return new DateRange({\n      start: RoughDate.min(this.getEarliestStart(), other.getEarliestStart()),\n      end: RoughDate.max(this.getLatestEnd(), other.getLatestEnd()),\n    });\n  }\n\n  hasBounds() {\n    return this.hasStart() && this.hasEnd();\n  }\n\n  hasEnd() {\n    if (this.state.end) {\n      return !this.state.end.isNull();\n    } else {\n      return false;\n    }\n  }\n\n  hasStart() {\n    if (this.state.start) {\n      return !this.state.start.isNull();\n    } else {\n      return false;\n    }\n  }\n\n  isInstant() {\n    return this.hasStart() && this.state.start === this.state.end;\n  }\n\n  // Returns a DateRange object\n  toDate() {\n    if (this.hasStart()) {\n      if (this.hasEnd()) {\n        return this.getStart().merge(this.getEnd());\n      } else {\n        return this.getStart();\n      }\n    } else {\n      return this.getEnd();\n    }\n  }\n\n  contains(date) {\n    date = _clean(date);\n\n    if (!date) {\n      return true;\n    } else if (date._isADateRangeObject) {\n      const my_start = this.getEarliestStart();\n      const other_start = date.getEarliestStart();\n\n      if (my_start && other_start) {\n        if (RoughDate.gt(my_start, other_start)) {\n          return false;\n        }\n      } else if (other_start) {\n        return false;\n      }\n\n      const my_end = this.getLatestEnd();\n      const other_end = date.getLatestEnd();\n\n      if (my_end && other_end) {\n        if (RoughDate.lt(my_end, other_end)) {\n          return false;\n        }\n      } else if (my_end) {\n        return false;\n      }\n\n      return true;\n    } else {\n      throw new ValueError(`Invalid Date ${date}`);\n    }\n  }\n\n  intersect(other) {\n    other = _clean(other);\n\n    if (!other) {\n      return this;\n    }\n\n    if (!other.hasBounds()) {\n      return this;\n    } else if (!this.hasBounds()) {\n      return other;\n    }\n\n    const start = RoughDate.max(this.getStart(), other.getStart());\n\n    if (!this.contains(start)) {\n      return null;\n    }\n\n    const end = RoughDate.min(this.getEnd(), other.getEnd());\n\n    if (!this.contains(end)) {\n      return null;\n    }\n\n    if (RoughDate.eq(start, end)) {\n      return new DateRange({ both: start });\n    } else {\n      return new DateRange({ start: start, end: end });\n    }\n  }\n\n  union(other) {\n    other = _clean(other);\n    if (!other) {\n      return this;\n    } else if (!other._isADateRangeObject) {\n      other = new DateRange({ value: other });\n    }\n\n    const start = RoughDate.min(this.getStart(), other.getStart());\n    const end = RoughDate.max(this.getEnd(), other.getEnd());\n\n    if (RoughDate.eq(start, end)) {\n      return new DateRange({ both: start });\n    } else {\n      return new DateRange({ start: start, end: end });\n    }\n  }\n\n  getDelta() {\n    if (this.hasStart() && this.hasEnd()) {\n      try {\n        return this.getLatestEnd().toDate() - this.getEarliestStart().toDate();\n      } catch (error) {\n        console.log(error);\n        console.log(this.hasStart(), this.hasEnd());\n        console.log(this.getStart(), this.getEnd());\n        console.log(this.getLatestEnd(), this.getEarliestStart());\n        throw error;\n      }\n    } else {\n      return null;\n    }\n  }\n\n  zoomIn(scale = 1) {\n    let state = lodash.cloneDeep(this.state);\n\n    let delta = null;\n\n    if (state.start !== null && state.end !== null) {\n      delta = this.getDelta() / (2.0 + scale);\n    } else {\n      delta = 3600000;\n    }\n\n    if (state.start) {\n      state.start.add(delta, \"ms\");\n    }\n\n    if (state.end) {\n      state.end.add(-delta, \"ms\");\n    }\n\n    return new DateRange(state);\n  }\n\n  zoomOut(scale = 1) {\n    let state = lodash.cloneDeep(this.state);\n\n    let delta = null;\n\n    if (state.start !== null && state.end !== null) {\n      delta = this.getDelta() * scale;\n    } else {\n      delta = 3600000;\n    }\n\n    if (state.start) {\n      state.start.add(-delta, \"ms\");\n    }\n\n    if (state.end) {\n      state.end.add(delta, \"ms\");\n    }\n\n    return new DateRange(state);\n  }\n\n  shiftEarlier(delta = null) {\n    let state = lodash.cloneDeep(this.state);\n\n    if (delta === null) {\n      if (state.start !== null && state.end !== null) {\n        delta = -this.getDelta(); //milliseconds\n      } else {\n        delta = -3600000; //milliseconds\n      }\n    }\n\n    if (state.start) {\n      state.start.add(delta, \"ms\");\n    }\n\n    if (state.end) {\n      state.end.add(delta, \"ms\");\n    }\n\n    return new DateRange(state);\n  }\n\n  shiftLater(delta = null) {\n    let state = lodash.cloneDeep(this.state);\n\n    if (delta === null) {\n      if (state.start !== null && state.end !== null) {\n        delta = this.getDelta(); //milliseconds\n      } else {\n        delta = 3600000; //milliseconds\n      }\n    }\n\n    if (state.start) {\n      state.start.add(delta, \"ms\");\n    }\n\n    if (state.end) {\n      state.end.add(delta, \"ms\");\n    }\n\n    return new DateRange(state);\n  }\n\n  getStart() {\n    return this.state.start;\n  }\n\n  getEnd() {\n    return this.state.end;\n  }\n\n  getEarliestStart() {\n    if (this.hasStart()) {\n      return this.getStart().getEarliest();\n    } else {\n      return null;\n    }\n  }\n\n  getLatestEnd() {\n    if (this.hasEnd()) {\n      return this.getEnd().getLatest();\n    } else {\n      return null;\n    }\n  }\n\n  getStartDate() {\n    let e = this.getEarliestStart();\n    if (e) {\n      return e.toDate();\n    } else {\n      return null;\n    }\n  }\n\n  getEndDate() {\n    let e = this.getLatestEnd();\n    if (e) {\n      return e.toDate();\n    } else {\n      return null;\n    }\n  }\n\n  getStartString() {\n    if (this.state.start) {\n      return this.state.start.toString();\n    } else {\n      return \"unbounded\";\n    }\n  }\n\n  getEndString() {\n    if (this.state.end) {\n      return this.state.end.toString();\n    } else {\n      return \"unbounded\";\n    }\n  }\n\n  setState(state) {\n    if (state) {\n      if (state === \"null\" || state === null) {\n        this.state = { start: null, end: null };\n        return;\n      } else if (state._isADateRangeObject) {\n        this.state = { ...state.state };\n      } else if (state._isARoughDateObject) {\n        this.state = { start: state, end: state };\n      } else if (Object.prototype.hasOwnProperty.call(state, \"value\")) {\n        this.setState(state.value);\n        return;\n      } else if (Object.prototype.hasOwnProperty.call(state, \"both\")) {\n        this.state.start = new RoughDate(state.both);\n        this.state.end = this.state.start;\n      } else if (typeof state === \"string\") {\n        this.state.start = new RoughDate(state);\n        this.state.end = this.state.start;\n      } else {\n        let start = null;\n\n        if (state.start) {\n          start = new RoughDate(state.start);\n\n          if (start.isNull()) {\n            start = null;\n          }\n        }\n\n        let end = null;\n\n        if (state.end) {\n          end = new RoughDate(state.end);\n\n          if (end.isNull()) {\n            end = null;\n          }\n        }\n\n        if (start && end) {\n          if (RoughDate.gt(start, end)) {\n            let tmp = start;\n            start = end;\n            end = tmp;\n          }\n\n          if (RoughDate.gt(start, end)) {\n            let tmp = RoughDate.min(start, end);\n            end = RoughDate.max(start, end);\n            start = tmp;\n          }\n        }\n\n        this.state.start = start;\n        this.state.end = end;\n      }\n    } else {\n      this.state.start = null;\n      this.state.end = null;\n    }\n  }\n\n  toDry() {\n    return this.state;\n  }\n}\n\nDateRange.unDry = function (value) {\n  return new DateRange(value);\n};\n\nDry.registerClass(\"DateRange\", DateRange);\n\nexport default DateRange;\n","import PropTypes from \"prop-types\";\nimport React from \"react\";\n\nimport DateRangeButton from \"./DateRangeButton\";\nimport DateRange from \"../model/DateRange\";\nimport DefaultButton from \"./DefaultButton\";\n\nimport { ResponsiveList, ResponsiveListItem } from \"./ResponsiveList\";\n\nimport styles from \"./SourceList.module.css\";\n\nfunction _null_function() {}\n\nfunction SourceList(props) {\n  let social = props.social;\n  let sources = props.sources;\n  let emitSelected = props.emitSelected;\n  let title = props.title;\n\n  if (!social || !sources) {\n    return null;\n  }\n\n  if (!emitSelected) {\n    emitSelected = _null_function;\n  }\n\n  let output = Object.keys(sources).map((key) => {\n    let source = social.get(key);\n    let daterange = DateRange.mergeAll(sources[key]);\n\n    if (daterange) {\n      return (\n        <ResponsiveListItem key={source.getName()}>\n          <DefaultButton\n            onClick={() => {\n              emitSelected(source);\n            }}\n            style={{ width: \"50%\" }}\n          >\n            {source.getName()}\n          </DefaultButton>\n          <DateRangeButton style={{ width: \"40%\" }} value={daterange} emitSelected={emitSelected} />\n        </ResponsiveListItem>\n      );\n    } else {\n      return (\n        <ResponsiveListItem key={source.getName()}>\n          <DefaultButton\n            onClick={() => {\n              emitSelected(source);\n            }}\n          >\n            {source.getName()}\n          </DefaultButton>\n        </ResponsiveListItem>\n      );\n    }\n  });\n\n  if (!output || output.length === 0) {\n    return null;\n  }\n\n  if (title) {\n    return (\n      <div className={styles.container}>\n        <div className={styles.title}>{title}</div>\n        <div className={styles.body}>\n          <ResponsiveList>{output}</ResponsiveList>\n        </div>\n      </div>\n    );\n  } else {\n    return <ResponsiveList>{output}</ResponsiveList>;\n  }\n}\n\nSourceList.propTypes = {\n  emitSelected: PropTypes.func.isRequired,\n  social: PropTypes.func.isRequired,\n  sources: PropTypes.object.isRequired,\n  title: PropTypes.string,\n};\n\nexport default SourceList;\n","import React from \"react\";\n\nimport DefaultButton from \"./DefaultButton\";\nimport CheckBox from \"./CheckBox\";\n\nimport styles from \"./WeightsList.module.css\";\n\nfunction null_function() {}\n\nfunction WeightsList({\n  weights,\n  title = null,\n  emitSelected = null_function,\n  emitToggleFilter = null_function,\n  social = null,\n  type = null,\n}) {\n  if (!weights) {\n    return null;\n  }\n\n  let projects = [];\n\n  Object.keys(weights).forEach((key) => {\n    let project = social.get(key);\n    let is_filtered = social.isFiltered(project);\n\n    let weight = weights[key];\n\n    projects.push(\n      <div className={styles.project} key={project.getName()}>\n        <div className={styles.projectHeader}>\n          <DefaultButton\n            style={{ width: \"75%\" }}\n            onClick={() => {\n              emitSelected(project);\n            }}\n          >\n            {project.getName()}\n          </DefaultButton>\n          <CheckBox\n            onChange={() => {\n              emitToggleFilter(project);\n            }}\n            style={{ width: \"20%\" }}\n            checked={is_filtered}\n          />\n        </div>\n        <div className={styles.projectBody}>\n          Weight = {weight}, Type = {type}\n        </div>\n      </div>\n    );\n  });\n\n  if (title) {\n    return (\n      <div>\n        <div className={styles.title}>{title}</div>\n        {projects}\n      </div>\n    );\n  } else {\n    return projects;\n  }\n}\n\nexport default WeightsList;\n","import Dry from \"json-dry\";\nimport lodash from \"lodash\";\n\nimport DateRange from \"./DateRange\";\n\nimport { ValueError } from \"./Errors\";\n\nfunction setState(val, def = null) {\n  if (val) {\n    return val;\n  } else {\n    return def;\n  }\n}\n\nfunction _filterWindow(values, window) {\n  if (!values) {\n    return values;\n  }\n\n  let ret = null;\n\n  Object.keys(values).forEach((key) => {\n    let dates = values[key];\n\n    let intersect = window.intersect(dates);\n\n    if (!intersect) {\n      if (!ret) {\n        ret = { ...values };\n      }\n      delete ret[key];\n    }\n  });\n\n  if (ret) {\n    return ret;\n  } else {\n    return values;\n  }\n}\n\nfunction _filterProject(values, project) {\n  if (!values) {\n    return values;\n  }\n\n  let ret = null;\n\n  Object.keys(values).forEach((key) => {\n    if (!(key in project)) {\n      if (!ret) {\n        ret = { ...values };\n      }\n      delete ret[key];\n    }\n  });\n\n  if (ret) {\n    return ret;\n  } else {\n    return values;\n  }\n}\n\nclass Person {\n  constructor(props) {\n    this.state = {\n      name: null,\n      titles: [],\n      firstnames: [],\n      surnames: [],\n      suffixes: [],\n      id: null,\n      positions: {},\n      affiliations: {},\n      projects: {},\n      sources: {},\n      alive: null,\n      gender: null,\n      notes: [],\n      orig_name: null,\n      weight: 1,\n    };\n\n    this.setState(props);\n\n    this._getHook = null;\n    this._isAPersonObject = true;\n  }\n\n  static clone(item) {\n    let c = new Person();\n    c._getHook = item._getHook;\n    c.state = lodash.cloneDeep(item.state);\n    return c;\n  }\n\n  isNode() {\n    return true;\n  }\n\n  inGroup(group) {\n    if (group.getID) {\n      let ids = {};\n      ids[group.getID()] = 1;\n      group = ids;\n    }\n\n    let seen = {};\n\n    Object.keys(this.state.affiliations).forEach((key) => {\n      for (let index in this.state.affiliations[key]) {\n        if (this.state.affiliations[key][index] in group) {\n          seen[this.state.affiliations[key][index]] = 1;\n        }\n      }\n    });\n\n    Object.keys(this.state.positions).forEach((key) => {\n      for (let index in this.state.positions[key]) {\n        if (this.state.positions[key][index] in group) {\n          seen[this.state.positions[key][index]] = 1;\n        }\n      }\n    });\n\n    return Object.keys(seen).length === Object.keys(group).length;\n  }\n\n  getID() {\n    return this.state.id;\n  }\n\n  filterSource(source) {\n    if (source.getID) {\n      let id = source.getID();\n      source = {};\n      source[id] = 1;\n    }\n\n    let nsources = Object.keys(source).length;\n\n    let seen = {};\n\n    Object.keys(this.state.sources).forEach((key) => {\n      let s = this.state.sources[key];\n\n      Object.keys(source).forEach((source_id) => {\n        if (s.includes(source_id)) {\n          seen[source_id] = 1;\n        }\n      });\n    });\n\n    if (Object.keys(seen).length !== nsources) {\n      return null;\n    } else {\n      return this;\n    }\n  }\n\n  filterProject(project) {\n    if (project.getID) {\n      let id = project.getID();\n      project = {};\n      project[id] = 1;\n    }\n\n    let nprojects = Object.keys(project).length;\n\n    let seen = {};\n\n    Object.keys(this.state.projects).forEach((key) => {\n      if (key in project) {\n        seen[key] = 1;\n      }\n    });\n\n    if (Object.keys(seen).length !== nprojects) {\n      return null;\n    }\n\n    let affiliations = _filterProject(this.state.affiliations, project);\n    let positions = _filterProject(this.state.positions, project);\n\n    if (affiliations !== this.state.affiliations || positions !== this.state.positions) {\n      let person = new Person();\n      person.state = { ...this.state };\n      person.state.affiliations = affiliations;\n      person.state.positions = positions;\n      person._getHook = this._getHook;\n      return person;\n    } else {\n      return this;\n    }\n  }\n\n  filterWindow(window) {\n    if (!window) {\n      return this;\n    } else if (!window._isADateRangeObject) {\n      window = new DateRange(window);\n    }\n\n    window = window.intersect(this.getAlive());\n\n    if (!window) {\n      return null;\n    }\n\n    let affiliations = _filterWindow(this.state.affiliations, window);\n    let positions = _filterWindow(this.state.positions, window);\n\n    if (affiliations !== this.state.affiliations || positions !== this.state.positions) {\n      let person = new Person();\n      person.state = { ...this.state };\n      person.state.affiliations = affiliations;\n      person.state.positions = positions;\n      person._getHook = this._getHook;\n      return person;\n    } else {\n      return this;\n    }\n  }\n\n  setState(state) {\n    if (state) {\n      this.state.titles = setState(state.titles, []);\n      this.state.firstnames = setState(state.firstnames, []);\n      this.state.surnames = setState(state.surnames, []);\n      this.state.suffixes = setState(state.suffixes, []);\n      this.state.id = setState(state.id);\n      this.state.positions = setState(state.positions, {});\n      this.state.affiliations = setState(state.affiliations, {});\n      this.state.projects = setState(state.projects, {});\n      this.state.sources = setState(state.sources, {});\n      this.state.alive = setState(state.alive);\n      this.state.gender = setState(state.gender);\n      this.state.orig_name = setState(state.orig_name);\n      this.state.notes = setState(state.notes, []);\n      this.state.weight = setState(state.weight);\n\n      if (!this.state.orig_name || this.state.orig_name === \"None\") {\n        throw new ValueError(`No name for ${this}`);\n      }\n    }\n  }\n\n  _updateHooks(hook) {\n    this._getHook = hook;\n  }\n\n  merge() {\n    return this;\n  }\n\n  toString() {\n    return `Person(${this.getName()})`;\n  }\n\n  getAlive() {\n    return this.state.alive;\n  }\n\n  getFirstName() {\n    if (this.state.firstnames) {\n      return this.state.firstnames.join(\" \");\n    } else {\n      return null;\n    }\n  }\n\n  getTitle() {\n    if (this.state.titles) {\n      return this.state.titles.join(\" \");\n    } else {\n      return null;\n    }\n  }\n\n  getSurname() {\n    if (this.state.surnames) {\n      return this.state.surnames.join(\" \");\n    } else {\n      return null;\n    }\n  }\n\n  getSuffix() {\n    if (this.state.suffixes) {\n      return this.state.suffixes.join(\" \");\n    } else {\n      return null;\n    }\n  }\n\n  getName() {\n    var parts = [];\n\n    let part = this.getTitle();\n    if (part) {\n      parts.push(part);\n    }\n\n    part = this.getFirstName();\n    if (part) {\n      parts.push(part);\n    }\n\n    part = this.getSurname();\n    if (part) {\n      parts.push(part);\n    }\n\n    part = this.getSuffix();\n    if (part) {\n      parts.push(part);\n    }\n\n    if (parts.length > 0) {\n      return parts.join(\" \");\n    } else {\n      return \"null\";\n    }\n  }\n\n  getAffiliations() {\n    return this.state.affiliations;\n  }\n\n  getSources() {\n    return this.state.sources;\n  }\n\n  getPositions() {\n    if (!this.state.positions) {\n      console.error(\"No positions for \", this.getName());\n    }\n    return this.state.positions;\n  }\n\n  getScores() {\n    return this.state.scores;\n  }\n\n  getBorn() {\n    if (this.state.alive) {\n      return this.state.alive.getStart();\n    } else {\n      return null;\n    }\n  }\n\n  getDied() {\n    if (this.state.alive) {\n      return this.state.alive.getEnd();\n    } else {\n      return null;\n    }\n  }\n\n  getTimeLine() {\n    const alive = this.getAlive();\n\n    if (!alive) {\n      return null;\n    } else {\n      return {\n        start: alive.getStart(),\n        end: alive.getEnd(),\n        id: this.getID(),\n        content: this.getName(),\n      };\n    }\n  }\n\n  getWeight() {\n    return this.state.weight;\n\n    // if (this.state.weight) {\n    //   const key = Object.keys(this.state.weight);\n    //   return this.state.weight[key];\n    // } else {\n    //   console.error(\"No weight for \", this.getName(), this.getID());\n    //   return 1;\n    // }\n  }\n\n  getProjectWeight(projectKey) {\n    try {\n      return this.state.weight[projectKey];\n    } catch (error) {\n      console.error(\"No weight for \" + this.getName() + this.getID() + \" for project with key \" + projectKey, error);\n      return 0;\n    }\n  }\n\n  getNode(isAnchor = false) {\n    let node = {\n      id: this.getID(),\n      label: this.getName(),\n      title: this.getName(),\n      fixed: false,\n      shape: \"circle\",\n    };\n\n    const weight = this.getWeight();\n\n    node[\"weight\"] = weight;\n\n    // Position will be used to set the colour used\n    // for the node representing this person\n    node[\"positions\"] = this.getPositions();\n\n    let keys = Object.keys(this.state.projects);\n\n    if (keys.length > 0) {\n      node[\"group\"] = keys.sort().join(\":\");\n    } else {\n      node[\"group\"] = \"unknown\";\n    }\n\n    if (isAnchor) {\n      node[\"shape\"] = \"rect\";\n      node[\"fixed\"] = true;\n      node[\"group\"] = \"anchor\";\n      node[\"size\"] = 20.0;\n    }\n\n    return node;\n  }\n\n  toDry() {\n    return { value: this.state };\n  }\n}\n\nPerson.unDry = function (value) {\n  return new Person(value);\n};\n\nDry.registerClass(\"Person\", Person);\n\nexport default Person;\n","import Dry from \"json-dry\";\nimport { v4 as uuidv4 } from \"uuid\";\nimport lodash from \"lodash\";\n\nimport Person from \"./Person\";\nimport { KeyError, MissingError } from \"./Errors\";\n\nfunction _generate_person_uid() {\n  let uid = uuidv4();\n  return \"P\" + uid.substring(uid.length - 7);\n}\n\nclass People {\n  constructor(props) {\n    this.state = {\n      registry: {},\n    };\n\n    this._names = {};\n    this._isAPeopleObject = true;\n    this.load(props);\n  }\n\n  _updateHooks(hook) {\n    this._getHook = hook;\n    for (let key in this.state.registry) {\n      this.state.registry[key]._updateHooks(hook);\n    }\n  }\n\n  static clone(item) {\n    let c = new People();\n    c.state = lodash.cloneDeep(item.state);\n    c._names = lodash.cloneDeep(item._names);\n    c._getHook = item._getHook;\n    return c;\n  }\n\n  values() {\n    let names = Object.keys(this._names);\n    names.sort();\n\n    let output = [];\n\n    names.forEach((key) => {\n      output.push(this.get(this._names[key]));\n    });\n\n    return output;\n  }\n\n  canAdd(item) {\n    return item instanceof Person || item._isAPersonObject;\n  }\n\n  add(person) {\n    if (!this.canAdd(person)) {\n      return null;\n    }\n\n    let existing = null;\n\n    try {\n      existing = this.getByName(person.getName());\n    } catch (error) {\n      console.error(error);\n    }\n\n    if (existing) {\n      existing = existing.merge(person);\n      this.state.registry[existing.getID()] = existing;\n      return existing;\n    }\n\n    person = Person.clone(person);\n\n    let id = person.getID();\n\n    if (id) {\n      if (id in this.state.registry) {\n        throw new KeyError(`Duplicate Person ID ${person}`);\n      }\n\n      person._updateHooks(this._getHook);\n      this.state.registry[id] = person;\n    } else {\n      let uid = _generate_person_uid();\n\n      while (uid in this.state.registry) {\n        uid = _generate_person_uid();\n      }\n\n      person.state.id = uid;\n    }\n\n    person._updateHooks(this._getHook);\n    this._names[person.getName()] = person.getID();\n    this.state.registry[person.getID()] = person;\n\n    return person;\n  }\n\n  getByName(name) {\n    let id = this._names[name];\n\n    if (id) {\n      return this.get(id);\n    } else {\n      throw new MissingError(`No Person with name ${name}`);\n    }\n  }\n\n  find(name) {\n    if (name instanceof Person || name._isAPersonObject) {\n      return this.get(name.getID());\n    }\n\n    name = name.trim().toLowerCase();\n\n    let results = [];\n\n    Object.keys(this._names).forEach((key) => {\n      if (key.toLowerCase().indexOf(name) !== -1) {\n        results.push(this.get(this._names[key]));\n      }\n    });\n\n    if (results.length === 1) {\n      return results[0];\n    } else if (results.length > 1) {\n      return results;\n    }\n\n    let keys = Object.keys(this._names).join(\"', '\");\n\n    throw new MissingError(`No Person matches '${name}. Available People are '${keys}'`);\n  }\n\n  filter(funcs = []) {\n    if (funcs.length === 0) {\n      return this;\n    }\n\n    let registry = {};\n    let names = {};\n\n    Object.keys(this.state.registry).forEach((key) => {\n      let person = this.state.registry[key];\n\n      if (person) {\n        for (let i = 0; i < funcs.length; ++i) {\n          person = funcs[i](person);\n          if (!person) {\n            break;\n          }\n        }\n\n        if (person) {\n          registry[key] = person;\n          names[person.getName()] = key;\n        }\n      }\n    });\n\n    let people = new People();\n    people.state.registry = registry;\n    people._names = names;\n    people._updateHooks(this._getHook);\n\n    return people;\n  }\n\n  getTimeLine() {\n    let items = [];\n\n    Object.keys(this.state.registry).forEach((key) => {\n      let person = this.state.registry[key];\n      if (person) {\n        let timeline = person.getTimeLine();\n        if (timeline) {\n          items.push(timeline);\n        }\n      }\n    });\n\n    return items;\n  }\n\n  getNodes({ anchor = null } = {}) {\n    let nodes = [];\n\n    if (anchor.getID) {\n      anchor = anchor.getID();\n    }\n\n    Object.keys(this.state.registry).forEach((key) => {\n      let person = this.state.registry[key];\n\n      if (person) {\n        let node = null;\n        if (key === anchor) {\n          node = person.getNode({ is_anchor: true });\n        } else {\n          node = person.getNode();\n        }\n\n        if (node) {\n          nodes.push(node);\n        }\n      }\n    });\n\n    return nodes;\n  }\n\n  get(id) {\n    let person = this.state.registry[id];\n\n    if (!person) {\n      throw new MissingError(`No Person with ID ${id}`);\n    }\n\n    return person;\n  }\n\n  load(data) {\n    if (data) {\n      if (data.array) {\n        data = data.array;\n      }\n      data.forEach((element) => {\n        let person = Person.load(element);\n        this.add(person);\n      });\n    }\n  }\n\n  toDry() {\n    return { value: this.state };\n  }\n}\n\nPeople.unDry = function (value) {\n  let people = new People();\n  people.state = value;\n  people._names = {};\n\n  Object.keys(value.registry).forEach((key) => {\n    let v = value.registry[key];\n    people._names[v.getName()] = key;\n  });\n\n  return people;\n};\n\nDry.registerClass(\"People\", People);\n\nexport default People;\n","import Dry from \"json-dry\";\nimport lodash from \"lodash\";\n\nimport DateRange from \"./DateRange\";\n\nimport { ValueError } from \"./Errors\";\n\nfunction setState(val, def = null) {\n  if (val) {\n    return val;\n  } else {\n    return def;\n  }\n}\n\nfunction _filterWindow(values, window) {\n  if (!values) {\n    return values;\n  }\n\n  let ret = null;\n\n  Object.keys(values).forEach((key) => {\n    let dates = values[key];\n\n    let intersect = window.intersect(dates);\n\n    if (!intersect) {\n      if (!ret) {\n        ret = { ...values };\n      }\n      delete ret[key];\n    }\n  });\n\n  if (ret) {\n    return ret;\n  } else {\n    return values;\n  }\n}\n\nfunction _filterProject(values, project) {\n  if (!values) {\n    return values;\n  }\n\n  let ret = null;\n\n  Object.keys(values).forEach((key) => {\n    if (!(key in project)) {\n      if (!ret) {\n        ret = { ...values };\n      }\n      delete ret[key];\n    }\n  });\n\n  if (ret) {\n    return ret;\n  } else {\n    return values;\n  }\n}\n\nclass Business {\n  constructor(props) {\n    this.state = {\n      name: null,\n      id: null,\n      projects: {},\n      sources: {},\n      scores: {},\n      affiliations: {},\n      notes: [],\n      weight: 1,\n    };\n\n    this.setState(props);\n\n    this._getHook = null;\n    this._isABusinessObject = true;\n  }\n\n  static clone(item) {\n    let c = new Business();\n    c._getHook = item._getHook;\n    c.state = lodash.cloneDeep(item.state);\n    return c;\n  }\n\n  isNode() {\n    return true;\n  }\n\n  inGroup(group) {\n    if (group.getID) {\n      let ids = {};\n      ids[group.getID()] = 1;\n      group = ids;\n    }\n\n    let seen = {};\n\n    Object.keys(this.state.affiliations).forEach((key) => {\n      for (let index in this.state.affiliations[key]) {\n        if (this.state.affiliations[key][index] in group) {\n          seen[this.state.affiliations[key][index]] = 1;\n        }\n      }\n    });\n\n    return Object.keys(seen).length === Object.keys(group).length;\n  }\n\n  getID() {\n    return this.state.id;\n  }\n\n  filterSource(source) {\n    if (source.getID) {\n      let id = source.getID();\n      source = {};\n      source[id] = 1;\n    }\n\n    let nsources = Object.keys(source).length;\n\n    let seen = {};\n\n    Object.keys(this.state.sources).forEach((key) => {\n      let s = this.state.sources[key];\n\n      Object.keys(source).forEach((source_id) => {\n        if (s.includes(source_id)) {\n          seen[source_id] = 1;\n        }\n      });\n    });\n\n    if (Object.keys(seen).length !== nsources) {\n      return null;\n    } else {\n      return this;\n    }\n  }\n\n  filterProject(project) {\n    if (project.getID) {\n      let id = project.getID();\n      project = {};\n      project[id] = 1;\n    }\n\n    let nprojects = Object.keys(project).length;\n\n    let seen = {};\n\n    Object.keys(this.state.projects).forEach((key) => {\n      if (key in project) {\n        seen[key] = 1;\n      }\n    });\n\n    if (Object.keys(seen).length !== nprojects) {\n      return null;\n    }\n\n    let affiliations = _filterProject(this.state.affiliations, project);\n\n    if (affiliations !== this.state.affiliations) {\n      let business = new Business();\n      business.state = { ...this.state };\n      business.state.affiliations = affiliations;\n      business._getHook = this._getHook;\n      return business;\n    } else {\n      return this;\n    }\n  }\n\n  filterWindow(window) {\n    if (!window) {\n      return this;\n    } else if (!window._isADateRangeObject) {\n      window = new DateRange(window);\n    }\n\n    let affiliations = _filterWindow(this.state.affiliations, window);\n\n    if (affiliations !== this.state.affiliations) {\n      let business = new Business();\n      business.state = { ...this.state };\n      business.state.affiliations = affiliations;\n      business._getHook = this._getHook;\n      return business;\n    } else {\n      return this;\n    }\n  }\n\n  setState(state) {\n    if (state) {\n      this.state.name = setState(state.name);\n      this.state.id = setState(state.id);\n      this.state.projects = setState(state.projects, {});\n      this.state.affiliations = setState(state.affiliations, {});\n      this.state.scores = setState(state.scores, {});\n      this.state.sources = setState(state.sources, {});\n      this.state.notes = setState(state.notes, []);\n      this.state.weight = setState(state.weight);\n\n      if (!this.state.name) {\n        throw new ValueError(\"You cannot have an Business without a name\");\n      }\n    }\n  }\n\n  _updateHooks(hook) {\n    this._getHook = hook;\n  }\n\n  merge() {\n    return this;\n  }\n\n  getWeight() {\n    return this.state.weight;\n  }\n\n  toString() {\n    return `Business(${this.getName()})`;\n  }\n\n  getName() {\n    return this.state.name;\n  }\n\n  getAffiliations() {\n    return this.state.affiliations;\n  }\n\n  getSources() {\n    return this.state.sources;\n  }\n\n  getScores() {\n    return this.state.scores;\n  }\n\n  getNode(is_anchor = false) {\n    let node = { id: this.getID(), label: this.getName(), title: this.getName(), shape: \"circle\" };\n\n    const weight = this.getWeight();\n\n    node[\"size\"] = 0.5 * weight;\n    node[\"weight\"] = weight;\n\n    let keys = Object.keys(this.state.projects);\n\n    if (keys.length > 0) {\n      node[\"group\"] = keys.sort().join(\":\");\n    } else {\n      node[\"group\"] = \"unknown\";\n    }\n\n    if (is_anchor) {\n      node[\"shape\"] = \"rect\";\n      node[\"physics\"] = false;\n      node[\"group\"] = \"anchor\";\n      node[\"size\"] = 20.0;\n    }\n\n    return node;\n  }\n\n  toDry() {\n    return { value: this.state };\n  }\n}\n\nBusiness.unDry = function (value) {\n  return new Business(value);\n};\n\nDry.registerClass(\"Business\", Business);\n\nexport default Business;\n","import Dry from \"json-dry\";\nimport { v4 as uuidv4 } from \"uuid\";\nimport lodash from \"lodash\";\n\nimport Business from \"./Business\";\nimport { KeyError, MissingError } from \"./Errors\";\n\nfunction _generate_business_uid() {\n  let uid = uuidv4();\n  return \"B\" + uid.substring(uid.length - 7);\n}\n\nclass Businesses {\n  constructor(props) {\n    this.state = {\n      registry: {},\n    };\n\n    this._names = {};\n    this._isABusinessesObject = true;\n    this.load(props);\n  }\n\n  _updateHooks(hook) {\n    this._getHook = hook;\n    for (let key in this.state.registry) {\n      this.state.registry[key]._updateHooks(hook);\n    }\n  }\n\n  static clone(item) {\n    let c = new Businesses();\n    c.state = lodash.cloneDeep(item.state);\n    c._names = lodash.cloneDeep(item._names);\n    c._getHook = item._getHook;\n    return c;\n  }\n\n  values() {\n    let names = Object.keys(this._names);\n    names.sort();\n\n    let output = [];\n\n    names.forEach((key) => {\n      output.push(this.get(this._names[key]));\n    });\n\n    return output;\n  }\n\n  canAdd(item) {\n    return item instanceof Business || item._isABusinessObject;\n  }\n\n  add(business) {\n    if (!this.canAdd(business)) {\n      return null;\n    }\n\n    let existing = null;\n\n    try {\n      existing = this.getByName(business.getName());\n    } catch (error) {\n      console.error(error);\n    }\n\n    if (existing) {\n      existing = existing.merge(business);\n      this.state.registry[existing.getID()] = existing;\n      return existing;\n    }\n\n    business = Business.clone(business);\n\n    let id = business.getID();\n\n    if (id) {\n      if (id in this.state.registry) {\n        throw new KeyError(`Duplicate Business ID ${business}`);\n      }\n\n      business._updateHooks(this._getHook);\n      this.state.registry[id] = business;\n    } else {\n      let uid = _generate_business_uid();\n\n      while (uid in this.state.registry) {\n        uid = _generate_business_uid();\n      }\n\n      business.state.id = uid;\n    }\n\n    business._updateHooks(this._getHook);\n    this._names[business.getName()] = business.getID();\n    this.state.registry[business.getID()] = business;\n\n    return business;\n  }\n\n  getByName(name) {\n    let id = this._names[name];\n\n    if (id) {\n      return this.get(id);\n    } else {\n      throw new MissingError(`No Business with name ${name}`);\n    }\n  }\n\n  find(name) {\n    if (name instanceof Business || name._isABusinessObject) {\n      return this.get(name.getID());\n    }\n\n    name = name.trim().toLowerCase();\n\n    let results = [];\n\n    Object.keys(this._names).forEach((key) => {\n      if (key.toLowerCase().indexOf(name) !== -1) {\n        results.push(this.get(this._names[key]));\n      }\n    });\n\n    if (results.length === 1) {\n      return results[0];\n    } else if (results.length > 1) {\n      return results;\n    }\n\n    let keys = Object.keys(this._names).join(\"', '\");\n\n    throw new MissingError(`No Business matches '${name}. Available Businesses are '${keys}'`);\n  }\n\n  filter(funcs = []) {\n    if (funcs.length === 0) {\n      return this;\n    }\n\n    let registry = {};\n    let names = {};\n\n    Object.keys(this.state.registry).forEach((key) => {\n      let business = this.state.registry[key];\n\n      if (business) {\n        for (let i = 0; i < funcs.length; ++i) {\n          business = funcs[i](business);\n          if (!business) {\n            break;\n          }\n        }\n\n        if (business) {\n          registry[key] = business;\n          names[business.getName()] = key;\n        }\n      }\n    });\n\n    let businesses = new Businesses();\n    businesses.state.registry = registry;\n    businesses._names = names;\n    businesses._updateHooks(this._getHook);\n\n    return businesses;\n  }\n\n  getTimeLine() {\n    let items = [];\n\n    Object.keys(this.state.registry).forEach((key) => {\n      let business = this.state.registry[key];\n      if (business) {\n        let timeline = business.getTimeLine();\n        if (timeline) {\n          items.push(timeline);\n        }\n      }\n    });\n\n    return items;\n  }\n\n  getNodes({ anchor = null } = {}) {\n    let nodes = [];\n\n    Object.keys(this.state.registry).forEach((key) => {\n      let business = this.state.registry[key];\n\n      if (business) {\n        let node = null;\n        if (key === anchor) {\n          node = business.getNode({ is_anchor: true });\n        } else {\n          node = business.getNode();\n        }\n\n        if (node) {\n          nodes.push(node);\n        }\n      }\n    });\n\n    return nodes;\n  }\n\n  get(id) {\n    let business = this.state.registry[id];\n\n    if (!business) {\n      throw new MissingError(`No Business with ID ${id}`);\n    }\n\n    return business;\n  }\n\n  load(data) {\n    if (data) {\n      if (data.array) {\n        data = data.array;\n      }\n      data.forEach((element) => {\n        let business = Business.load(element);\n        this.add(business);\n      });\n    }\n  }\n\n  toDry() {\n    return { value: this.state };\n  }\n}\n\nBusinesses.unDry = function (value) {\n  let businesses = new Businesses();\n  businesses.state = value;\n  businesses._names = {};\n\n  Object.keys(value.registry).forEach((key) => {\n    let v = value.registry[key];\n    businesses._names[v.getName()] = key;\n  });\n\n  return businesses;\n};\n\nDry.registerClass(\"Businesses\", Businesses);\n\nexport default Businesses;\n","import Dry from \"json-dry\";\nimport lodash from \"lodash\";\n\nimport DateRange from \"./DateRange\";\n\nimport { ValueError } from \"./Errors\";\n\nfunction setState(val, def = null) {\n  if (val) {\n    return val;\n  } else {\n    return def;\n  }\n}\n\nfunction _mergeSources(state, other, key) {\n  state = state[key];\n  other = other[key];\n\n  Object.keys(other).forEach((key) => {\n    if (!(key in state)) {\n      state[key] = other[key];\n    } else {\n      for (let item in other[key]) {\n        if (!(item in state[key])) {\n          state[key].push(item);\n        }\n      }\n    }\n  });\n}\n\nclass Connection {\n  constructor(props) {\n    this.state = {\n      id: null,\n      n0: null,\n      n1: null,\n      shared: null,\n      type: null,\n      duration: null,\n      affiliations: null,\n      correspondances: null,\n      projects: null,\n      notes: null,\n    };\n\n    this.setState(props);\n    this._getHook = null;\n    this._isAConnectionObject = true;\n  }\n\n  static clone(item) {\n    let c = new Connection();\n    c._getHook = item._getHook;\n    c.state = lodash.cloneDeep(item.state);\n    return c;\n  }\n\n  _updateHooks(hook) {\n    this._getHook = hook;\n  }\n\n  getID() {\n    return this.state.id;\n  }\n\n  getName() {\n    let n0 = this.state.n0;\n    let n1 = this.state.n1;\n\n    if (n0 <= n1) {\n      return `${n0}<=>${n1}`;\n    } else {\n      return `${n1}<=>${n0}`;\n    }\n  }\n\n  getNode0() {\n    if (this._getHook) {\n      return this._getHook(this.state.n0);\n    } else {\n      return this.state.n0;\n    }\n  }\n\n  getNode1() {\n    if (this._getHook) {\n      return this._getHook(this.state.n1);\n    } else {\n      return this.state.n1;\n    }\n  }\n\n  getNode0ID() {\n    return this.state.n0;\n  }\n\n  getNode1ID() {\n    return this.state.n1;\n  }\n\n  areNodesVisible(n) {\n    return n[this.state.n0] && n[this.state.n1];\n  }\n\n  getNode0Name() {\n    let node0 = this.getNode0();\n\n    try {\n      return node0.getName();\n    } catch (error) {\n      return node0;\n    }\n  }\n\n  getNode1Name() {\n    let node1 = this.getNode1();\n\n    try {\n      return node1.getName();\n    } catch (error) {\n      return node1;\n    }\n  }\n\n  getDuration() {\n    return this.state.duration;\n  }\n\n  getAffiliationSources() {\n    return this.state.affiliations;\n  }\n\n  getCorrespondanceSources() {\n    return this.state.correspondances;\n  }\n\n  filterSource(source) {\n    if (source.getID) {\n      let id = source.getID();\n      source = {};\n      source[id] = 1;\n    }\n\n    let nsources = Object.keys(source).length;\n\n    let seen = {};\n\n    Object.keys(source).forEach((key) => {\n      if (this.state.affiliations[key] || this.state.correspondances[key]) {\n        seen[key] = 1;\n      }\n    });\n\n    if (Object.keys(seen).length !== nsources) {\n      return null;\n    } else {\n      return this;\n    }\n  }\n\n  filterProject(project) {\n    if (project.getID) {\n      let id = project.getID();\n      project = {};\n      project[id] = 1;\n    }\n\n    let nprojects = Object.keys(project).length;\n\n    let seen = {};\n\n    Object.keys(this.state.projects).forEach((key) => {\n      if (key in project) {\n        seen[key] = 1;\n      }\n    });\n\n    if (Object.keys(seen).length !== nprojects) {\n      return null;\n    } else {\n      return this;\n    }\n  }\n\n  filterWindow(window) {\n    if (!window) {\n      return this;\n    } else if (!window._isADateRangeObject) {\n      window = new DateRange(window);\n    }\n\n    if (!window) {\n      return this;\n    }\n\n    let duration = this.getDuration();\n\n    if (!duration) {\n      return this;\n    }\n\n    let intersect = window.intersect(duration);\n\n    if (!intersect) {\n      return null;\n    } else {\n      return this;\n    }\n  }\n\n  setState(state) {\n    if (state) {\n      this.state.id = setState(state.id);\n      this.state.n0 = setState(state.n0);\n      this.state.n1 = setState(state.n1);\n      this.state.shared = setState(state.shared, []);\n      this.state.type = setState(state.type);\n      this.state.duration = setState(state.duration);\n      this.state.affiliations = setState(state.affiliations, {});\n      this.state.correspondances = setState(state.correspondances, {});\n      this.state.notes = setState(state.notes, []);\n      this.state.weights = setState(state.weights, {});\n      this.state.projects = setState(state.projects, {});\n\n      if (!this.state.n0 || !this.state.n1) {\n        throw new ValueError(`Invalid connection ${this}`);\n      }\n    }\n  }\n\n  merge(other) {\n    if (!this._getHook) {\n      if (other._getHook) {\n        return other.merge(this);\n      }\n    }\n\n    let state = lodash.cloneDeep(this.state);\n\n    Object.keys(other.state.shared).forEach((key) => {\n      if (!(key in state.shared)) {\n        state.shared[key] = other.state.shared[key];\n      }\n    });\n\n    Object.keys(other.state.notes).forEach((key) => {\n      if (!(key in state.notes)) {\n        state.notes[key] = other.state.notes[key];\n      }\n    });\n\n    _mergeSources(state, other.state, \"affiliations\");\n    _mergeSources(state, other.state, \"correspondances\");\n\n    state.duration = state.duration.merge(other.state.duration);\n\n    let c = new Connection();\n    c.state = state;\n    c._getHook = this._getHook;\n\n    return c;\n  }\n\n  toString() {\n    return `Connection(${this.getNode0Name()}<=>${this.getNode1Name()})`;\n  }\n\n  getColorFromType() {\n    switch (this.state.type) {\n      case \"direct\":\n        return \"rgb(180,150,150)\";\n      case \"indirect\":\n        return \"rgb(180,180,180)\";\n      default:\n        console.log(`Unknown type? ${this.state.type}`);\n        return \"red\";\n    }\n  }\n\n  getType() {\n    return this.state.type;\n  }\n\n  getWeights() {\n    return this.state.weights;\n  }\n\n  getWeight() {\n    let weight = 1.0;\n\n    Object.keys(this.state.weights).forEach((key) => {\n      weight += this.state.weights[key];\n    });\n\n    return weight;\n  }\n\n  getWeightFromType() {\n    let weight = this.getWeight();\n\n    switch (this.state.type) {\n      case \"direct\":\n        return 1.0 * weight;\n      case \"indirect\":\n        return 0.5 * weight;\n      default:\n        console.log(`Unknown type? ${this.state.type}`);\n        return 0.5 * weight;\n    }\n  }\n\n  toEdge() {\n    let color = this.getColorFromType();\n    // let weight = this.getWeightFromType();\n    let weight = this.getWeight();\n\n    let edge = {\n      id: this.getID(),\n      source: this.state.n0,\n      target: this.state.n1,\n      value: weight,\n      type: this.state.type,\n      color: color,\n    };\n\n    return edge;\n  }\n\n  toDry() {\n    return { value: this.state };\n  }\n}\n\nConnection.unDry = function (value) {\n  return new Connection(value);\n};\n\nConnection.load = function (data) {\n  return new Connection({ name: data.name });\n};\n\nDry.registerClass(\"Connection\", Connection);\n\nexport default Connection;\n","import Dry from \"json-dry\";\nimport { v4 as uuidv4 } from \"uuid\";\nimport lodash from \"lodash\";\n\nimport Connection from \"./Connection\";\nimport { KeyError, MissingError } from \"./Errors\";\n\nfunction _generate_connection_uid() {\n  let uid = uuidv4();\n  return \"C\" + uid.substring(uid.length - 7);\n}\n\nclass Connections {\n  constructor() {\n    this.state = {\n      registry: {},\n    };\n\n    this._names = {};\n    this._isAConnectionsObject = true;\n  }\n\n  _updateHooks(hook) {\n    this._getHook = hook;\n    for (let key in this.state.registry) {\n      this.state.registry[key]._updateHooks(hook);\n    }\n  }\n\n  static clone(item) {\n    let c = new Connections();\n    c.state = lodash.cloneDeep(item.state);\n    c._names = lodash.cloneDeep(item._names);\n    c._getHook = item._getHook;\n    return c;\n  }\n\n  canAdd(item) {\n    return item instanceof Connection || item._isAConnectionObject;\n  }\n\n  add(connection) {\n    if (!this.canAdd(connection)) {\n      return null;\n    }\n\n    let existing = null;\n\n    try {\n      existing = this.getByName(connection.getName());\n    } catch (error) {\n      console.error(error);\n    }\n\n    if (existing) {\n      existing = existing.merge(connection);\n      this.state.registry[existing.getID()] = existing;\n      return existing;\n    }\n\n    connection = Connection.clone(connection);\n\n    let id = connection.getID();\n\n    if (id) {\n      if (id in this.state.registry) {\n        throw new KeyError(`Duplicate Connection ID ${connection}`);\n      }\n    } else {\n      let uid = _generate_connection_uid();\n\n      while (uid in this.state.registry) {\n        uid = _generate_connection_uid();\n      }\n\n      connection.state.id = uid;\n    }\n\n    connection._updateHooks(this._getHook);\n    this._names[connection.getName()] = connection.getID();\n    this.state.registry[connection.getID()] = connection;\n\n    return connection;\n  }\n\n  getByName(name) {\n    let id = this._names[name];\n\n    if (id) {\n      return this.get(id);\n    } else {\n      throw new MissingError(`No connection with name ${name}`);\n    }\n  }\n\n  find(name) {\n    if (name instanceof Connection || name._isAConnectionObject) {\n      return this.get(name.getID());\n    }\n\n    name = name.trim().toLowerCase();\n\n    let results = [];\n\n    Object.keys(this._names).forEach((key) => {\n      if (key.toLowerCase().indexOf(name) !== -1) {\n        results.push(this.get(this._names[key]));\n      }\n    });\n\n    if (results.length === 1) {\n      return results[0];\n    } else if (results.length > 1) {\n      return results;\n    }\n\n    let keys = Object.keys(this._names).join(\"', '\");\n\n    throw new MissingError(`No connection matches '${name}. Available Connections are '${keys}'`);\n  }\n\n  get(id) {\n    let connection = this.state.registry[id];\n\n    if (!connection) {\n      throw new MissingError(`No Connection with ID ${id}`);\n    }\n\n    return connection;\n  }\n\n  filter(funcs = []) {\n    if (funcs.length === 0) {\n      return this;\n    }\n\n    let registry = {};\n    let names = {};\n\n    Object.keys(this.state.registry).forEach((key) => {\n      let connection = this.state.registry[key];\n\n      if (connection) {\n        for (let i = 0; i < funcs.length; ++i) {\n          connection = funcs[i](connection);\n          if (!connection) {\n            break;\n          }\n        }\n\n        if (connection) {\n          registry[key] = connection;\n          names[connection.getName()] = key;\n        }\n      }\n    });\n\n    let connections = new Connections();\n\n    connections.state.registry = registry;\n    connections._names = names;\n    connections._updateHooks(this._getHook);\n\n    return connections;\n  }\n\n  getConnectionsTo(item) {\n    if (item.getID) {\n      let id = item.getID();\n      item = {};\n      item[id] = 1;\n    }\n\n    let nnodes = Object.keys(item).length;\n\n    let seen = {};\n\n    function _add(id) {\n      if (!(id in seen)) {\n        seen[id] = 1;\n      } else {\n        seen[id] += 1;\n      }\n    }\n\n    for (let key in this.state.registry) {\n      let connection = this.state.registry[key];\n\n      if (connection.getNode0ID() in item) {\n        _add(connection.getNode1ID());\n      } else if (connection.getNode1ID() in item) {\n        _add(connection.getNode0ID());\n      }\n    }\n\n    let connections = [];\n\n    if (this._getHook) {\n      Object.keys(seen).forEach((key) => {\n        try {\n          if (seen[key] === nnodes) {\n            connections.push(this._getHook(key));\n          }\n        } catch (error) {\n          console.error(error);\n        }\n      });\n    } else {\n      connections = Object.keys(seen);\n    }\n\n    return connections;\n  }\n\n  getEdges(ids = null) {\n    let edges = [];\n\n    if (ids) {\n      Object.keys(this.state.registry).forEach((key) => {\n        let connection = this.state.registry[key];\n        if (connection.areNodesVisible(ids)) {\n          edges.push(connection.toEdge());\n        }\n      });\n    } else {\n      Object.keys(this.state.registry).forEach((key) => {\n        let connection = this.state.registry[key];\n        edges.push(connection.toEdge());\n      });\n    }\n\n    return edges;\n  }\n\n  toDry() {\n    return { value: this.state };\n  }\n}\n\nConnections.unDry = function (value) {\n  let connections = new Connections();\n  connections.state = value;\n  connections._names = {};\n\n  Object.keys(value.registry).forEach((key) => {\n    let v = value.registry[key];\n    connections._names[v.getName()] = key;\n  });\n\n  return connections;\n};\n\nDry.registerClass(\"Connections\", Connections);\n\nexport default Connections;\n","import Dry from \"json-dry\";\nimport lodash from \"lodash\";\n\nimport { ValueError } from \"./Errors\";\n\nfunction setState(val, def = null) {\n  if (val) {\n    return val;\n  } else {\n    return def;\n  }\n}\n\nclass Position {\n  constructor(props) {\n    this.state = {\n      name: null,\n      id: null,\n      sources: [],\n      notes: [],\n    };\n\n    this.setState(props);\n\n    this._getHook = null;\n    this._isAPositionObject = true;\n  }\n\n  static clone(item) {\n    let c = new Position();\n    c._getHook = item._getHook;\n    c.state = lodash.cloneDeep(item.state);\n    return c;\n  }\n\n  getID() {\n    return this.state.id;\n  }\n\n  static makeCanonical(name) {\n    if (!name) {\n      return null;\n    } else {\n      return name.trim().toLowerCase();\n    }\n  }\n\n  setState(state) {\n    if (state) {\n      this.state.name = setState(state.name);\n      this.state.id = setState(state.id);\n      this.state.notes = setState(state.notes, []);\n      this.state.sources = setState(state.sources, []);\n\n      this.state.canonical = Position.makeCanonical(this.state.name);\n\n      if (!this.state.name){\n        throw new ValueError(\"You cannot have an Position without a name\");\n      }\n    }\n  }\n\n  _updateHooks(hook) {\n    this._getHook = hook;\n  }\n\n  merge() {\n    return this;\n  }\n\n  toString() {\n    return `Position(${this.getName()})`;\n  }\n\n  getName() {\n    return this.state.name;\n  }\n\n  toDry() {\n    return { value: this.state };\n  }\n}\n\nPosition.unDry = function (value) {\n  return new Position(value);\n};\n\nDry.registerClass(\"Position\", Position);\n\nexport default Position;\n","import Dry from \"json-dry\";\nimport { v4 as uuidv4 } from \"uuid\";\nimport lodash from \"lodash\";\n\nimport Position from \"./Position\";\nimport { KeyError, MissingError } from \"./Errors\";\n\nfunction _generate_position_uid() {\n  let uid = uuidv4();\n  return \"Q\" + uid.substring(uid.length - 7);\n}\n\nclass Positions {\n  constructor() {\n    this.state = {\n      registry: {},\n    };\n\n    this._names = {};\n    this._isAPositionsObject = true;\n  }\n\n  _updateHooks(hook) {\n    this._getHook = hook;\n    for (let key in this.state.registry) {\n      this.state.registry[key]._updateHooks(hook);\n    }\n  }\n\n  static clone(item) {\n    let c = new Positions();\n    c.state = lodash.cloneDeep(item.state);\n    c._names = lodash.cloneDeep(item._names);\n    c._getHook = item._getHook;\n    return c;\n  }\n\n  values() {\n    let names = Object.keys(this._names);\n    names.sort();\n\n    let output = [];\n\n    names.forEach((key) => {\n      output.push(this.get(this._names[key]));\n    });\n    console.log(\"Output : \", output);\n\n    return output;\n  }\n\n  items() {\n    return this._names;\n  }\n\n  canAdd(item) {\n    return item instanceof Position || item._isAPositionObject;\n  }\n\n  add(position) {\n    if (!this.canAdd(position)) {\n      return null;\n    }\n\n    let existing = null;\n\n    try {\n      existing = this.getByName(position.getName());\n    } catch (error) {\n      console.error(error);\n    }\n\n    if (existing) {\n      existing = existing.merge(position);\n      this.state.registry[existing.getID()] = existing;\n      return existing;\n    }\n\n    position = Position.clone(position);\n\n    let id = position.getID();\n\n    if (id) {\n      if (id in this.state.registry) {\n        throw new KeyError(`Duplicate Position ID ${position}`);\n      }\n\n      position._updateHooks(this._getHook);\n      this.state.registry[id] = position;\n    } else {\n      let uid = _generate_position_uid();\n\n      while (uid in this.state.registry) {\n        uid = _generate_position_uid();\n      }\n\n      position.state.id = uid;\n    }\n\n    position._updateHooks(this._getHook);\n    this._names[position.getName()] = position.getID();\n    this.state.registry[position.getID()] = position;\n\n    return position;\n  }\n\n  getByName(name) {\n    let id = this._names[name];\n\n    if (id) {\n      return this.get(id);\n    } else {\n      throw new MissingError(`No position with name ${name}`);\n    }\n  }\n\n  find(name) {\n    if (name instanceof Position || name._isApositionObject) {\n      return this.get(name.getID());\n    }\n\n    name = name.trim().toLowerCase();\n\n    let results = [];\n\n    Object.keys(this._names).forEach((key) => {\n      if (key.toLowerCase().indexOf(name) !== -1) {\n        results.push(this.get(this._names[key]));\n      }\n    });\n\n    if (results.length === 1) {\n      return results[0];\n    } else if (results.length > 1) {\n      return results;\n    }\n\n    let keys = Object.keys(this._names).join(\"', '\");\n\n    throw new MissingError(`No position matches '${name}. Available Positions are '${keys}'`);\n  }\n\n  get(id) {\n    let position = this.state.registry[id];\n\n    if (!position) {\n      throw new MissingError(`No Position with ID ${id}`);\n    }\n\n    return position;\n  }\n\n  toDry() {\n    return { value: this.state };\n  }\n}\n\nPositions.unDry = function (value) {\n  let positions = new Positions();\n  positions.state = value;\n  positions._names = {};\n\n  Object.keys(value.registry).forEach((key) => {\n    let v = value.registry[key];\n    positions._names[v.getName()] = key;\n  });\n\n  return positions;\n};\n\nDry.registerClass(\"Positions\", Positions);\n\nexport default Positions;\n","import Dry from \"json-dry\";\nimport lodash from \"lodash\";\n\nimport { ValueError } from \"./Errors\";\n\nfunction setState(val, def = null) {\n  if (val) {\n    return val;\n  } else {\n    return def;\n  }\n}\n\nclass Affiliation {\n  constructor(props) {\n    this.state = {\n      name: null,\n      id: null,\n      sources: [],\n      notes: [],\n    };\n\n    this.setState(props);\n\n    this._getHook = null;\n    this._isAAffiliationObject = true;\n  }\n\n  static clone(item) {\n    let c = new Affiliation();\n    c._getHook = item._getHook;\n    c.state = lodash.cloneDeep(item.state);\n    return c;\n  }\n\n  getID() {\n    return this.state.id;\n  }\n\n  static makeCanonical(name) {\n    if (!name) {\n      return null;\n    } else {\n      return name.trim().toLowerCase();\n    }\n  }\n\n  setState(state) {\n    if (state) {\n      this.state.name = setState(state.name);\n      this.state.id = setState(state.id);\n      this.state.notes = setState(state.notes, []);\n      this.state.sources = setState(state.sources, []);\n\n      this.state.canonical = Affiliation.makeCanonical(this.state.name);\n\n      if (!this.state.name) {\n        throw new ValueError(\"You cannot have an Affiliation without a name\");\n      }\n    }\n  }\n\n  _updateHooks(hook) {\n    this._getHook = hook;\n  }\n\n  merge() {\n    return this;\n  }\n\n  toString() {\n    return `Affiliation(${this.getName()})`;\n  }\n\n  getName() {\n    return this.state.name;\n  }\n\n  toDry() {\n    return { value: this.state };\n  }\n}\n\nAffiliation.unDry = function (value) {\n  return new Affiliation(value);\n};\n\nDry.registerClass(\"Affiliation\", Affiliation);\n\nexport default Affiliation;\n","import Dry from \"json-dry\";\nimport { v4 as uuidv4 } from \"uuid\";\nimport lodash from \"lodash\";\n\nimport Affiliation from \"./Affiliation\";\nimport { KeyError, MissingError } from \"./Errors\";\n\nfunction _generate_affiliation_uid() {\n  let uid = uuidv4();\n  return \"A\" + uid.substring(uid.length - 7);\n}\n\nclass Affiliations {\n  constructor() {\n    this.state = {\n      registry: {},\n    };\n\n    this._names = {};\n    this._isAAffiliationsObject = true;\n  }\n\n  _updateHooks(hook) {\n    this._getHook = hook;\n    for (let key in this.state.registry) {\n      this.state.registry[key]._updateHooks(hook);\n    }\n  }\n\n  static clone(item) {\n    let c = new Affiliations();\n    c.state = lodash.cloneDeep(item.state);\n    c._names = lodash.cloneDeep(item._names);\n    c._getHook = item._getHook;\n    return c;\n  }\n\n  values() {\n    let names = Object.keys(this._names);\n    names.sort();\n\n    let output = [];\n\n    names.forEach((key) => {\n      output.push(this.get(this._names[key]));\n    });\n\n    return output;\n  }\n\n  canAdd(item) {\n    return item instanceof Affiliation || item._isAAffiliationObject;\n  }\n\n  add(affiliation) {\n    if (!this.canAdd(affiliation)) {\n      return null;\n    }\n\n    let existing = null;\n\n    try {\n      existing = this.getByName(affiliation.getName());\n    } catch (error) {\n      console.error(error);\n    }\n\n    if (existing) {\n      existing = existing.merge(affiliation);\n      this.state.registry[existing.getID()] = existing;\n      return existing;\n    }\n\n    affiliation = Affiliation.clone(affiliation);\n\n    let id = affiliation.getID();\n\n    if (id) {\n      if (id in this.state.registry) {\n        throw new KeyError(`Duplicate Affiliation ID ${affiliation}`);\n      }\n\n      affiliation._updateHooks(this._getHook);\n      this.state.registry[id] = affiliation;\n    } else {\n      let uid = _generate_affiliation_uid();\n\n      while (uid in this.state.registry) {\n        uid = _generate_affiliation_uid();\n      }\n\n      affiliation.state.id = uid;\n    }\n\n    affiliation._updateHooks(this._getHook);\n    this._names[affiliation.getName()] = affiliation.getID();\n    this.state.registry[affiliation.getID()] = affiliation;\n\n    return affiliation;\n  }\n\n  getByName(name) {\n    let id = this._names[name];\n\n    if (id) {\n      return this.get(id);\n    } else {\n      throw new MissingError(`No affiliation with name ${name}`);\n    }\n  }\n\n  find(name) {\n    if (name instanceof Affiliation || name._isAAffiliationObject) {\n      return this.get(name.getID());\n    }\n\n    name = name.trim().toLowerCase();\n\n    let results = [];\n\n    Object.keys(this._names).forEach((key) => {\n      if (key.toLowerCase().indexOf(name) !== -1) {\n        results.push(this.get(this._names[key]));\n      }\n    });\n\n    if (results.length === 1) {\n      return results[0];\n    } else if (results.length > 1) {\n      return results;\n    }\n\n    let keys = Object.keys(this._names).join(\"', '\");\n\n    throw new MissingError(`No affiliation matches '${name}. Available Affiliations are '${keys}'`);\n  }\n\n  get(id) {\n    let affiliation = this.state.registry[id];\n\n    if (!affiliation) {\n      throw new MissingError(`No Affiliation with ID ${id}`);\n    }\n\n    return affiliation;\n  }\n\n  toDry() {\n    return { value: this.state };\n  }\n}\n\nAffiliations.unDry = function (value) {\n  let affiliations = new Affiliations();\n  affiliations.state = value;\n  affiliations._names = {};\n\n  Object.keys(value.registry).forEach((key) => {\n    let v = value.registry[key];\n    affiliations._names[v.getName()] = key;\n  });\n\n  return affiliations;\n};\n\nDry.registerClass(\"Affiliations\", Affiliations);\n\nexport default Affiliations;\n","import Dry from \"json-dry\";\nimport lodash from \"lodash\";\n\nimport RoughDate from \"./RoughDate\";\n\nimport { ValueError } from \"./Errors\";\n\nfunction setState(val, def = null) {\n  if (val) {\n    return val;\n  } else {\n    return def;\n  }\n}\n\nclass Source {\n  constructor(props) {\n    this.state = {\n      name: null,\n      id: null,\n      date: null,\n      description: null,\n      notes: [],\n    };\n\n    this.setState(props);\n\n    this._getHook = null;\n    this._isASourceObject = true;\n  }\n\n  static clone(item) {\n    let c = new Source();\n    c._getHook = item._getHook;\n    c.state = lodash.cloneDeep(item.state);\n    return c;\n  }\n\n  getID() {\n    return this.state.id;\n  }\n\n  getDate() {\n    return this.state.date;\n  }\n\n  updateDate(date, force = false) {\n    if (!(date instanceof RoughDate || date._isARoughDateObject)) {\n      date = new RoughDate(date);\n    }\n\n    if (date.isNull()) {\n      return false;\n    }\n\n    if (this.getDate().isNull()) {\n      this.state.date = date;\n      return true;\n    }\n\n    if (RoughDate.ne(this.getDate(), date)) {\n      if (force) {\n        this.state.date = this.getDate().merge(date);\n        return true;\n      } else {\n        console.log(`Disagreement of date for ${this}: ${this.getDate()} vs ${date}`);\n      }\n    }\n\n    return false;\n  }\n\n  setState(state) {\n    if (state) {\n      this.state.name = setState(state.name);\n      this.state.id = setState(state.id);\n      this.state.description = setState(state.description);\n      this.state.notes = setState(state.notes, []);\n      this.state.sources = setState(state.sources, []);\n      this.state.date = setState(state.date, new RoughDate());\n\n      if (!this.state.name) {\n        throw new ValueError(\"You cannot have an Source without a name\");\n      }\n    }\n  }\n\n  _updateHooks(hook) {\n    this._getHook = hook;\n  }\n\n  merge() {\n    return this;\n  }\n\n  toString() {\n    return `Source(${this.getName()})`;\n  }\n\n  getName() {\n    return this.state.name;\n  }\n\n  getDescription() {\n    return this.state.description;\n  }\n\n  toDry() {\n    return { value: this.state };\n  }\n}\n\nSource.unDry = function (value) {\n  return new Source(value);\n};\n\nDry.registerClass(\"Source\", Source);\n\nexport default Source;\n","import Dry from \"json-dry\";\nimport { v4 as uuidv4 } from \"uuid\";\nimport lodash from \"lodash\";\n\nimport Source from \"./Source\";\nimport { KeyError, MissingError } from \"./Errors\";\n\nfunction _generate_source_uid() {\n  let uid = uuidv4();\n  return \"S\" + uid.substring(uid.length - 7);\n}\n\nclass Sources {\n  constructor() {\n    this.state = {\n      registry: {},\n    };\n\n    this._names = {};\n    this._isASourcesObject = true;\n  }\n\n  _updateHooks(hook) {\n    this._getHook = hook;\n    for (let key in this.state.registry) {\n      this.state.registry[key]._updateHooks(hook);\n    }\n  }\n\n  static clone(item) {\n    let c = new Sources();\n    c.state = lodash.cloneDeep(item.state);\n    c._names = lodash.cloneDeep(item._names);\n    c._getHook = item._getHook;\n    return c;\n  }\n\n  values() {\n    let names = Object.keys(this._names);\n    names.sort();\n\n    let output = [];\n\n    names.forEach((key) => {\n      output.push(this.get(this._names[key]));\n    });\n\n    return output;\n  }\n\n  canAdd(item) {\n    return item instanceof Source || item._isASourceObject;\n  }\n\n  add(source) {\n    if (!this.canAdd(source)) {\n      return null;\n    }\n\n    let existing = null;\n\n    try {\n      existing = this.getByName(source.getName());\n    } catch (error) {\n      console.error(error);\n    }\n\n    if (existing) {\n      existing = existing.merge(source);\n      this.state.registry[existing.getID()] = existing;\n      return existing;\n    }\n\n    source = Source.clone(source);\n\n    let id = source.getID();\n\n    if (id) {\n      if (id in this.state.registry) {\n        throw new KeyError(`Duplicate Source ID ${source}`);\n      }\n\n      source._updateHooks(this._getHook);\n      this.state.registry[id] = source;\n    } else {\n      let uid = _generate_source_uid();\n\n      while (uid in this.state.registry) {\n        uid = _generate_source_uid();\n      }\n\n      source.state.id = uid;\n    }\n\n    source._updateHooks(this._getHook);\n    this._names[source.getName()] = source.getID();\n    this.state.registry[source.getID()] = source;\n\n    return source;\n  }\n\n  getByName(name) {\n    let id = this._names[name];\n\n    if (id) {\n      return this.get(id);\n    } else {\n      throw new MissingError(`No source with name ${name}`);\n    }\n  }\n\n  search(name) {\n    if (name instanceof Source || name._isASourceObject) {\n      name = name.getName();\n    }\n\n    name = name.trim().toLowerCase();\n\n    let results = [];\n\n    Object.keys(this.state.registry).forEach((key) => {\n      let item = this.state.registry[key];\n\n      let description = item.getDescription();\n\n      if (!description) {\n        description = \"\";\n      }\n\n      try {\n        if (item.getName().toLowerCase().indexOf(name) !== -1) {\n          results.push(item);\n        } else if (description.toLowerCase().indexOf(name) !== -1) {\n          results.push(item);\n        }\n      } catch (error) {\n        console.log(error);\n      }\n    });\n\n    if (results.length === 1) {\n      return results[0];\n    } else if (results.length > 1) {\n      return results;\n    } else {\n      return null;\n    }\n  }\n\n  find(name) {\n    if (name instanceof Source || name._isASourceObject) {\n      return this.get(name.getID());\n    }\n\n    name = name.trim().toLowerCase();\n\n    let results = [];\n\n    Object.keys(this._names).forEach((key) => {\n      if (key.toLowerCase().indexOf(name) !== -1) {\n        results.push(this.get(this._names[key]));\n      }\n    });\n\n    if (results.length === 1) {\n      return results[0];\n    } else if (results.length > 1) {\n      return results;\n    }\n\n    let keys = Object.keys(this._names).join(\"', '\");\n\n    throw new MissingError(`No source matches '${name}. Available sources are '${keys}'`);\n  }\n\n  get(id) {\n    let source = this.state.registry[id];\n\n    if (!source) {\n      throw new MissingError(`No Source with ID ${id}`);\n    }\n\n    return source;\n  }\n\n  toDry() {\n    return { value: this.state };\n  }\n}\n\nSources.unDry = function (value) {\n  let sources = new Sources();\n  sources.state = value;\n  sources._names = {};\n\n  Object.keys(value.registry).forEach((key) => {\n    let v = value.registry[key];\n    sources._names[v.getName()] = key;\n  });\n\n  return sources;\n};\n\nDry.registerClass(\"Sources\", Sources);\n\nexport default Sources;\n","import Dry from \"json-dry\";\nimport lodash from \"lodash\";\n\nfunction setState(val, def = null) {\n  if (val) {\n    return val;\n  } else {\n    return def;\n  }\n}\n\nclass Note {\n  constructor(props) {\n    this.state = {\n      text: null,\n      id: null,\n      sources: [],\n    };\n\n    this.setState(props);\n\n    this._getHook = null;\n    this._isANoteObject = true;\n  }\n\n  static clone(item) {\n    let c = new Note();\n    c._getHook = item._getHook;\n    c.state = lodash.cloneDeep(item.state);\n    return c;\n  }\n\n  getID() {\n    return this.state.id;\n  }\n\n  setState(state) {\n    if (state) {\n      this.state.text = setState(state.text);\n      this.state.id = setState(state.id);\n      this.state.sources = setState(state.sources, []);\n    }\n  }\n\n  _updateHooks(hook) {\n    this._getHook = hook;\n  }\n\n  toString() {\n    return `Note(${this.getText()})`;\n  }\n\n  getText() {\n    return this.state.text;\n  }\n\n  toDry() {\n    return { value: this.state };\n  }\n}\n\nNote.unDry = function (value) {\n  return new Note(value);\n};\n\nDry.registerClass(\"Note\", Note);\n\nexport default Note;\n","import Dry from \"json-dry\";\nimport { v4 as uuidv4 } from \"uuid\";\nimport lodash from \"lodash\";\n\nimport Note from \"./Note\";\nimport { KeyError, MissingError } from \"./Errors\";\n\nfunction _generate_note_uid() {\n  let uid = uuidv4();\n  return \"N\" + uid.substring(uid.length - 7);\n}\n\nclass Notes {\n  constructor() {\n    this.state = {\n      registry: {},\n    };\n\n    this._names = {};\n    this._isANotesObject = true;\n  }\n\n  _updateHooks(hook) {\n    this._getHook = hook;\n    for (let key in this.state.registry) {\n      this.state.registry[key]._updateHooks(hook);\n    }\n  }\n\n  static clone(item) {\n    let c = new Notes();\n    c.state = lodash.cloneDeep(item.state);\n    c._names = lodash.cloneDeep(item._names);\n    c._getHook = item._getHook;\n    return c;\n  }\n\n  canAdd(item) {\n    return item instanceof Note || item._isANoteObject;\n  }\n\n  add(note) {\n    if (!this.canAdd(note)) {\n      return null;\n    }\n\n    let existing = null;\n\n    try {\n      existing = this.getByName(note.getName());\n    } catch (error) {\n      console.error(error);\n    }\n\n    if (existing) {\n      existing = existing.merge(note);\n      this.state.registry[existing.getID()] = existing;\n      return existing;\n    }\n\n    note = note.clone(Note);\n\n    let id = note.getID();\n\n    if (id) {\n      if (id in this.state.registry) {\n        throw new KeyError(`Duplicate Note ID ${note}`);\n      }\n\n      note._updateHooks(this._getHook);\n      this.state.registry[id] = Note;\n    } else {\n      let uid = _generate_note_uid();\n\n      while (uid in this.state.registry) {\n        uid = _generate_note_uid();\n      }\n\n      note.state.id = uid;\n    }\n\n    note._updateHooks(this._getHook);\n    this._names[note.getName()] = note.getID();\n    this.state.registry[note.getID()] = note;\n\n    return note;\n  }\n\n  getByName(name) {\n    let id = this._names[name];\n\n    if (id) {\n      return this.get(id);\n    } else {\n      throw new MissingError(`No Note with name ${name}`);\n    }\n  }\n\n  find(name) {\n    if (name instanceof Note || name._isANoteObject) {\n      return this.get(name.getID());\n    }\n\n    name = name.trim().toLowerCase();\n\n    let results = [];\n\n    Object.keys(this._names).forEach((key) => {\n      if (key.toLowerCase().indexOf(name) !== -1) {\n        results.push(this.get(this._names[key]));\n      }\n    });\n\n    if (results.length === 1) {\n      return results[0];\n    } else if (results.length > 1) {\n      return results;\n    }\n\n    let keys = Object.keys(this._names).join(\"', '\");\n\n    throw new MissingError(`No Note matches '${name}. Available Notes are '${keys}'`);\n  }\n\n  get(id) {\n    let Note = this.state.registry[id];\n\n    if (!Note) {\n      throw new MissingError(`No Note with ID ${id}`);\n    }\n\n    return Note;\n  }\n\n  toDry() {\n    return { value: this.state };\n  }\n}\n\nNotes.unDry = function (value) {\n  let notes = new Notes();\n  notes.state = value;\n  notes._names = {};\n\n  Object.keys(value.registry).forEach((key) => {\n    let v = value.registry[key];\n    notes._names[v.getName()] = key;\n  });\n\n  return notes;\n};\n\nDry.registerClass(\"Notes\", Notes);\n\nexport default Notes;\n","import Dry from \"json-dry\";\nimport lodash from \"lodash\";\n\nimport DateRange from \"./DateRange\";\nimport { ValueError } from \"./Errors\";\n\nfunction setState(val, def = null) {\n  if (val) {\n    return val;\n  } else {\n    return def;\n  }\n}\n\nclass Project {\n  constructor(props) {\n    this.state = {\n      name: null,\n      id: null,\n      url: null,\n      duration: new DateRange(),\n      notes: {},\n    };\n\n    this.setState(props);\n\n    this._getHook = null;\n    this._isAProjectObject = true;\n  }\n\n  static clone(item) {\n    let c = new Project();\n    c._getHook = item._getHook;\n    c.state = lodash.cloneDeep(item.state);\n    return c;\n  }\n\n  getID() {\n    return this.state.id;\n  }\n\n  setState(state) {\n    if (state) {\n      this.state.name = setState(state.name);\n      this.state.id = setState(state.id);\n      this.state.notes = setState(state.notes, {});\n      this.state.url = setState(state.url, null);\n      this.state.duration = new DateRange({ value: state.duration });\n\n      if (!this.state.name) {\n        throw new ValueError(\"You cannot have a Project without a name\");\n      }\n    }\n  }\n\n  _updateHooks(hook) {\n    this._getHook = hook;\n  }\n\n  merge() {\n    return this;\n  }\n\n  toString() {\n    return `Project(${this.getName()})`;\n  }\n\n  getName() {\n    return this.state.name;\n  }\n\n  getURL() {\n    return this.state.url;\n  }\n\n  getDuration() {\n    return this.state.duration;\n  }\n\n  getTimeLine() {\n    const duration = this.getDuration();\n\n    if (duration && duration.hasBounds()) {\n      return {\n        start: duration.getEarliestStart().toDate(),\n        end: duration.getLatestEnd().toDate(),\n        id: this.getID(),\n        content: this.getName(),\n      };\n    } else {\n      return null;\n    }\n  }\n\n  getNewTimeLine() {\n    const duration = this.getDuration();\n\n    if (duration && duration.hasBounds()) {\n      return {\n        start_time: duration.getEarliestStart().toMoment(),\n        end_time: duration.getLatestEnd().toMoment(),\n        project_id: this.getID(),\n        title: this.getName(),\n      };\n    } else {\n      return null;\n    }\n  }\n\n  toDry() {\n    return { value: this.state };\n  }\n}\n\nProject.unDry = function (value) {\n  return new Project(value);\n};\n\nDry.registerClass(\"Project\", Project);\n\nexport default Project;\n","import Dry from \"json-dry\";\nimport { v4 as uuidv4 } from \"uuid\";\nimport lodash from \"lodash\";\n\nimport Project from \"./Project\";\nimport { KeyError, MissingError } from \"./Errors\";\n\nfunction _generate_project_uid() {\n  let uid = uuidv4();\n  return \"J\" + uid.substring(uid.length - 7);\n}\n\nclass Projects {\n  constructor() {\n    this.state = {\n      registry: {},\n    };\n\n    this._names = {};\n    this._isAProjectsObject = true;\n  }\n\n  _updateHooks(hook) {\n    this._getHook = hook;\n    for (let key in this.state.registry) {\n      this.state.registry[key]._updateHooks(hook);\n    }\n  }\n\n  static clone(item) {\n    let c = new Projects();\n    c.state = lodash.cloneDeep(item.state);\n    c._names = lodash.cloneDeep(item._names);\n    c._getHook = item._getHook;\n    return c;\n  }\n\n  values() {\n    let names = Object.keys(this._names);\n\n    let output = [];\n\n    names.forEach((key) => {\n      output.push(this.get(this._names[key]));\n    });\n\n    return output;\n  }\n\n  getNames() {\n    return Object.keys(this._names);\n  }\n\n  getIDs() {\n    return Object.values(this._names);\n  }\n\n  getDetails() {\n    return this._names;\n  }\n\n  canAdd(item) {\n    return item instanceof Project || item._isAProjectObject;\n  }\n\n  add(project) {\n    if (!this.canAdd(project)) {\n      return null;\n    }\n\n    let existing = null;\n\n    try {\n      existing = this.getByName(project.getName());\n    } catch (error) {\n      console.error(\"Cannot get project\", error);\n    }\n\n    if (existing) {\n      existing = existing.merge(project);\n      this.state.registry[existing.getID()] = existing;\n      return existing;\n    }\n\n    project = Project.clone(project);\n\n    let id = project.getID();\n\n    if (id) {\n      if (id in this.state.registry) {\n        throw new KeyError(`Duplicate Project ID ${project}`);\n      }\n\n      project._updateHooks(this._getHook);\n      this.state.registry[id] = project;\n    } else {\n      let uid = _generate_project_uid();\n\n      while (uid in this.state.registry) {\n        uid = _generate_project_uid();\n      }\n\n      project.state.id = uid;\n    }\n\n    project._updateHooks(this._getHook);\n    this._names[project.getName()] = project.getID();\n    this.state.registry[project.getID()] = project;\n\n    return project;\n  }\n\n  getByName(name) {\n    let id = this._names[name];\n\n    if (id) {\n      return this.get(id);\n    } else {\n      throw new MissingError(`No project with name ${name}`);\n    }\n  }\n\n  find(name) {\n    if (name instanceof Project || name._isAProjectObject) {\n      return this.get(name.getID());\n    }\n\n    name = name.trim().toLowerCase();\n\n    let results = [];\n\n    Object.keys(this._names).forEach((key) => {\n      if (key.toLowerCase().indexOf(name) !== -1) {\n        results.push(this.get(this._names[key]));\n      }\n    });\n\n    if (results.length === 1) {\n      return results[0];\n    } else if (results.length > 1) {\n      return results;\n    }\n\n    let keys = Object.keys(this._names).join(\"', '\");\n\n    throw new MissingError(`No project matches '${name}. Available projects are '${keys}'`);\n  }\n\n  get(id) {\n    let project = this.state.registry[id];\n\n    if (!project) {\n      throw new MissingError(`No Project with ID ${id}`);\n    }\n\n    return project;\n  }\n\n  getTimeLine() {\n    let items = [];\n\n    Object.keys(this.state.registry).forEach((key) => {\n      let project = this.state.registry[key];\n      if (project) {\n        let timeline = project.getTimeLine();\n        if (timeline) {\n          items.push(timeline);\n        }\n      }\n    });\n\n    return items;\n  }\n\n  toDry() {\n    return { value: this.state };\n  }\n}\n\nProjects.unDry = function (value) {\n  let projects = new Projects();\n  projects.state = value;\n  projects._names = {};\n\n  Object.keys(value.registry).forEach((key) => {\n    let v = value.registry[key];\n    projects._names[v.getName()] = key;\n  });\n\n  return projects;\n};\n\nDry.registerClass(\"Projects\", Projects);\n\nexport default Projects;\n","import Dry from \"json-dry\";\nimport lodash from \"lodash\";\n\nclass Biographies {\n  constructor() {\n    this.state = {\n      bios: {},\n    };\n\n    this._getHook = null;\n    this._isABiographiesObject = true;\n  }\n\n  _updateHooks(hook) {\n    this._getHook = hook;\n  }\n\n  static clone(item) {\n    let c = new Biographies();\n    c.state = lodash.cloneDeep(item.state);\n    c._getHook = item._getHook;\n    return c;\n  }\n\n  get(node) {\n    if (!node) {\n      return null;\n    } else if (node.getID) {\n      node = node.getID();\n    }\n\n    return this.state.bios[node];\n  }\n\n  getByID(id) {\n    if (!id) return null;\n\n    return this.state.bios[id];\n  }\n\n  getNode(id) {\n    if (this._getHook) {\n      return this._getHook(id);\n    } else {\n      return id;\n    }\n  }\n\n  search(text) {\n    if (!text) {\n      return null;\n    }\n\n    text = text.trim().toLowerCase();\n\n    let results = [];\n\n    Object.keys(this.state.bios).forEach((key) => {\n      if (this.state.bios[key].toLowerCase().indexOf(text) !== -1) {\n        results.push(this.getNode(key));\n      }\n    });\n\n    if (results.length === 1) {\n      return results[0];\n    } else if (results.length > 1) {\n      return results;\n    } else {\n      return null;\n    }\n  }\n\n  add(node, biography) {\n    if (!node || !biography) {\n      return null;\n    } else if (node.getID) {\n      node = node.getID();\n    }\n\n    let bio = this.state.bios[node];\n\n    if (bio) {\n      console.log(`There is already a bio for ${this.getNode(node)}`);\n      biography = `${bio}\\n${biography}`;\n    }\n\n    this.state.bios[node] = biography;\n  }\n}\n\nBiographies.unDry = function (value) {\n  let bios = new Biographies();\n  bios.state = value;\n  return bios;\n};\n\nDry.registerClass(\"Biographies\", Biographies);\n\nexport default Biographies;\n","import Dry from \"json-dry\";\nimport lodash from \"lodash\";\n\nimport People from \"./People\";\nimport Businesses from \"./Businesses\";\nimport Connections from \"./Connections\";\nimport Positions from \"./Positions\";\nimport Affiliations from \"./Affiliations\";\nimport Sources from \"./Sources\";\nimport Notes from \"./Notes\";\nimport Projects from \"./Projects\";\nimport Biographies from \"./Biographies\";\nimport DateRange from \"./DateRange\";\n\nimport { ValueError } from \"./Errors\";\n\nconst fast_physics = {\n  enabled: true,\n  timestep: 0.5,\n};\n\nconst slow_physics = { ...fast_physics };\nslow_physics.timestep = 0.1;\n\nfunction _push(values, list) {\n  if (!list) {\n    return;\n  }\n\n  if (values.length) {\n    for (let i = 0; i < values.length; ++i) {\n      list.push(values[i]);\n    }\n  } else {\n    list.push(values);\n  }\n}\n\nclass Social {\n  constructor(props) {\n    if (props) {\n      this.state = props;\n    } else {\n      this.state = {};\n    }\n\n    this.state.anchor = null;\n    this.state.filter = {};\n    this.state.cache = {\n      graph: null,\n      projectTimeLine: null,\n      itemTimeLine: null,\n      node_filters: null,\n      edge_filters: null,\n      people: null,\n      businesses: null,\n      connections: null,\n    };\n    this.state.window = new DateRange();\n    this.state.max_window = new DateRange();\n    this._rebuilding = 0;\n\n    this._isASocialObject = true;\n  }\n\n  static clone(item) {\n    let c = new Social();\n    c.state = lodash.cloneDeep(item.state);\n    return c;\n  }\n\n  _updateHooks() {\n    let getHook = (id) => {\n      return this.get(id);\n    };\n\n    let state = { ...this.state };\n\n    if (!(this.state.people instanceof People)) {\n      state.people = new People();\n    } else {\n      state.people = this.state.people;\n    }\n\n    if (!(this.state.businesses instanceof Businesses)) {\n      state.businesses = new Businesses();\n    } else {\n      state.businesses = this.state.businesses;\n    }\n\n    if (!(this.state.connections instanceof Connections)) {\n      state.connections = new Connections();\n    } else {\n      state.connections = this.state.connections;\n    }\n\n    if (!(this.state.positions instanceof Positions)) {\n      state.positions = new Positions();\n    } else {\n      state.positions = this.state.positions;\n    }\n\n    if (!(this.state.affiliations instanceof Affiliations)) {\n      state.affiliations = new Affiliations();\n    } else {\n      state.affiliations = this.state.affiliations;\n    }\n\n    if (!(this.state.sources instanceof Sources)) {\n      state.sources = new Sources();\n    } else {\n      state.sources = this.state.sources;\n    }\n\n    if (!(this.state.notes instanceof Notes)) {\n      state.notes = new Notes();\n    } else {\n      state.notes = this.state.notes;\n    }\n\n    if (!(this.state.projects instanceof Projects)) {\n      state.projects = new Projects();\n    } else {\n      state.projects = this.state.projects;\n    }\n\n    if (!(this.state.biographies instanceof Biographies)) {\n      state.biographies = new Biographies();\n    } else {\n      state.biographies = this.state.biographies;\n    }\n\n    this.state = state;\n\n    for (let key in this.state) {\n      try {\n        this.state[key]._updateHooks(getHook);\n      } catch (error) {\n        console.error(\"For key : \", key, \"\\nError: \", error);\n      }\n    }\n  }\n\n  clearCache() {\n    this.state.cache = {\n      graph: null,\n      projectTimeLine: null,\n      itemTimeLine: null,\n      node_filters: null,\n      edge_filters: null,\n      people: null,\n      businesses: null,\n      connections: null,\n    };\n    this._rebuilding = 0;\n  }\n\n  getNodeFilters() {\n    if (this.state.cache.node_filters) {\n      return this.state.cache.node_filters;\n    }\n\n    this._rebuilding += 1;\n    this.state.cache.node_filters = [];\n\n    // Must do time first, as this can affect all of the other filters!\n    let window = this.getWindow();\n\n    if (window.hasStart() || window.hasEnd()) {\n      this.state.cache.node_filters.push((item) => {\n        try {\n          return item.filterWindow(window);\n        } catch (error) {\n          console.log(`ERROR ${error}: ${item}`);\n          return item;\n        }\n      });\n    }\n\n    const project_filter = this.state.filter.project;\n\n    if (project_filter) {\n      this.state.cache.node_filters.push((item) => {\n        return item.filterProject(project_filter);\n      });\n    }\n\n    const source_filter = this.state.filter.source;\n\n    if (source_filter) {\n      this.state.cache.node_filters.push((item) => {\n        return item.filterSource(source_filter);\n      });\n    }\n\n    const node_filter = this.state.filter.node;\n\n    if (node_filter) {\n      let connections = this.getConnectionsTo(node_filter);\n      let filter = { ...node_filter };\n\n      for (let connection in connections) {\n        let node = connections[connection];\n        filter[node.getID()] = 1;\n      }\n\n      this.state.cache.node_filters.push((item) => {\n        if (item.getID() in filter) {\n          return item;\n        } else {\n          return null;\n        }\n      });\n    }\n\n    const group_filter = this.state.filter.group;\n\n    if (group_filter) {\n      this.state.cache.node_filters.push((item) => {\n        try {\n          if (item.inGroup(group_filter)) {\n            return item;\n          } else {\n            return null;\n          }\n        } catch (error) {\n          console.log(`Filter error: ${error}`);\n          return item;\n        }\n      });\n    }\n\n    this._rebuilding -= 1;\n    return this.state.cache.node_filters;\n  }\n\n  getEdgeFilters() {\n    if (!this.state.cache.edge_filters) {\n      this.state.cache.edge_filters = [];\n\n      // must do time first, as this can affect all of the other filters!\n      let window = this.getWindow();\n\n      if (window.hasStart() || window.hasEnd()) {\n        this.state.cache.edge_filters.push((item) => {\n          try {\n            return item.filterWindow(window);\n          } catch (error) {\n            console.log(`ERROR ${error}: ${item}`);\n            return item;\n          }\n        });\n      }\n\n      const project_filter = this.state.filter.project;\n\n      if (project_filter) {\n        this.state.cache.edge_filters.push((item) => {\n          try {\n            return item.filterProject(project_filter);\n          } catch (error) {\n            console.log(`ERROR ${error}: ${item}`);\n            return item;\n          }\n        });\n      }\n\n      const source_filter = this.state.filter.source;\n\n      if (source_filter) {\n        this.state.cache.edge_filters.push((item) => {\n          try {\n            return item.filterSource(source_filter);\n          } catch (error) {\n            console.log(`ERROR ${error}: ${item}`);\n            return item;\n          }\n        });\n      }\n    }\n\n    return this.state.cache.edge_filters;\n  }\n\n  getWindow() {\n    return this.state.window;\n  }\n\n  getMaxWindow() {\n    return this.state.max_window;\n  }\n\n  _fitWindow(window) {\n    let new_window = this.state.max_window.intersect(window);\n\n    let delta = window.getDelta();\n\n    if (new_window && new_window.getDelta() === delta) {\n      return window;\n    }\n\n    if (delta > this.state.max_window.getDelta()) {\n      return DateRange.clone(this.state.max_window);\n    }\n\n    if (window.getStartDate() < this.state.max_window.getStartDate()) {\n      return new DateRange({\n        start: this.state.max_window.getStartDate(),\n        end: this.state.max_window.getStartDate() + delta,\n      });\n    } else {\n      return new DateRange({\n        start: this.state.max_window.getEndDate() - delta,\n        end: this.state.max_window.getEndDate(),\n      });\n    }\n  }\n\n  setMaxWindow(window) {\n    if (!window._isADateRangeObject) {\n      window = new DateRange(window);\n    }\n\n    if (window === this.state.max_window) {\n      return;\n    }\n\n    this.state.max_window = window;\n\n    if (this.state.window && this.state.window.hasBounds()) {\n      let fitted = this._fitWindow(this.state.window);\n\n      if (fitted !== this.state.window) {\n        this.setWindow(fitted);\n      }\n    } else {\n      this.state.window = this.state.max_window;\n    }\n  }\n\n  setWindow(window) {\n    if (!window._isADateRangeObject) {\n      window = new DateRange(window);\n    }\n\n    if (DateRange.eq(window, this.state.window)) {\n      return false;\n    }\n\n    let fitted = this._fitWindow(window);\n\n    if (DateRange.eq(fitted, this.state.window)) {\n      return false;\n    }\n\n    this.state.window = fitted;\n    this.clearCache();\n    return true;\n  }\n\n  getPeople(filtered = true) {\n    if (this._rebuilding) {\n      filtered = false;\n    }\n\n    if (filtered) {\n      if (!this.state.cache.people) {\n        console.log(\"REBUILD PEOPLE\");\n        this._rebuilding += 1;\n        this.state.cache.people = this.state.people.filter(this.getNodeFilters());\n        this._rebuilding -= 1;\n      }\n\n      return this.state.cache.people;\n    } else {\n      return this.state.people;\n    }\n  }\n\n  getBusinesses(filtered = true) {\n    if (this._rebuilding) {\n      filtered = false;\n    }\n\n    if (filtered) {\n      if (!this.state.cache.businesses) {\n        console.log(\"REBUILD BUSINESSES\");\n        this._rebuilding += 1;\n        this.state.cache.businesses = this.state.businesses.filter(this.getNodeFilters());\n        this._rebuilding -= 1;\n      }\n\n      return this.state.cache.businesses;\n    } else {\n      return this.state.businesses;\n    }\n  }\n\n  getConnections(filtered = true) {\n    if (this._rebuilding) {\n      filtered = false;\n    }\n\n    if (filtered) {\n      if (!this.state.cache.connections) {\n        console.log(\"REBUILD CONNECTIONS\");\n        this._rebuilding += 1;\n        this.state.cache.connections = this.state.connections.filter(this.getEdgeFilters());\n        this._rebuilding -= 1;\n      }\n\n      return this.state.cache.connections;\n    } else {\n      return this.state.connections;\n    }\n  }\n\n  getBiographies() {\n    return this.state.biographies;\n  }\n\n  getAffiliations() {\n    return this.state.affiliations;\n  }\n\n  getPositions() {\n    return this.state.positions;\n  }\n\n  getSources() {\n    return this.state.sources;\n  }\n\n  getNotes() {\n    return this.state.notes;\n  }\n\n  getProjects() {\n    return this.state.projects;\n  }\n\n  getConnectionsTo(item) {\n    return this.getConnections().getConnectionsTo(item);\n  }\n\n  getAnchor() {\n    return this.state.anchor;\n  }\n\n  getFilter() {\n    return { ...this.state.filter };\n  }\n\n  getFilterText() {\n    const filter = [];\n\n    let f = this.state.filter.node;\n\n    if (f) {\n      let parts = [];\n\n      Object.keys(f).forEach((key) => {\n        parts.push(this.get(key, false).getName());\n      });\n\n      parts.sort();\n\n      if (parts.length === 1) {\n        filter.push(`connected to ${parts[0]}`);\n      } else if (parts.length > 1) {\n        filter.push(`connected to (${parts.join(\" and \")})`);\n      }\n    }\n\n    f = this.state.filter.source;\n\n    if (f) {\n      let parts = [];\n\n      Object.keys(f).forEach((key) => {\n        parts.push(this.get(key, false).getName());\n      });\n\n      parts.sort();\n\n      if (parts.length === 1) {\n        filter.push(`with source ${parts[0]}`);\n      } else if (parts.length > 1) {\n        filter.push(`with sources (${parts.join(\" and \")})`);\n      }\n    }\n\n    f = this.state.filter.group;\n\n    if (f) {\n      let parts = [];\n\n      Object.keys(f).forEach((key) => {\n        parts.push(this.get(key, false).getName());\n      });\n\n      parts.sort();\n\n      if (parts.length === 1) {\n        filter.push(`in group ${parts[0]}`);\n      } else if (parts.length > 1) {\n        filter.push(`in groups (${parts.join(\" and \")})`);\n      }\n    }\n\n    f = this.state.filter.project;\n\n    if (f) {\n      let parts = [];\n\n      Object.keys(f).forEach((key) => {\n        parts.push(this.get(key, false).getName());\n      });\n\n      parts.sort();\n\n      if (parts.length === 1) {\n        filter.push(`in project ${parts[0]}`);\n      } else if (parts.length > 1) {\n        filter.push(`in projects (${parts.join(\" and \")})`);\n      }\n    }\n\n    if (filter.length === 1) {\n      return filter[0];\n    } else if (filter.length > 1) {\n      return `[${filter.join(\"] and [\")}]`;\n    } else {\n      return null;\n    }\n  }\n\n  _getType(item) {\n    if (item.getID) {\n      item = item.getID();\n    }\n\n    if (item[0] === \"P\" || item[0] === \"B\") {\n      return \"node\";\n    } else if (item[0] === \"J\") {\n      return \"project\";\n    } else if (item[0] === \"S\") {\n      return \"source\";\n    } else {\n      return \"group\";\n    }\n  }\n\n  isFiltered(item) {\n    if (item.getID) {\n      item = item.getID();\n    }\n\n    let type = this._getType(item);\n\n    const filter = this.state.filter[type];\n\n    if (filter) {\n      return item in filter;\n    } else {\n      return false;\n    }\n  }\n\n  find(text) {\n    let result = [];\n\n    try {\n      let items = this.getPeople(false).find(text);\n      _push(items, result);\n    } catch (error) {\n      console.error(error);\n    }\n\n    try {\n      let items = this.getBusinesses(false).find(text);\n      _push(items, result);\n    } catch (error) {\n      console.error(error);\n    }\n\n    try {\n      let items = this.getPositions().find(text);\n      _push(items, result);\n    } catch (error) {\n      console.error(error);\n    }\n\n    try {\n      let items = this.getAffiliations().find(text);\n      _push(items, result);\n    } catch (error) {\n      console.error(error);\n    }\n\n    try {\n      let items = this.getSources().search(text);\n      _push(items, result);\n    } catch (error) {\n      console.error(error);\n    }\n\n    try {\n      let items = this.getBiographies().search(text);\n      _push(items, result);\n    } catch (error) {\n      console.error(error);\n    }\n\n    return result;\n  }\n\n  resetFilters() {\n    this.state.filter = {};\n    this.clearCache();\n  }\n\n  setAnchor(anchor) {\n    if (anchor) {\n      anchor = this.getPeople().find(anchor);\n    }\n\n    this.state.anchor = anchor;\n    this.clearCache();\n  }\n\n  toggleFilter(item) {\n    if (item.getID) {\n      item = item.getID();\n    }\n\n    let type = this._getType(item);\n\n    if (!(type in this.state.filter)) {\n      this.state.filter[type] = {};\n    }\n\n    if (item in this.state.filter[type]) {\n      delete this.state.filter[type][item];\n\n      if (Object.keys(this.state.filter[type]).length === 0) {\n        delete this.state.filter[type];\n      }\n    } else {\n      this.state.filter[type][item] = 1;\n    }\n\n    this.clearCache();\n  }\n\n  getProjectTimeLine() {\n    if (this.state.cache.projectTimeLine !== null) {\n      return this.state.cache.projectTimeLine;\n    }\n\n    let items = this.getProjects().getTimeLine();\n\n    this.state.cache.projectTimeLine = items;\n\n    return this.state.cache.projectTimeLine;\n  }\n\n  getItemTimeLine() {\n    if (this.state.cache.itemTimeLine !== null) {\n      return this.state.cache.itemTimeLine;\n    }\n\n    let items = this.getPeople().getTimeLine();\n\n    let projects = this.getProjects().getTimeLine();\n\n    projects.forEach((item) => {\n      item.type = \"background\";\n      items.push(item);\n    });\n\n    this.state.cache.itemTimeLine = items;\n\n    return this.state.cache.itemTimeLine;\n  }\n\n  getGraph() {\n    if (this.state.cache.graph !== null) {\n      return this.state.cache.graph;\n    }\n\n    const anchor = this.state.anchor;\n    let nodes = this.getPeople().getNodes({ anchor: anchor });\n    nodes = nodes.concat(this.getBusinesses().getNodes());\n\n    let n = {};\n    for (let i in nodes) {\n      n[nodes[i].id] = 1;\n    }\n\n    let edges = this.getConnections().getEdges(n);\n\n    this.state.cache.graph = { nodes: nodes, edges: edges };\n    return this.state.cache.graph;\n  }\n\n  add(item) {\n    if (!item) {\n      return;\n    }\n\n    let added = false;\n\n    Object.keys(this.state).forEach((key) => {\n      if (!added) {\n        let group = this.state[key];\n        if (group && group.canAdd) {\n          if (group.canAdd(item)) {\n            group.add(item);\n            added = true;\n          }\n        }\n      }\n    });\n\n    if (!added) {\n      throw new ValueError(`Do not know how to add ${item} to this Social group`);\n    }\n  }\n\n  get(id, filtered = true) {\n    if (id.getID) {\n      id = id.getID();\n    }\n\n    if (this._rebuilding) {\n      // we cannot get filtered data when rebuilding, else otherwise\n      // we get race conditions and weird results\n      filtered = false;\n    }\n\n    try {\n      if (id[0] === \"C\") {\n        return this.getConnections(filtered).get(id);\n      } else if (id[0] === \"P\") {\n        return this.getPeople(filtered).get(id);\n      } else if (id[0] === \"B\") {\n        return this.getBusinesses(filtered).get(id);\n      } else if (id[0] === \"Q\") {\n        return this.getPositions().get(id);\n      } else if (id[0] === \"A\") {\n        return this.getAffiliations().get(id);\n      } else if (id[0] === \"S\") {\n        return this.getSources().get(id);\n      } else if (id[0] === \"N\") {\n        return this.getNotes().get(id);\n      } else if (id[0] === \"J\") {\n        return this.getProjects().get(id);\n      } else {\n        return id;\n      }\n    } catch (error) {\n      if (filtered) {\n        return this.get(id, false);\n      } else {\n        throw error;\n      }\n    }\n  }\n\n  toDry() {\n    return { value: this.state };\n  }\n}\n\nSocial.unDry = function (value) {\n  let social = new Social(value);\n  social._updateHooks();\n\n  return social;\n};\n\nDry.registerClass(\"Social\", Social);\n\nexport default Social;\n","import React from \"react\";\n\nimport { Tabs, Tab, TabPanel, TabList } from \"react-web-tabs\";\n\nimport { Accordion, AccordionItem, AccordionTitle, AccordionPanel } from \"./Accordion\";\n\nimport GroupsList from \"./GroupsList\";\nimport ConnectionList from \"./ConnectionList\";\nimport SourceList from \"./SourceList\";\nimport WeightsList from \"./WeightsList\";\nimport DateRangeButton from \"./DateRangeButton\";\nimport DefaultButton from \"./DefaultButton\";\n\nimport Social from \"../model/Social\";\n\nimport styles from \"./InfoBox.module.css\";\n\nimport default_image from \"../images/RHowlett_IKB.jpg\";\nimport person_image from \"../images/IllustriteZeitung_SS_GreatBritain.png\";\nimport business_image from \"../images/320px-SS_Great_Britain_diagram.jpg\";\nimport source_image from \"../images/Sumerian_26th_c_Adab.jpg\";\nimport analysis_image from \"../images/320px-SS_Great_Britain_transverse_section.jpg\";\n\nlet default_title = \"Isambard's Social Network\";\n\nlet default_text = (\n  <div>\n    This is an interactive viewer of Isambard Kingdom Brunel&apos;s social network. Please click in the nodes and have\n    fun!\n  </div>\n);\n\nfunction null_function() {}\n\nfunction getBiography({ item, social, emitSelected = null_function, emitToggleFilter = null_function }) {\n  let pages = [];\n  let affiliations = {};\n  let positions = {};\n  let sources = {};\n  let connections = [];\n\n  try {\n    connections = social.getConnectionsTo(item);\n  } catch (error) {\n    console.log(`CONNECTIONS ERROR ${error}`);\n  }\n\n  if (item.getAffiliations) {\n    affiliations = item.getAffiliations();\n  }\n\n  if (item.getPositions) {\n    positions = item.getPositions();\n  }\n\n  if (item.getSources) {\n    sources = item.getSources();\n  }\n\n  let alive = null;\n\n  if (item.getAlive) {\n    let a = item.getAlive();\n    if (a) {\n      alive = (\n        <p>\n          They were alive from&nbsp;\n          {a.getStartString()}&nbsp; until {a.getEndString()}.\n        </p>\n      );\n    }\n  }\n\n  let bio = null;\n\n  try {\n    bio = social.getBiographies().get(item);\n  } catch (error) {\n    bio = null;\n  }\n\n  pages.push([\n    \"Biography\",\n    <div key=\"biography\">\n      <div>{bio}</div>\n      <div>{alive}</div>\n    </div>,\n  ]);\n\n  if (connections.length > 0) {\n    pages.push([\n      \"Connections\",\n      <div key=\"connections\">\n        <ConnectionList\n          connections={connections}\n          emitSelected={emitSelected}\n          emitToggleFilter={emitToggleFilter}\n          social={social}\n        />\n      </div>,\n    ]);\n  } else {\n    pages.push([\"Connections\", \"None\"]);\n  }\n\n  if (Object.keys(positions).length > 0) {\n    pages.push([\n      \"Positions\",\n      <div key=\"positions\">\n        <GroupsList\n          groups={positions}\n          emitSelected={emitSelected}\n          emitToggleFilter={emitToggleFilter}\n          social={social}\n        />\n      </div>,\n    ]);\n  } else {\n    pages.push([\"Positions\", \"None\"]);\n  }\n\n  if (Object.keys(affiliations).length > 0) {\n    pages.push([\n      \"Affiliations\",\n      <div key=\"affiliations\">\n        <GroupsList\n          groups={affiliations}\n          emitSelected={emitSelected}\n          emitToggleFilter={emitToggleFilter}\n          social={social}\n        />\n      </div>,\n    ]);\n  } else {\n    pages.push([\"Affiliations\", \"None\"]);\n  }\n\n  if (Object.keys(sources).length > 0) {\n    pages.push([\n      \"Sources\",\n      <div key=\"sources\">\n        <GroupsList groups={sources} emitSelected={emitSelected} emitToggleFilter={emitToggleFilter} social={social} />\n      </div>,\n    ]);\n  }\n\n  pages.push([\"Analysis\", <div key=\"analysis\">Here is space for graphs and analysis of {item.getName()}</div>]);\n\n  return pages;\n}\n\nfunction extractData({ item, social, emitSelected = null_function, emitToggleFilter = null_function }) {\n  let data = {\n    title: default_title,\n    image: default_image,\n    pages: [[\"Title\", default_text]],\n  };\n\n  if (!(social instanceof Social)) {\n    return data;\n  }\n\n  if (!item) {\n    return data;\n  }\n\n  //refresh the item in case of updates...\n  if (item.getID) {\n    item = item.getID();\n  }\n\n  try {\n    item = social.get(item);\n  } catch (error) {\n    item = null;\n  }\n\n  if (!item) {\n    return data;\n  }\n\n  if (item._isAPersonObject) {\n    data.title = (\n      <DefaultButton\n        onClick={() => {\n          emitToggleFilter(item);\n        }}\n      >\n        {item.getName()}\n      </DefaultButton>\n    );\n    data.pages = getBiography({\n      item: item,\n      social: social,\n      emitSelected: emitSelected,\n      emitToggleFilter: emitToggleFilter,\n    });\n\n    data.image = person_image;\n  } else if (item._isABusinessObject) {\n    data.title = (\n      <DefaultButton\n        onClick={() => {\n          emitToggleFilter(item);\n        }}\n      >\n        {item.getName()}\n      </DefaultButton>\n    );\n    data.pages = getBiography({\n      item: item,\n      social: social,\n      emitSelected: emitSelected,\n      emitToggleFilter: emitToggleFilter,\n    });\n\n    data.image = business_image;\n  } else if (item._isASourceObject) {\n    data.title = item.getName();\n    let description = item.getDescription();\n    if (!description) {\n      description = \"No description\";\n    }\n    data.pages = [\n      [\"Description\", description],\n      [\"Analysis\", \"Analysis for this source - where else has it been cited?\"],\n    ];\n    data.image = source_image;\n  } else if (item._isAConnectionObject) {\n    data.title = null;\n\n    let n0 = item.getNode0();\n    if (n0.getName) {\n      let node = n0;\n      n0 = (\n        <DefaultButton\n          onClick={() => {\n            emitSelected(node);\n          }}\n        >\n          {n0.getName()}\n        </DefaultButton>\n      );\n    }\n\n    let n1 = item.getNode1();\n    if (n1.getName) {\n      let node = n1;\n      n1 = (\n        <DefaultButton\n          onClick={() => {\n            emitSelected(node);\n          }}\n        >\n          {n1.getName()}\n        </DefaultButton>\n      );\n    }\n\n    let asources = item.getAffiliationSources();\n    let csources = item.getCorrespondanceSources();\n    let duration = item.getDuration();\n\n    if (duration) {\n      duration = (\n        <div>\n          <div>during</div>\n          <DateRangeButton value={duration} emitSelected={emitSelected} />\n        </div>\n      );\n    }\n\n    if (asources) {\n      asources = (\n        <AccordionItem uuid=\"asources\">\n          <AccordionTitle>Affiliation</AccordionTitle>\n          <AccordionPanel>\n            <SourceList social={social} sources={asources} emitSelected={emitSelected} />\n          </AccordionPanel>\n        </AccordionItem>\n      );\n    }\n\n    if (csources) {\n      csources = (\n        <AccordionItem uuid=\"csources\">\n          <AccordionTitle>Correspondance</AccordionTitle>\n          <AccordionPanel>\n            <SourceList social={social} sources={csources} emitSelected={emitSelected} />\n          </AccordionPanel>\n        </AccordionItem>\n      );\n    }\n\n    let accordion = null;\n\n    if (asources || csources) {\n      accordion = (\n        <Accordion allowMultipleExpanded={true} allowZeroExpanded={true} preExpanded={[\"asources\", \"csources\"]}>\n          {asources}\n          {csources}\n        </Accordion>\n      );\n    }\n\n    let pages = [];\n    pages.push([\n      \"Connection\",\n      <div key=\"connection\" style={{ textAlign: \"center\" }}>\n        {n0}\n        <div>||</div>\n        {n1}\n        <div>&nbsp;</div>\n        <div>{duration}</div>\n      </div>,\n    ]);\n\n    pages.push([\"Sources\", <div key=\"sources\">{accordion}</div>]);\n\n    pages.push([\n      \"Projects\",\n      <WeightsList\n        key=\"projects\"\n        weights={item.getWeights()}\n        type={item.getType()}\n        social={social}\n        emitSelected={emitSelected}\n        emitToggleFilter={emitToggleFilter}\n      />,\n    ]);\n\n    pages.push([\"Analysis\", \"Space for analysis of this Connection\"]);\n\n    data.image = analysis_image;\n\n    data.pages = pages;\n  }\n\n  return data;\n}\n\nfunction InfoBox(props) {\n  let data = {};\n\n  try {\n    data = extractData(props);\n  } catch (error) {\n    data = {\n      title: default_title,\n      image: default_image,\n      pages: [[\"Title\", default_text]],\n    };\n    console.log(`ERROR ${error}`);\n  }\n\n  const pages = data.pages;\n\n  if (pages.length > 1) {\n    let tabs = [];\n    let panes = [];\n\n    for (let i = 0; i < pages.length; ++i) {\n      panes.push(\n        <TabPanel key={pages[i][0]} tabId={pages[i][0]} className={styles.tabPanel}>\n          {pages[i][1]}\n        </TabPanel>\n      );\n      tabs.push(\n        <Tab key={pages[i][0]} className={styles.tab} tabFor={pages[i][0]}>\n          {pages[i][0]}\n        </Tab>\n      );\n    }\n\n    return (\n      <div className={styles.container}>\n        <img className={styles.heroImage} alt=\"\" src={data.image} />\n        <div className={styles.title}>{data.title}</div>\n        <Tabs\n          key={panes.length}\n          vertical\n          onChange={(tabId) => {\n            console.log(tabId);\n          }}\n          defaultTab={pages[0][0]}\n          className={styles.tabs}\n        >\n          <TabList className={styles.tablist}>{tabs}</TabList>\n          {panes}\n        </Tabs>\n      </div>\n    );\n  } else {\n    return (\n      <div className={styles.container}>\n        <img className={styles.heroImage} alt=\"\" src={data.image} />\n        <div className={styles.title}>{data.title}</div>\n        {pages[0][1]}\n      </div>\n    );\n  }\n}\n\nexport default InfoBox;\n","import PropTypes from \"prop-types\";\nimport React from \"react\";\nimport moment from \"moment\";\n\nimport Timeline, { TimelineHeaders, CustomHeader } from \"react-calendar-timeline\";\n\nimport \"./TimelineCSSOverride.css\";\n\nclass NewTimeline extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.setFilter = this.setFilter.bind(this);\n    this.itemRenderer = this.itemRenderer.bind(this);\n\n    this.state = {\n      defaultTimeStart: moment(\"1829-01-01\"),\n      defaultTimeEnd: moment(\"1846-12-31\"),\n      lastShip: null,\n    };\n\n    this.textStyle = {\n      overflow: \"hidden\",\n      paddingLeft: 3,\n      textOverflow: \"ellipsis\",\n      whiteSpace: \"nowrap\",\n    };\n\n    this.dateHeaderStyle = {\n      color: \"black\",\n      fontSize: \"16px\",\n      backgroundColor: \"#E8CEAA\",\n      //   backgroundColor: \"#E3D8A0\",\n      fontFamily: \"Playfair Display SC\",\n      border: \"white\",\n    };\n  }\n\n  setFilter(id, shipName) {\n    if (shipName === this.state.lastShip) {\n      this.props.resetFilters();\n      // Allows the ship to be selected again\n      this.setState({ lastShip: \"\" });\n      return;\n    }\n\n    this.setState({ lastShip: shipName });\n    this.props.onClick(id, shipName);\n  }\n\n  openOverview() {\n    return;\n  }\n\n  itemRenderer({ item, itemContext, getItemProps }) {\n    const background = itemContext.selected ? \"#3F592F\" : \"#003366\";\n    const border = itemContext.resizing ? \"#3F592F\" : \"#003366\";\n\n    return (\n      <div\n        {...getItemProps({\n          style: {\n            background,\n            border,\n            borderStyle: \"solid\",\n            fontSize: \"18px\",\n            fontFamily: \"Playfair Display SC\",\n            borderWidth: 0,\n          },\n          onMouseDown: () => {\n            this.setFilter(item[\"project_id\"], item[\"title\"]);\n          },\n        })}\n      >\n        <div style={this.textStyle}>{itemContext.title}</div>\n      </div>\n    );\n  }\n\n  render() {\n    const projects = this.props.projects;\n\n    const timeline_items = projects.values().map((project, index) => {\n      let item = project.getNewTimeLine();\n\n      item[\"id\"] = index;\n      item[\"group\"] = 1;\n\n      return item;\n    });\n\n    const groups = [{ id: 1, title: \"Projects\" }];\n\n    return (\n      <Timeline\n        groups={groups}\n        items={timeline_items}\n        sidebarWidth={0}\n        itemTouchSendsClick={true}\n        stackItems\n        lineHeight={60}\n        itemHeightRatio={0.8}\n        showCursorLine\n        canMove={false}\n        canResize={false}\n        traditionalZoom={true}\n        timeSteps={{ year: 1 }}\n        itemRenderer={this.itemRenderer}\n        defaultTimeStart={this.state.defaultTimeStart}\n        defaultTimeEnd={this.state.defaultTimeEnd}\n      >\n        <TimelineHeaders>\n          {/* <DateHeader unit=\"primaryHeader\" style={this.dateHeaderStyle} /> */}\n          <CustomHeader height={30} unit=\"year\">\n            {({ headerContext: { intervals }, getRootProps, getIntervalProps }) => {\n              console.log(getIntervalProps);\n              return (\n                <div {...getRootProps()}>\n                  {intervals.map((interval, index) => {\n                    const intervalStyle = {\n                      lineHeight: \"30px\",\n                      textAlign: \"center\",\n                      borderLeft: \"1px solid white\",\n                      cursor: \"pointer\",\n                      backgroundColor: \"#E9CEAB\",\n                      color: \"black\",\n                      fontFamily: \"Playfair Display SC\",\n                    };\n                    return (\n                      <div\n                        key={index}\n                        {...getIntervalProps({\n                          interval,\n                          style: intervalStyle,\n                        })}\n                      >\n                        <div className=\"sticky\">{interval.startTime.format(\"YYYY\")}</div>\n                      </div>\n                    );\n                  })}\n                </div>\n              );\n            }}\n          </CustomHeader>\n        </TimelineHeaders>\n      </Timeline>\n    );\n  }\n}\n\nNewTimeline.propTypes = {\n  projects: PropTypes.func.isRequired,\n  onClick: PropTypes.func.isRequired,\n  resetFilters: PropTypes.func.isRequired,\n};\n\nexport default NewTimeline;\n","import PropTypes from \"prop-types\";\nimport React, { Component } from \"react\";\nimport { Tabs, Tab, TabPanel, TabList } from \"react-web-tabs\";\n\nimport NewTimeline from \"./NewTimeline\";\n\nimport styles from \"./TimeLineBox.module.css\";\n\nclass TimeLineBox extends Component {\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      dimensions: { height: 300, width: 600 },\n    };\n\n    this.tabs = {};\n    this.container = null;\n  }\n\n  componentDidMount() {\n    window.addEventListener(\"resize\", () => {\n      this.updateSize();\n    });\n    this.updateSize();\n  }\n\n  componentWillUnmount() {\n    window.removeEventListener(\"resize\", () => {\n      this.updateSize();\n    });\n  }\n\n  activate(tabId) {\n    Object.keys(this.tabs).forEach((key) => {\n      if (key !== tabId) {\n        let tab = this.tabs[key];\n        if (tab) {\n          tab.deactivate();\n        }\n      }\n    });\n\n    if (this.tabs[tabId]) {\n      this.tabs[tabId].activate();\n    }\n  }\n\n  updateSize() {\n    if (this.container) {\n      this.setState({\n        dimensions: {\n          width: this.container.offsetWidth,\n          height: this.container.offsetHeight,\n        },\n      });\n    }\n\n    Object.keys(this.tabs).forEach((key) => {\n      let tab = this.tabs[key];\n      if (tab) {\n        tab.updateSize(this.state.dimensions);\n      }\n    });\n  }\n\n  render() {\n    return (\n      <div ref={(el) => (this.container = el)} className={styles.container}>\n        <Tabs\n          key=\"timeline-tabs\"\n          onChange={(tabId) => {\n            this.activate(tabId);\n            this.updateSize();\n          }}\n          className={styles.tabs}\n        >\n          <TabList className={styles.tabList}>\n            <Tab className={styles.tab} key=\"items\" tabFor=\"items\">\n              Timeline\n            </Tab>\n            {/* <Tab className={styles.tab} key=\"projects\" tabFor=\"projects\">\n              Projects\n            </Tab> */}\n            <Tab className={styles.tab} key=\"analysis\" tabFor=\"analysis\">\n              Analysis\n            </Tab>\n          </TabList>\n\n          <TabPanel key=\"items\" tabId=\"items\" className={styles.tabPanel}>\n            <NewTimeline\n              projects={this.props.projects}\n              onClick={this.props.shipSelect}\n              resetFilters={this.props.resetFilters}\n            />\n          </TabPanel>\n\n          {/* <TabPanel key=\"projects\" tabId=\"projects\" className={styles.tabPanel}>\n            <NewTimeline\n              projects={this.props.projects}\n              onClick={this.props.shipSelect}\n              resetFilters={this.props.resetFilters}\n            />\n          </TabPanel> */}\n\n          <TabPanel key=\"analysis\" tabId=\"analysis\" className={styles.tabPanel}>\n            <div className={styles.centerContainer}>\n              <p>This will contain tools and graphs for temporal social network analysis.</p>\n            </div>\n          </TabPanel>\n        </Tabs>\n      </div>\n    );\n  }\n}\n\nTimeLineBox.propTypes = {\n  projects: PropTypes.object.isRequired,\n  shipSelect: PropTypes.func.isRequired,\n  resetFilters: PropTypes.func.isRequired,\n  //   emitClicked: PropTypes.func.isRequired,\n  //   emitSelected: PropTypes.func.isRequired,\n  //   emitWindowChanged: PropTypes.func.isRequired,\n  //   getItemTimeLine: PropTypes.func.isRequired,\n  //   getItemWindow: PropTypes.func.isRequired,\n  //   getMaxWindow: PropTypes.func.isRequired,\n  //   getProjectTimeLine: PropTypes.func.isRequired,\n  //   getProjectWindow: PropTypes.func.isRequired,\n  //   selected: PropTypes.func,\n};\n\nexport default TimeLineBox;\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\n\nimport { Accordion, AccordionItem, AccordionTitle, AccordionPanel } from \"./Accordion\";\n\nimport { ResponsiveList, ResponsiveListItem } from \"./ResponsiveList\";\nimport CheckBox from \"./CheckBox\";\nimport DefaultButton from \"./DefaultButton\";\n\nimport styles from \"./FilterBox.module.css\";\n\nfunction null_function() {}\n\nfunction filterList(items, props) {\n  let social = props.social;\n\n  let emitSelected = props.emitSelected;\n\n  if (!emitSelected) {\n    emitSelected = null_function;\n  }\n\n  let emitToggleFilter = props.emitToggleFilter;\n\n  if (!emitToggleFilter) {\n    emitToggleFilter = null_function;\n  }\n\n  let output = items.values().map((item) => {\n    let is_filtered = social.isFiltered(item);\n\n    return (\n      <ResponsiveListItem key={item.getName()}>\n        <DefaultButton\n          style={{ position: \"relative\", maxWidth: \"80%\" }}\n          onClick={() => {\n            emitSelected(item);\n          }}\n        >\n          {item.getName()}\n        </DefaultButton>\n        &nbsp;\n        <CheckBox\n          checked={is_filtered}\n          onChange={() => {\n            emitToggleFilter(item);\n          }}\n        />\n      </ResponsiveListItem>\n    );\n  });\n\n  return <ResponsiveList>{output}</ResponsiveList>;\n}\n\nfilterList.propTypes = {\n  social: PropTypes.object.isRequired,\n  emitSelected: PropTypes.func,\n  emitToggleFilter: PropTypes.func,\n};\n\nfunction FilterBox(props) {\n  let social = props.social;\n\n  if (!social) {\n    return <div>No social to display!</div>;\n  }\n\n  let filter_text = social.getFilterText();\n\n  if (!filter_text) {\n    filter_text = \"No filters\";\n  }\n\n  let emitClearFilters = props.emitClearFilters;\n\n  if (!emitClearFilters) {\n    emitClearFilters = null_function;\n  }\n\n  let filter_info = (\n    <AccordionItem uuid=\"filterinfo\">\n      <AccordionTitle>Current Filter</AccordionTitle>\n      <AccordionPanel>\n        <div className={styles.filterContainer}>\n          <div className={styles.filterText}>{filter_text}</div>\n          <div>\n            <DefaultButton onClick={emitClearFilters}>Clear Filters</DefaultButton>\n          </div>\n        </div>\n      </AccordionPanel>\n    </AccordionItem>\n  );\n\n  let projects = filterList(social.getProjects(false), props);\n  let sources = filterList(social.getSources(false), props);\n  let positions = filterList(social.getPositions(false), props);\n  let affiliations = filterList(social.getAffiliations(false), props);\n  let people = filterList(social.getPeople(false), props);\n  let businesses = filterList(social.getBusinesses(false), props);\n\n  console.log(social.getPositions(false).values());\n\n  return (\n    <Accordion allowMultipleExpanded={false} allowZeroExpanded={true}>\n      {filter_info}\n\n      <AccordionItem uuid=\"projects\">\n        <AccordionTitle>Projects</AccordionTitle>\n        <AccordionPanel>{projects}</AccordionPanel>\n      </AccordionItem>\n\n      <AccordionItem uuid=\"sources\">\n        <AccordionTitle>Sources</AccordionTitle>\n        <AccordionPanel>{sources}</AccordionPanel>\n      </AccordionItem>\n\n      <AccordionItem uuid=\"people\">\n        <AccordionTitle>People</AccordionTitle>\n        <AccordionPanel>{people}</AccordionPanel>\n      </AccordionItem>\n\n      <AccordionItem uuid=\"businesses\">\n        <AccordionTitle>Businesses</AccordionTitle>\n        <AccordionPanel>{businesses}</AccordionPanel>\n      </AccordionItem>\n\n      <AccordionItem uuid=\"positions\">\n        <AccordionTitle>Positions</AccordionTitle>\n        <AccordionPanel>{positions}</AccordionPanel>\n      </AccordionItem>\n\n      <AccordionItem uuid=\"affiliations\">\n        <AccordionTitle>Affiliations</AccordionTitle>\n        <AccordionPanel>{affiliations}</AccordionPanel>\n      </AccordionItem>\n    </Accordion>\n  );\n}\n\nFilterBox.propTypes = {\n  social: PropTypes.object.isRequired,\n  emitSelected: PropTypes.func,\n  emitClearFilters: PropTypes.func,\n};\n\nexport default FilterBox;\n","import PropTypes from \"prop-types\";\nimport React from \"react\";\nimport { CSSTransition } from \"react-transition-group\";\n\nimport styles from \"./SlidingPanel.module.css\";\nimport SlideFromLeft from \"./transitions/SlideFromLeft.module.css\";\nimport SlideFromRight from \"./transitions/SlideFromRight.module.css\";\nimport SlideFromBottom from \"./transitions/SlideFromBottom.module.css\";\nimport SlideFromTop from \"./transitions/SlideFromTop.module.css\";\n\nclass SlidingPanel extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      isOpen: false,\n      position: \"right\",\n      defaultSize: \"40%\",\n      minSize: \"300px\",\n      maxSize: null,\n    };\n  }\n\n  render() {\n    let container = styles.rightContainer;\n    let transition = SlideFromRight;\n\n    let width = this.props.width;\n    let height = this.props.height;\n\n    if (height && !width) {\n      width = \"100%\";\n    }\n\n    if (width && !height) {\n      console.log(\"Setting height 100%\");\n      height = \"100%\";\n    }\n\n    let horiz_size = { width: width };\n    let vert_size = { height: height };\n\n    let style = { width: width, height: height, minSize: this.state.minSize };\n\n    if (this.props.maxSize) {\n      horiz_size.maxWidth = this.props.maxSize;\n      vert_size.maxHeight = this.props.maxSize;\n    }\n\n    // let style = horiz_size;\n    // Get the passed in position\n    let position = this.props.position;\n\n    if (position === \"right\") {\n      container = styles.rightContainer;\n      transition = SlideFromRight;\n    } else if (position === \"bottom\") {\n      container = styles.bottomContainer;\n      transition = SlideFromBottom;\n    } else if (position === \"top\") {\n      container = styles.topContainer;\n      transition = SlideFromTop;\n    } else if (position === \"left\") {\n      container = styles.leftContainer;\n      transition = SlideFromLeft;\n    }\n\n    container = `${container} ${styles.container}`;\n\n    return (\n      <CSSTransition in={this.props.isOpen} timeout={200} classNames={transition} unmountOnExit>\n        <div className={container} style={style}>\n          {this.props.children}\n        </div>\n      </CSSTransition>\n    );\n  }\n}\n\nSlidingPanel.propTypes = {\n  children: PropTypes.oneOfType([PropTypes.array, PropTypes.object]).isRequired,\n  isOpen: PropTypes.bool,\n  maxSize: PropTypes.string,\n  minSize: PropTypes.string,\n  position: PropTypes.string,\n  width: PropTypes.string,\n  height: PropTypes.string,\n};\n\nexport default SlidingPanel;\n","import React from \"react\";\nimport Spinner from \"react-spinkit\";\nimport PropTypes from \"prop-types\";\n\nimport styles from \"./OverlayBox.module.css\";\n\nclass OverlayBox extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      loading: true,\n    };\n  }\n\n  hideSpinner() {\n    this.setState({\n      loading: false,\n    });\n  }\n\n  render() {\n    let item = this.props.item;\n\n    let url = null;\n\n    if (item && item.getURL) {\n      url = item.getURL();\n    }\n\n    if (!url) {\n      return (\n        <div className={styles.container}>\n          <div className={styles.centerContainer}>\n            {item}\n            <div>\n              <button className={styles.button} onClick={this.props.emitClose}>\n                Close\n              </button>\n            </div>\n          </div>\n        </div>\n      );\n    }\n\n    return (\n      <div className={styles.container}>\n        <div className={styles.url}>{url}</div>\n        {this.state.loading ? (\n          <div className={styles.centerContainer}>\n            <div>Loading page...</div>\n            <div>\n              <Spinner name=\"ball-grid-pulse\" color=\"green\" fadeIn=\"none\" />\n            </div>\n          </div>\n        ) : null}\n        <iframe\n          src={url}\n          title={url}\n          width=\"100%\"\n          height=\"95%\"\n          onLoad={() => {\n            this.hideSpinner();\n          }}\n          frameBorder=\"0\"\n          marginHeight=\"0\"\n          marginWidth=\"0\"\n          sandbox=\"allow-scripts\"\n          position=\"absolute\"\n        />\n      </div>\n    );\n  }\n}\n\nOverlayBox.propTypes = {\n  item: PropTypes.elementType,\n  emitClose: PropTypes.func.isRequired,\n};\nexport default OverlayBox;\n","import PropTypes from \"prop-types\";\nimport React from \"react\";\nimport Spinner from \"react-spinkit\";\n\nimport TextButton from \"./TextButton\";\n\nimport styles from \"./SearchBar.module.css\";\n\n// This class is heavily inspired by react-search-field\n// from https://github.com/nutboltu/react-search-field\n\nfunction _null_function() {}\n\nfunction SearchResults(props) {\n  let results = props.results;\n\n  if (!results) {\n    return null;\n  }\n\n  let items = [];\n\n  results.forEach((item, index) => {\n    items.push(<li key={index}>{item}</li>);\n  });\n\n  return <ul>{items}</ul>;\n}\n\nSearchResults.propTypes = {\n  results: PropTypes.any,\n};\n\nclass SearchBar extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      value: \"\",\n      suggestions: null,\n      searching: null,\n      results: null,\n    };\n  }\n\n  componentDidUpdate(nextProps) {\n    if (this.props.searchText !== nextProps.searchText) {\n      this.setState({\n        value: nextProps.searchText,\n      });\n    }\n  }\n\n  setResults(results) {\n    this.setState({ searching: null, suggestions: null, results: results });\n  }\n\n  setSuggestions(suggestions) {\n    this.setState({ searching: null, suggestions: suggestions, results: null });\n  }\n\n  createButton(item, index) {\n    const name = item.getName();\n    return (\n      <TextButton\n        key={name.concat(\"_\", index)}\n        textColor=\"#f1f1f1\"\n        hoverColor=\"#111\"\n        onClick={() => {\n          this.props.emitSelected(item);\n        }}\n      >\n        {name}\n      </TextButton>\n    );\n  }\n\n  startSuggestion(text) {\n    let social = this.props.social;\n    if (!social) {\n      return;\n    }\n\n    let items = null;\n\n    try {\n      items = social.find(text);\n    } catch (error) {\n      items = null;\n    }\n\n    let emitSelected = this.props.emitSelected;\n\n    if (!emitSelected) {\n      emitSelected = _null_function;\n    }\n\n    if (items) {\n      let results = items.map((item, index) => {\n        return this.createButton(item, index);\n      });\n\n      this.setSuggestions(results);\n    } else {\n      this.setSuggestions(null);\n    }\n  }\n\n  startSearch(text) {\n    let social = this.props.social;\n\n    if (!social) {\n      this.setResults([<div key=\"noresults\">No results!</div>]);\n      return;\n    }\n\n    let items = null;\n\n    try {\n      items = social.find(text);\n    } catch (error) {\n      console.error(error);\n      items = null;\n    }\n\n    let emitSelected = this.props.emitSelected;\n\n    if (!emitSelected) {\n      emitSelected = _null_function;\n    }\n\n    if (items) {\n      let results = items.map((item, index) => {\n        return this.createButton(item, index);\n      });\n\n      this.setResults(results);\n    } else {\n      this.setResults([<div key=\"rnoresults\">Really no results!</div>]);\n    }\n  }\n\n  searchFor(text) {\n    if (text && text.length > 0) {\n      this.setState({ searching: text, suggestions: null, results: null });\n\n      setTimeout(() => {\n        this.startSearch(text);\n      }, 10);\n    } else {\n      this.setState({ suggestions: null, searching: null, results: null });\n    }\n  }\n\n  autocomplete(text) {\n    if (text && text.length > 0) {\n      this.startSuggestion(text);\n    } else {\n      this.setState({ suggestions: null, searching: null, results: null });\n    }\n  }\n\n  isSearching() {\n    return this.state.searching !== null;\n  }\n\n  isSuggesting() {\n    return this.state.suggestions !== null;\n  }\n\n  hasResults() {\n    return this.state.results !== null;\n  }\n\n  stopSearch() {\n    this.setState({ searching: null, suggestions: null, results: null });\n  }\n\n  onChange(event) {\n    if (this.isSearching()) {\n      return;\n    }\n\n    this.setState({ value: event.target.value });\n    this.autocomplete(event.target.value);\n  }\n\n  onEnter(event) {\n    if (this.isSearching() || this.isEmpty()) {\n      return;\n    }\n\n    const enterKey = 13;\n    const isEnterPressed = event.which === enterKey || event.keyCode === enterKey;\n\n    if (isEnterPressed) {\n      this.searchFor(event.target.value);\n    }\n  }\n\n  onSearch() {\n    if (this.isSearching() || this.isEmpty()) {\n      return;\n    }\n\n    this.searchFor(this.state.value);\n  }\n\n  isEmpty() {\n    return !(this.state.value && this.state.value.length > 0);\n  }\n\n  isSearchingComponent() {\n    return (\n      <div className={styles.searchContainer}>\n        <div className={styles.resultContainer}>\n          <div className={styles.searchPending}>\n            <div>Searching for &quot;{this.state.searching}&quot;...</div>\n            <div style={{ display: \"inline-block\" }}>\n              <Spinner name=\"ball-grid-pulse\" color=\"green\" fadeIn=\"none\" />\n            </div>\n          </div>\n          <div\n            className={styles.closeResultButton}\n            onClick={() => {\n              this.stopSearch();\n            }}\n          >\n            X\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  isSuggestingComponent() {\n    return (\n      <div className={styles.searchContainer}>\n        <div className={styles.resultContainer}>\n          <div className={styles.searchResult}>\n            <SearchResults results={this.state.suggestions} />\n          </div>\n          <div\n            className={styles.closeResultButton}\n            onClick={() => {\n              this.setState({ suggestions: null });\n            }}\n          >\n            X\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  resultsComponent() {\n    return (\n      <div className={styles.searchContainer}>\n        <div className={styles.resultContainer}>\n          <div className={styles.searchResult}>\n            <SearchResults results={this.state.results} />\n          </div>\n          <div\n            className={styles.closeResultButton}\n            onClick={() => {\n              this.setState({ results: null });\n            }}\n          >\n            X\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  render() {\n    return (\n      <div className={styles.container}>\n        <div className={styles.searchContainer}>\n          <button className={styles.hamburgerButton} onClick={this.props.emitHamburgerClicked}>\n            \n          </button>\n          <input\n            className={styles.searchBox}\n            onChange={(event) => {\n              this.onChange(event);\n            }}\n            onKeyPress={(event) => {\n              this.onEnter(event);\n            }}\n            placeholder={this.props.placeholder}\n            type=\"text\"\n            value={this.state.value}\n          />\n        </div>\n        {this.isSearching() ? this.isSearchingComponent() : null}\n        {this.isSuggesting() ? this.isSuggestingComponent() : null}\n        {this.hasResults() ? this.resultsComponent() : null}\n      </div>\n    );\n  }\n}\n\n// TODO - finish this\nSearchBar.propTypes = {\n  emitHamburgerClicked: PropTypes.func.isRequired,\n  emitSelected: PropTypes.func.isRequired,\n  // This is currently unused\n  placeholder: PropTypes.any,\n  searchText: PropTypes.string,\n  social: PropTypes.object.isRequired,\n};\n\nexport default SearchBar;\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport styles from \"./BrunelMenu.module.css\";\n\nimport logo from \"../images/ssgb_logo.png\";\n\nclass BrunelMenu extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.viewAbout = this.viewAbout.bind(this);\n    this.viewSource = this.viewSource.bind(this);\n  }\n\n  viewAbout() {\n    let item = (\n      <div>\n        <div>\n          This is a demo of the application to view Brunel&apos;s temporal social network. This is an incomplete\n          application containing incomplete data and should not be relied on or viewed as being accurate.\n        </div>\n        <div>\n          If you want more information, then please visit the{\" \"}\n          <a href=\"https://github.com/chryswoods/brunel\">GitHub repository</a>\n        </div>\n      </div>\n    );\n\n    this.props.setOverlay(item);\n  }\n\n  viewSource() {\n    var win = window.open(\"https://github.com/gareth-j/brunel\", \"_blank\");\n    win.focus();\n  }\n\n  render() {\n    return (\n      <div className={styles.sidebar}>\n        <div className={styles.logo}>\n          <img src={logo} alt=\"SS Great Britain logo\"></img>\n        </div>\n        <div className={styles.verticalSpace}></div>\n        <button className={styles.button} onClick={this.viewAbout}>About</button>\n        <button className={styles.button} onClick={this.viewSource}>Source</button>\n        <button className={styles.button} onClick={this.props.clickReset}>Reset</button>\n      </div>\n    );\n  }\n}\n\nBrunelMenu.propTypes = {\n  clickReset: PropTypes.func.isRequired,\n  setOverlay: PropTypes.func.isRequired,\n};\n\nexport default BrunelMenu;\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\n\nimport styles from \"./ShipSelector.module.css\";\n\nclass ShipSelector extends React.Component {\n  constructor(props) {\n    super(props);\n\n    const projects = this.props.projects;\n\n    // We want the graph to start with the GW selected\n    const ssGW = projects.getByName(\"SS Great Western\");\n    this.props.shipFilter(ssGW);\n\n    this.state = { lastShip: ssGW.getName() };\n  }\n\n  setFilter(item) {\n    const shipName = item.getName();\n\n    if (shipName === this.state.lastShip) {\n      this.props.resetFilters();\n      this.setState({ lastShip: \"\" });\n      return;\n    }\n\n    this.setState({ lastShip: shipName });\n    this.props.shipFilter(item);\n  }\n\n  render() {\n    let projects = this.props.projects;\n\n    let output = projects.values().map((item, index) => {\n      return (\n        <button href=\"#\" key={index} className={styles.button} onClick={() => this.setFilter(item)}>\n          {item.getName()}\n        </button>\n      );\n    });\n\n    return output;\n  }\n}\n\nShipSelector.propTypes = {\n  projects: PropTypes.object.isRequired,\n  resetFilters: PropTypes.func.isRequired,\n  shipFilter: PropTypes.func.isRequired,\n};\n\nexport default ShipSelector;\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\n\nimport styles from \"./ShipTitle.module.css\";\n\nfunction ShipTitle(props) {\n  if (props.name == null) {\n    return null;\n  } else {\n    return <button className={styles.shipTitle}>{props.name}</button>;\n  }\n}\n\nShipTitle.propTypes = {\n  shipTitle: PropTypes.string,\n  style: PropTypes.string,\n};\n\nexport default ShipTitle;\n","// package imports\nimport React from \"react\";\nimport Dry from \"json-dry\";\nimport ReactModal from \"react-modal\";\n\n// Brunel components\nimport AnalysisPanel from \"./components/AnalysisPanel\";\nimport AnalysisButton from \"./components/AnalysisButton\";\nimport SocialGraph from \"./components/SocialGraph\";\nimport InfoBox from \"./components/InfoBox\";\nimport TimeLineBox from \"./components/TimeLineBox\";\nimport FilterBox from \"./components/FilterBox\";\nimport SlidingPanel from \"./components/SlidingPanel\";\nimport OverlayBox from \"./components/OverlayBox\";\nimport SearchBar from \"./components/SearchBar\";\nimport BrunelMenu from \"./components/BrunelMenu\";\nimport ShipSelector from \"./components/ShipSelector\";\nimport ShipTitle from \"./components/ShipTitle\";\n\n// Brunel model\nimport Social from \"./model/Social\";\n\n// Data for import\nimport graph_data from \"./data_weights.json\";\n\n// Styling for the app\nimport styles from \"./SocialApp.module.css\";\nimport DateRange from \"./model/DateRange\";\n\nclass SocialApp extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.toggleWobble = this.toggleWobble.bind(this);\n    this.resetFilters = this.resetFilters.bind(this);\n    this.setOverlay = this.setOverlay.bind(this);\n\n    // Load in the Dried graph data from JSON\n    let social = Dry.parse(graph_data);\n\n    if (!(social instanceof Social)) {\n      console.error(\"Could not parse!\");\n      social = new Social();\n    }\n\n    // Special cases for Brunel project...\n    social.setAnchor(\"Brunel\");\n    social.setMaxWindow(new DateRange({ start: \"1800-01-01\", end: \"1860-12-31\" }));\n\n    this.state = {\n      social: social,\n      highlighted_item: null,\n      selected_item: null,\n      overlayItem: null,\n      isInfoPanelOpen: false,\n      isTimeLinePanelOpen: false,\n      isFilterPanelOpen: false,\n      isHamburgerMenuOpen: false,\n      timeline: new TimeLineBox(),\n      isOverlayOpen: false,\n      isAnalysisOpen: false,\n      wobbleEnabled: true,\n      selectedShip: null,\n      selectedShipID: null,\n    };\n\n    // TODO - work out a cleaner way of doing this\n    // Is set in ShipSelector correctly\n    const ssGW = social.getProjects().getByName(\"SS Great Western\");\n    this.state.selectedShip = ssGW.getName();\n    this.state.selectedShipID = ssGW.getID();\n\n    this.socialGraph = null;\n  }\n\n  resetFilters() {\n    let social = this.state.social;\n    social.resetFilters();\n    this.setState({ social: social, selectedShip: null, selectedShipID: null });\n  }\n\n  closePanels() {\n    this.setState({\n      isInfoPanelOpen: false,\n      isTimeLinePanelOpen: false,\n      isHamburgerMenuOpen: false,\n      isFilterPanelOpen: false,\n      isAnalysisOpen: false,\n      highlighted_item: null,\n    });\n  }\n\n  closeOverlay() {\n    this.setState({\n      isOverlayOpen: false,\n      overlayItem: null,\n    });\n  }\n\n  showInfo(item) {\n    if (item._isAProjectObject) {\n      this.setState({\n        overlayItem: item,\n        isOverlayOpen: true,\n      });\n    } else {\n      this.setState({\n        selected_item: item,\n        isInfoPanelOpen: true,\n      });\n    }\n  }\n\n  slotClearFilters() {\n    this.resetFilters();\n  }\n\n  slotSetFilter(item) {\n    this.resetFilters();\n    this.slotToggleFilter(item);\n    this.setState({ selectedShip: item.getName(), selectedShipID: item.getID() });\n  }\n\n  slotSetFilterbyID(id, name) {\n    this.resetFilters();\n    this.slotToggleFilter(id);\n    this.setState({ selectedShip: name, selectedShipID: id });\n  }\n\n  slotToggleFilter(item) {\n    if (!item) {\n      return;\n    }\n\n    let social = this.state.social;\n    social.toggleFilter(item);\n\n    this.setState({ social: social });\n  }\n\n  slotHighlighted(id) {\n    if (!id) {\n      return;\n    }\n\n    if (id._isADateRangeObject) {\n      return;\n    }\n\n    this.setState({ highlighted_item: id });\n  }\n\n  slotSelected(id) {\n    if (!id) {\n      this.closePanels();\n      return;\n    }\n\n    if (id._isADateRangeObject) {\n      let social = this.state.social;\n      if (social.setWindow(id)) {\n        this.setState({ social: social });\n      }\n      return;\n    }\n\n    const social = this.state.social;\n    const item = social.get(id);\n    this.showInfo(item);\n  }\n\n  slotWindowChanged(window) {\n    let social = this.state.social;\n\n    if (social.setWindow(window)) {\n      this.setState({ social: social });\n    }\n  }\n\n  toggleInfoPanel() {\n    this.setState({ isInfoPanelOpen: !this.state.isInfoPanelOpen });\n  }\n\n  toggleTimeLinePanel() {\n    this.setState({\n      isFilterPanelOpen: false,\n      isTimeLinePanelOpen: !this.state.isTimeLinePanelOpen,\n    });\n  }\n\n  toggleFilterPanel() {\n    this.setState({\n      isTimeLinePanelOpen: false,\n      isFilterPanelOpen: !this.state.isFilterPanelOpen,\n    });\n  }\n\n  toggleAnalysisPanel() {\n    this.setState({ isAnalysisOpen: !this.state.isAnalysisOpen });\n  }\n\n  toggleWobble() {\n    this.setState({ wobbleEnabled: !this.state.wobbleEnabled });\n  }\n\n  setOverlay(item) {\n    this.setState({\n      overlayItem: item,\n      isOverlayOpen: true,\n    });\n  }\n\n  resetAll() {\n    console.log(\"Reset all\");\n    window.location.reload(true);\n  }\n\n  render() {\n    const selected = this.state.selected_item;\n    const highlighted = this.state.highlighted_item;\n    const overlayItem = this.state.overlayItem;\n    const social = this.state.social;\n\n    // TODO - check if this is the correct way\n    // Removed the movement for now\n    let graphContainerClass = styles.graphContainerMenuClosed;\n    //  this.state.isHamburgerMenuOpen\n    //   ? styles.graphContainerMenuOpen\n    //   : styles.graphContainerMenuClosed;\n\n    // let sidebarClass = this.state.isHamburgerMenuOpen ? styles.sidebarVis : stules\n\n    console.log(this.state.isHamburgerMenuOpen);\n\n    return (\n      <div>\n        <ReactModal\n          isOpen={this.state.isOverlayOpen}\n          onRequestClose={() => {\n            this.closeOverlay();\n          }}\n          contentLabel=\"Information overlay\"\n          className={styles.modal}\n          overlayClassName={{\n            base: styles.modalOverlay,\n            afterOpen: styles.modalOverlayAfterOpen,\n            beforeClose: styles.modalOverlayBeforeClose,\n          }}\n          closeTimeoutMS={200}\n          appElement={document.getElementById(\"root\")}\n        >\n          <div\n            className={styles.closeOverlayButton}\n            onClick={() => {\n              this.closeOverlay();\n            }}\n          >\n            X\n          </div>\n          <OverlayBox\n            item={overlayItem}\n            emitClose={() => {\n              this.closeOverlay();\n            }}\n          />\n        </ReactModal>\n\n        <SearchBar\n          social={social}\n          emitHamburgerClicked={() => {\n            this.setState({\n              isHamburgerMenuOpen: !this.state.isHamburgerMenuOpen,\n            });\n          }}\n          emitSelected={(item) => {\n            this.slotSelected(item);\n          }}\n          emitHighlighted={(item) => {\n            this.slotHighlighted(item);\n          }}\n          emitClicked={(item) => {\n            this.slotClicked(item);\n          }}\n        />\n\n        <SlidingPanel isOpen={this.state.isTimeLinePanelOpen} position=\"bottom\" height=\"15%\">\n          <span\n            className={styles.closePanelButton}\n            onClick={() => {\n              this.setState({ isTimeLinePanelOpen: false });\n            }}\n          >\n            X\n          </span>\n          <TimeLineBox\n            selected={selected}\n            projects={this.state.social.getProjects()}\n            shipSelect={(item) => {\n              this.slotSetFilterbyID(item);\n            }}\n            resetFilters={this.resetFilters}\n          />\n        </SlidingPanel>\n\n        {/* Info panel on the RHS */}\n        <SlidingPanel isOpen={this.state.isInfoPanelOpen} position=\"right\">\n          <span\n            className={styles.closePanelButton}\n            onClick={() => {\n              this.setState({ isInfoPanelOpen: false });\n            }}\n          >\n            X\n          </span>\n          <InfoBox\n            item={selected}\n            social={social}\n            emitSelected={(item) => {\n              this.slotSelected(item);\n            }}\n            emitHighlighted={(item) => {\n              this.slotHighlighted(item);\n            }}\n            emitToggleFilter={(item) => {\n              this.slotToggleFilter(item);\n            }}\n          />\n        </SlidingPanel>\n\n        {/* Filter on bottom of page */}\n        <SlidingPanel isOpen={this.state.isFilterPanelOpen} position=\"bottom\" height=\"20%\">\n          <span\n            className={styles.closePanelButton}\n            onClick={() => {\n              this.setState({ isFilterPanelOpen: false });\n            }}\n          >\n            X\n          </span>\n          <FilterBox\n            social={social}\n            emitToggleFilter={(item) => {\n              this.slotToggleFilter(item);\n            }}\n            emitSelected={(item) => {\n              this.slotSelected(item);\n            }}\n            emitHighlighted={(item) => {\n              this.slotHighlighted(item);\n            }}\n            emitClearFilters={() => {\n              this.slotClearFilters();\n            }}\n          />\n        </SlidingPanel>\n\n        {/* This creates the menu on the LHS opened by the hamburger */}\n        <SlidingPanel isOpen={this.state.isHamburgerMenuOpen} position=\"left\" width=\"10%\" height=\"100%\">\n          <BrunelMenu\n            setOverlay={this.setOverlay}\n            clickReset={() => {\n              this.resetAll();\n            }}\n            clickSource={() => {\n              this.viewSource();\n            }}\n            emitClose={() => {\n              this.setState({ isHamburgerMenuOpen: false });\n            }}\n          />\n        </SlidingPanel>\n\n        <div className={styles.shipNameContainer}>\n          <ShipTitle name={this.state.selectedShip} />\n        </div>\n\n        <div className={styles.bottomContainer}>\n          <ShipSelector\n            projects={this.state.social.getProjects()}\n            shipFilter={(item) => this.slotSetFilter(item)}\n            resetFilters={this.resetFilters}\n            selectedShip={this.state.selectedShip}\n          />\n        </div>\n\n        {/* The social graph itself */}\n        <div className={graphContainerClass}>\n          <SocialGraph\n            social={this.state.social}\n            selected={selected}\n            highlighted={highlighted}\n            emitClicked={(id) => this.slotSelected(id)}\n            wobble={this.state.wobbleEnabled}\n            selectedShipID={this.state.selectedShipID}\n          />\n        </div>\n\n        <div className={styles.rightSidePanel}>\n          <AnalysisButton togglePanel={() => this.toggleAnalysisPanel()} />\n        </div>\n\n        <SlidingPanel isOpen={this.state.isAnalysisOpen} position=\"right\" width=\"10%\">\n          <AnalysisPanel\n            toggleFilterPanel={() => this.toggleFilterPanel()}\n            toggleTimeLinePanel={() => this.toggleTimeLinePanel()}\n            toggleWobble={() => this.toggleWobble()}\n            togglePanel={() => this.toggleAnalysisPanel()}\n          />\n        </SlidingPanel>\n      </div>\n    );\n  }\n}\n\nexport default SocialApp;\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"ForceGraph_container__TQtWA\",\"graph\":\"ForceGraph_graph__wst6B\",\"node\":\"ForceGraph_node__27s5W\",\"highlight\":\"ForceGraph_highlight__DhZbw\",\"link\":\"ForceGraph_link__2qaVU\",\"link_weak\":\"ForceGraph_link_weak__286oz\",\"link_indirect\":\"ForceGraph_link_indirect__2uhap\",\"node_text\":\"ForceGraph_node_text__3ovHB\",\"tooltip\":\"ForceGraph_tooltip__3ttDG\"};"],"sourceRoot":""}